/*!
 * jQuery JavaScript Library v1.7
 * http://jquery.com/
 *
 * Copyright 2011, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 * Copyright 2011, The Dojo Foundation
 * Released under the MIT, BSD, and GPL Licenses.
 *
 * Date: Thu Nov 3 16:18:21 2011 -0400
 */
(function(bc,L){var au=bc.document,bw=bc.navigator,bn=bc.location;var b=(function(){var bH=function(b3,b4){return new bH.fn.init(b3,b4,bF)},bX=bc.jQuery,bJ=bc.$,bF,b1=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,bP=/\S/,bL=/^\s+/,bG=/\s+$/,bK=/\d/,bC=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,bQ=/^[\],:{}\s]*$/,bZ=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,bS=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,bM=/(?:^|:|,)(?:\s*\[)+/g,bA=/(webkit)[ \/]([\w.]+)/,bU=/(opera)(?:.*version)?[ \/]([\w.]+)/,bT=/(msie) ([\w.]+)/,bV=/(mozilla)(?:.*? rv:([\w.]+))?/,bD=/-([a-z]|[0-9])/ig,b2=/^-ms-/,bW=function(b3,b4){return(b4+"").toUpperCase()},b0=bw.userAgent,bY,bE,e,bO=Object.prototype.toString,bI=Object.prototype.hasOwnProperty,bB=Array.prototype.push,bN=Array.prototype.slice,bR=String.prototype.trim,bx=Array.prototype.indexOf,bz={};bH.fn=bH.prototype={constructor:bH,init:function(b3,b7,b6){var b5,b8,b4,b9;if(!b3){return this}if(b3.nodeType){this.context=this[0]=b3;this.length=1;return this}if(b3==="body"&&!b7&&au.body){this.context=au;this[0]=au.body;this.selector=b3;this.length=1;return this}if(typeof b3==="string"){if(b3.charAt(0)==="<"&&b3.charAt(b3.length-1)===">"&&b3.length>=3){b5=[null,b3,null]}else{b5=b1.exec(b3)}if(b5&&(b5[1]||!b7)){if(b5[1]){b7=b7 instanceof bH?b7[0]:b7;b9=(b7?b7.ownerDocument||b7:au);b4=bC.exec(b3);if(b4){if(bH.isPlainObject(b7)){b3=[au.createElement(b4[1])];bH.fn.attr.call(b3,b7,true)}else{b3=[b9.createElement(b4[1])]}}else{b4=bH.buildFragment([b5[1]],[b9]);b3=(b4.cacheable?bH.clone(b4.fragment):b4.fragment).childNodes}return bH.merge(this,b3)}else{b8=au.getElementById(b5[2]);if(b8&&b8.parentNode){if(b8.id!==b5[2]){return b6.find(b3)}this.length=1;this[0]=b8}this.context=au;this.selector=b3;return this}}else{if(!b7||b7.jquery){return(b7||b6).find(b3)}else{return this.constructor(b7).find(b3)}}}else{if(bH.isFunction(b3)){return b6.ready(b3)}}if(b3.selector!==L){this.selector=b3.selector;this.context=b3.context}return bH.makeArray(b3,this)},selector:"",jquery:"1.7",length:0,size:function(){return this.length},toArray:function(){return bN.call(this,0)},get:function(b3){return b3==null?this.toArray():(b3<0?this[this.length+b3]:this[b3])},pushStack:function(b4,b6,b3){var b5=this.constructor();if(bH.isArray(b4)){bB.apply(b5,b4)}else{bH.merge(b5,b4)}b5.prevObject=this;b5.context=this.context;if(b6==="find"){b5.selector=this.selector+(this.selector?" ":"")+b3}else{if(b6){b5.selector=this.selector+"."+b6+"("+b3+")"}}return b5},each:function(b4,b3){return bH.each(this,b4,b3)},ready:function(b3){bH.bindReady();bE.add(b3);return this},eq:function(b3){return b3===-1?this.slice(b3):this.slice(b3,+b3+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(bN.apply(this,arguments),"slice",bN.call(arguments).join(","))},map:function(b3){return this.pushStack(bH.map(this,function(b5,b4){return b3.call(b5,b4,b5)}))},end:function(){return this.prevObject||this.constructor(null)},push:bB,sort:[].sort,splice:[].splice};bH.fn.init.prototype=bH.fn;bH.extend=bH.fn.extend=function(){var cc,b5,b3,b4,b9,ca,b8=arguments[0]||{},b7=1,b6=arguments.length,cb=false;if(typeof b8==="boolean"){cb=b8;b8=arguments[1]||{};b7=2}if(typeof b8!=="object"&&!bH.isFunction(b8)){b8={}}if(b6===b7){b8=this;--b7}for(;b7<b6;b7++){if((cc=arguments[b7])!=null){for(b5 in cc){b3=b8[b5];b4=cc[b5];if(b8===b4){continue}if(cb&&b4&&(bH.isPlainObject(b4)||(b9=bH.isArray(b4)))){if(b9){b9=false;ca=b3&&bH.isArray(b3)?b3:[]}else{ca=b3&&bH.isPlainObject(b3)?b3:{}}b8[b5]=bH.extend(cb,ca,b4)}else{if(b4!==L){b8[b5]=b4}}}}}return b8};bH.extend({noConflict:function(b3){if(bc.$===bH){bc.$=bJ}if(b3&&bc.jQuery===bH){bc.jQuery=bX}return bH},isReady:false,readyWait:1,holdReady:function(b3){if(b3){bH.readyWait++}else{bH.ready(true)}},ready:function(b3){if((b3===true&&!--bH.readyWait)||(b3!==true&&!bH.isReady)){if(!au.body){return setTimeout(bH.ready,1)}bH.isReady=true;if(b3!==true&&--bH.readyWait>0){return}bE.fireWith(au,[bH]);if(bH.fn.trigger){bH(au).trigger("ready").unbind("ready")}}},bindReady:function(){if(bE){return}bE=bH.Callbacks("once memory");if(au.readyState==="complete"){return setTimeout(bH.ready,1)}if(au.addEventListener){au.addEventListener("DOMContentLoaded",e,false);bc.addEventListener("load",bH.ready,false)}else{if(au.attachEvent){au.attachEvent("onreadystatechange",e);bc.attachEvent("onload",bH.ready);var b3=false;try{b3=bc.frameElement==null}catch(b4){}if(au.documentElement.doScroll&&b3){by()}}}},isFunction:function(b3){return bH.type(b3)==="function"},isArray:Array.isArray||function(b3){return bH.type(b3)==="array"},isWindow:function(b3){return b3&&typeof b3==="object"&&"setInterval" in b3},isNumeric:function(b3){return b3!=null&&bK.test(b3)&&!isNaN(b3)},type:function(b3){return b3==null?String(b3):bz[bO.call(b3)]||"object"},isPlainObject:function(b5){if(!b5||bH.type(b5)!=="object"||b5.nodeType||bH.isWindow(b5)){return false}try{if(b5.constructor&&!bI.call(b5,"constructor")&&!bI.call(b5.constructor.prototype,"isPrototypeOf")){return false}}catch(b4){return false}var b3;for(b3 in b5){}return b3===L||bI.call(b5,b3)},isEmptyObject:function(b4){for(var b3 in b4){return false}return true},error:function(b3){throw b3},parseJSON:function(b3){if(typeof b3!=="string"||!b3){return null}b3=bH.trim(b3);if(bc.JSON&&bc.JSON.parse){return bc.JSON.parse(b3)}if(bQ.test(b3.replace(bZ,"@").replace(bS,"]").replace(bM,""))){return(new Function("return "+b3))()}bH.error("Invalid JSON: "+b3)},parseXML:function(b5){var b3,b4;try{if(bc.DOMParser){b4=new DOMParser();b3=b4.parseFromString(b5,"text/xml")}else{b3=new ActiveXObject("Microsoft.XMLDOM");b3.async="false";b3.loadXML(b5)}}catch(b6){b3=L}if(!b3||!b3.documentElement||b3.getElementsByTagName("parsererror").length){bH.error("Invalid XML: "+b5)}return b3},noop:function(){},globalEval:function(b3){if(b3&&bP.test(b3)){(bc.execScript||function(b4){bc["eval"].call(bc,b4)})(b3)}},camelCase:function(b3){return b3.replace(b2,"ms-").replace(bD,bW)},nodeName:function(b4,b3){return b4.nodeName&&b4.nodeName.toUpperCase()===b3.toUpperCase()},each:function(b6,b9,b5){var b4,b7=0,b8=b6.length,b3=b8===L||bH.isFunction(b6);if(b5){if(b3){for(b4 in b6){if(b9.apply(b6[b4],b5)===false){break}}}else{for(;b7<b8;){if(b9.apply(b6[b7++],b5)===false){break}}}}else{if(b3){for(b4 in b6){if(b9.call(b6[b4],b4,b6[b4])===false){break}}}else{for(;b7<b8;){if(b9.call(b6[b7],b7,b6[b7++])===false){break}}}}return b6},trim:bR?function(b3){return b3==null?"":bR.call(b3)}:function(b3){return b3==null?"":b3.toString().replace(bL,"").replace(bG,"")},makeArray:function(b6,b4){var b3=b4||[];if(b6!=null){var b5=bH.type(b6);if(b6.length==null||b5==="string"||b5==="function"||b5==="regexp"||bH.isWindow(b6)){bB.call(b3,b6)}else{bH.merge(b3,b6)}}return b3},inArray:function(b5,b6,b4){var b3;if(b6){if(bx){return bx.call(b6,b5,b4)}b3=b6.length;b4=b4?b4<0?Math.max(0,b3+b4):b4:0;for(;b4<b3;b4++){if(b4 in b6&&b6[b4]===b5){return b4}}}return -1},merge:function(b7,b5){var b6=b7.length,b4=0;if(typeof b5.length==="number"){for(var b3=b5.length;b4<b3;b4++){b7[b6++]=b5[b4]}}else{while(b5[b4]!==L){b7[b6++]=b5[b4++]}}b7.length=b6;return b7},grep:function(b4,b9,b3){var b5=[],b8;b3=!!b3;for(var b6=0,b7=b4.length;b6<b7;b6++){b8=!!b9(b4[b6],b6);if(b3!==b8){b5.push(b4[b6])}}return b5},map:function(b3,ca,cb){var b8,b9,b7=[],b5=0,b4=b3.length,b6=b3 instanceof bH||b4!==L&&typeof b4==="number"&&((b4>0&&b3[0]&&b3[b4-1])||b4===0||bH.isArray(b3));if(b6){for(;b5<b4;b5++){b8=ca(b3[b5],b5,cb);if(b8!=null){b7[b7.length]=b8}}}else{for(b9 in b3){b8=ca(b3[b9],b9,cb);if(b8!=null){b7[b7.length]=b8}}}return b7.concat.apply([],b7)},guid:1,proxy:function(b7,b6){if(typeof b6==="string"){var b5=b7[b6];b6=b7;b7=b5}if(!bH.isFunction(b7)){return L}var b3=bN.call(arguments,2),b4=function(){return b7.apply(b6,b3.concat(bN.call(arguments)))};b4.guid=b7.guid=b7.guid||b4.guid||bH.guid++;return b4},access:function(b3,cb,b9,b5,b8,ca){var b4=b3.length;if(typeof cb==="object"){for(var b6 in cb){bH.access(b3,b6,cb[b6],b5,b8,b9)}return b3}if(b9!==L){b5=!ca&&b5&&bH.isFunction(b9);for(var b7=0;b7<b4;b7++){b8(b3[b7],cb,b5?b9.call(b3[b7],b7,b8(b3[b7],cb)):b9,ca)}return b3}return b4?b8(b3[0],cb):L},now:function(){return(new Date()).getTime()},uaMatch:function(b4){b4=b4.toLowerCase();var b3=bA.exec(b4)||bU.exec(b4)||bT.exec(b4)||b4.indexOf("compatible")<0&&bV.exec(b4)||[];return{browser:b3[1]||"",version:b3[2]||"0"}},sub:function(){function b3(b6,b7){return new b3.fn.init(b6,b7)}bH.extend(true,b3,this);b3.superclass=this;b3.fn=b3.prototype=this();b3.fn.constructor=b3;b3.sub=this.sub;b3.fn.init=function b5(b6,b7){if(b7&&b7 instanceof bH&&!(b7 instanceof b3)){b7=b3(b7)}return bH.fn.init.call(this,b6,b7,b4)};b3.fn.init.prototype=b3.fn;var b4=b3(au);return b3},browser:{}});bH.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b4,b3){bz["[object "+b3+"]"]=b3.toLowerCase()});bY=bH.uaMatch(b0);if(bY.browser){bH.browser[bY.browser]=true;bH.browser.version=bY.version}if(bH.browser.webkit){bH.browser.safari=true}if(bP.test("\xA0")){bL=/^[\s\xA0]+/;bG=/[\s\xA0]+$/}bF=bH(au);if(au.addEventListener){e=function(){au.removeEventListener("DOMContentLoaded",e,false);bH.ready()}}else{if(au.attachEvent){e=function(){if(au.readyState==="complete"){au.detachEvent("onreadystatechange",e);bH.ready()}}}}function by(){if(bH.isReady){return}try{au.documentElement.doScroll("left")}catch(b3){setTimeout(by,1);return}bH.ready()}if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return bH})}return bH})();var a3={};function X(e){var bx=a3[e]={},by,bz;e=e.split(/\s+/);for(by=0,bz=e.length;by<bz;by++){bx[e[by]]=true}return bx}b.Callbacks=function(by){by=by?(a3[by]||X(by)):{};var bD=[],bE=[],bz,bA,bx,bB,bC,bG=function(bH){var bI,bL,bK,bJ,bM;for(bI=0,bL=bH.length;bI<bL;bI++){bK=bH[bI];bJ=b.type(bK);if(bJ==="array"){bG(bK)}else{if(bJ==="function"){if(!by.unique||!bF.has(bK)){bD.push(bK)}}}}},e=function(bI,bH){bH=bH||[];bz=!by.memory||[bI,bH];bA=true;bC=bx||0;bx=0;bB=bD.length;for(;bD&&bC<bB;bC++){if(bD[bC].apply(bI,bH)===false&&by.stopOnFalse){bz=true;break}}bA=false;if(bD){if(!by.once){if(bE&&bE.length){bz=bE.shift();bF.fireWith(bz[0],bz[1])}}else{if(bz===true){bF.disable()}else{bD=[]}}}},bF={add:function(){if(bD){var bH=bD.length;bG(arguments);if(bA){bB=bD.length}else{if(bz&&bz!==true){bx=bH;e(bz[0],bz[1])}}}return this},remove:function(){if(bD){var bH=arguments,bJ=0,bK=bH.length;for(;bJ<bK;bJ++){for(var bI=0;bI<bD.length;bI++){if(bH[bJ]===bD[bI]){if(bA){if(bI<=bB){bB--;if(bI<=bC){bC--}}}bD.splice(bI--,1);if(by.unique){break}}}}}return this},has:function(bI){if(bD){var bH=0,bJ=bD.length;for(;bH<bJ;bH++){if(bI===bD[bH]){return true}}}return false},empty:function(){bD=[];return this},disable:function(){bD=bE=bz=L;return this},disabled:function(){return !bD},lock:function(){bE=L;if(!bz||bz===true){bF.disable()}return this},locked:function(){return !bE},fireWith:function(bI,bH){if(bE){if(bA){if(!by.once){bE.push([bI,bH])}}else{if(!(by.once&&bz)){e(bI,bH)}}}return this},fire:function(){bF.fireWith(this,arguments);return this},fired:function(){return !!bz}};return bF};var aJ=[].slice;b.extend({Deferred:function(bA){var bz=b.Callbacks("once memory"),by=b.Callbacks("once memory"),bx=b.Callbacks("memory"),e="pending",bC={resolve:bz,reject:by,notify:bx},bE={done:bz.add,fail:by.add,progress:bx.add,state:function(){return e},isResolved:bz.fired,isRejected:by.fired,then:function(bG,bF,bH){bD.done(bG).fail(bF).progress(bH);return this},always:function(){return bD.done.apply(bD,arguments).fail.apply(bD,arguments)},pipe:function(bH,bG,bF){return b.Deferred(function(bI){b.each({done:[bH,"resolve"],fail:[bG,"reject"],progress:[bF,"notify"]},function(bK,bN){var bJ=bN[0],bM=bN[1],bL;if(b.isFunction(bJ)){bD[bK](function(){bL=bJ.apply(this,arguments);if(bL&&b.isFunction(bL.promise)){bL.promise().then(bI.resolve,bI.reject,bI.notify)}else{bI[bM+"With"](this===bD?bI:this,[bL])}})}else{bD[bK](bI[bM])}})}).promise()},promise:function(bG){if(bG==null){bG=bE}else{for(var bF in bE){bG[bF]=bE[bF]}}return bG}},bD=bE.promise({}),bB;for(bB in bC){bD[bB]=bC[bB].fire;bD[bB+"With"]=bC[bB].fireWith}bD.done(function(){e="resolved"},by.disable,bx.lock).fail(function(){e="rejected"},bz.disable,bx.lock);if(bA){bA.call(bD,bD)}return bD},when:function(bC){var bz=aJ.call(arguments,0),bx=0,e=bz.length,bD=new Array(e),by=e,bA=e,bE=e<=1&&bC&&b.isFunction(bC.promise)?bC:b.Deferred(),bG=bE.promise();function bF(bH){return function(bI){bz[bH]=arguments.length>1?aJ.call(arguments,0):bI;if(!(--by)){bE.resolveWith(bE,bz)}}}function bB(bH){return function(bI){bD[bH]=arguments.length>1?aJ.call(arguments,0):bI;bE.notifyWith(bG,bD)}}if(e>1){for(;bx<e;bx++){if(bz[bx]&&bz[bx].promise&&b.isFunction(bz[bx].promise)){bz[bx].promise().then(bF(bx),bE.reject,bB(bx))}else{--by}}if(!by){bE.resolveWith(bE,bz)}}else{if(bE!==bC){bE.resolveWith(bE,e?[bC]:[])}}return bG}});b.support=(function(){var bH=au.createElement("div"),bO=au.documentElement,bA,bP,bI,by,bG,bB,bE,bx,bF,bJ,bD,bN,bL,bz,bC,bK,bQ;bH.setAttribute("className","t");bH.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/><nav></nav>";bA=bH.getElementsByTagName("*");bP=bH.getElementsByTagName("a")[0];if(!bA||!bA.length||!bP){return{}}bI=au.createElement("select");by=bI.appendChild(au.createElement("option"));bG=bH.getElementsByTagName("input")[0];bE={leadingWhitespace:(bH.firstChild.nodeType===3),tbody:!bH.getElementsByTagName("tbody").length,htmlSerialize:!!bH.getElementsByTagName("link").length,style:/top/.test(bP.getAttribute("style")),hrefNormalized:(bP.getAttribute("href")==="/a"),opacity:/^0.55/.test(bP.style.opacity),cssFloat:!!bP.style.cssFloat,unknownElems:!!bH.getElementsByTagName("nav").length,checkOn:(bG.value==="on"),optSelected:by.selected,getSetAttribute:bH.className!=="t",enctype:!!au.createElement("form").enctype,submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};bG.checked=true;bE.noCloneChecked=bG.cloneNode(true).checked;bI.disabled=true;bE.optDisabled=!by.disabled;try{delete bH.test}catch(bM){bE.deleteExpando=false}if(!bH.addEventListener&&bH.attachEvent&&bH.fireEvent){bH.attachEvent("onclick",function(){bE.noCloneEvent=false});bH.cloneNode(true).fireEvent("onclick")}bG=au.createElement("input");bG.value="t";bG.setAttribute("type","radio");bE.radioValue=bG.value==="t";bG.setAttribute("checked","checked");bH.appendChild(bG);bx=au.createDocumentFragment();bx.appendChild(bH.lastChild);bE.checkClone=bx.cloneNode(true).cloneNode(true).lastChild.checked;bH.innerHTML="";bH.style.width=bH.style.paddingLeft="1px";bF=au.getElementsByTagName("body")[0];bD=au.createElement(bF?"div":"body");bN={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(bF){b.extend(bN,{position:"absolute",left:"-999px",top:"-999px"})}for(bK in bN){bD.style[bK]=bN[bK]}bD.appendChild(bH);bJ=bF||bO;bJ.insertBefore(bD,bJ.firstChild);bE.appendChecked=bG.checked;bE.boxModel=bH.offsetWidth===2;if("zoom" in bH.style){bH.style.display="inline";bH.style.zoom=1;bE.inlineBlockNeedsLayout=(bH.offsetWidth===2);bH.style.display="";bH.innerHTML="<div style='width:4px;'></div>";bE.shrinkWrapBlocks=(bH.offsetWidth!==2)}bH.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";bL=bH.getElementsByTagName("td");bQ=(bL[0].offsetHeight===0);bL[0].style.display="";bL[1].style.display="none";bE.reliableHiddenOffsets=bQ&&(bL[0].offsetHeight===0);bH.innerHTML="";if(au.defaultView&&au.defaultView.getComputedStyle){bB=au.createElement("div");bB.style.width="0";bB.style.marginRight="0";bH.appendChild(bB);bE.reliableMarginRight=(parseInt((au.defaultView.getComputedStyle(bB,null)||{marginRight:0}).marginRight,10)||0)===0}if(bH.attachEvent){for(bK in {submit:1,change:1,focusin:1}){bC="on"+bK;bQ=(bC in bH);if(!bQ){bH.setAttribute(bC,"return;");bQ=(typeof bH[bC]==="function")}bE[bK+"Bubbles"]=bQ}}b(function(){var bS,bZ,b0,bY,bT,bU,bR=1,bX="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",bW="visibility:hidden;border:0;",e="style='"+bX+"border:5px solid #000;padding:0;'",bV="<div "+e+"><div></div></div><table "+e+" cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";bF=au.getElementsByTagName("body")[0];if(!bF){return}bS=au.createElement("div");bS.style.cssText=bW+"width:0;height:0;position:static;top:0;margin-top:"+bR+"px";bF.insertBefore(bS,bF.firstChild);bD=au.createElement("div");bD.style.cssText=bX+bW;bD.innerHTML=bV;bS.appendChild(bD);bZ=bD.firstChild;b0=bZ.firstChild;bT=bZ.nextSibling.firstChild.firstChild;bU={doesNotAddBorder:(b0.offsetTop!==5),doesAddBorderForTableAndCells:(bT.offsetTop===5)};b0.style.position="fixed";b0.style.top="20px";bU.fixedPosition=(b0.offsetTop===20||b0.offsetTop===15);b0.style.position=b0.style.top="";bZ.style.overflow="hidden";bZ.style.position="relative";bU.subtractsBorderForOverflowNotVisible=(b0.offsetTop===-5);bU.doesNotIncludeMarginInBodyOffset=(bF.offsetTop!==bR);bF.removeChild(bS);bD=bS=null;b.extend(bE,bU)});bD.innerHTML="";bJ.removeChild(bD);bD=bx=bI=by=bF=bB=bH=bG=null;return bE})();b.boxModel=b.support.boxModel;var aS=/^(?:\{.*\}|\[.*\])$/,az=/([A-Z])/g;b.extend({cache:{},uuid:0,expando:"jQuery"+(b.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?b.cache[e[b.expando]]:e[b.expando];return !!e&&!T(e)},data:function(bz,bx,bB,bA){if(!b.acceptData(bz)){return}var bI,bC,bF,bG=b.expando,bE=typeof bx==="string",bH=bz.nodeType,e=bH?b.cache:bz,by=bH?bz[b.expando]:bz[b.expando]&&b.expando,bD=bx==="events";if((!by||!e[by]||(!bD&&!bA&&!e[by].data))&&bE&&bB===L){return}if(!by){if(bH){bz[b.expando]=by=++b.uuid}else{by=b.expando}}if(!e[by]){e[by]={};if(!bH){e[by].toJSON=b.noop}}if(typeof bx==="object"||typeof bx==="function"){if(bA){e[by]=b.extend(e[by],bx)}else{e[by].data=b.extend(e[by].data,bx)}}bI=bC=e[by];if(!bA){if(!bC.data){bC.data={}}bC=bC.data}if(bB!==L){bC[b.camelCase(bx)]=bB}if(bD&&!bC[bx]){return bI.events}if(bE){bF=bC[bx];if(bF==null){bF=bC[b.camelCase(bx)]}}else{bF=bC}return bF},removeData:function(bz,bx,bA){if(!b.acceptData(bz)){return}var bD,bC,bB,bE=b.expando,bF=bz.nodeType,e=bF?b.cache:bz,by=bF?bz[b.expando]:b.expando;if(!e[by]){return}if(bx){bD=bA?e[by]:e[by].data;if(bD){if(b.isArray(bx)){bx=bx}else{if(bx in bD){bx=[bx]}else{bx=b.camelCase(bx);if(bx in bD){bx=[bx]}else{bx=bx.split(" ")}}}for(bC=0,bB=bx.length;bC<bB;bC++){delete bD[bx[bC]]}if(!(bA?T:b.isEmptyObject)(bD)){return}}}if(!bA){delete e[by].data;if(!T(e[by])){return}}if(b.support.deleteExpando||!e.setInterval){delete e[by]}else{e[by]=null}if(bF){if(b.support.deleteExpando){delete bz[b.expando]}else{if(bz.removeAttribute){bz.removeAttribute(b.expando)}else{bz[b.expando]=null}}}},_data:function(bx,e,by){return b.data(bx,e,by,true)},acceptData:function(bx){if(bx.nodeName){var e=b.noData[bx.nodeName.toLowerCase()];if(e){return !(e===true||bx.getAttribute("classid")!==e)}}return true}});b.fn.extend({data:function(bA,bC){var bD,e,by,bB=null;if(typeof bA==="undefined"){if(this.length){bB=b.data(this[0]);if(this[0].nodeType===1&&!b._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var bz=0,bx=e.length;bz<bx;bz++){by=e[bz].name;if(by.indexOf("data-")===0){by=b.camelCase(by.substring(5));a6(this[0],by,bB[by])}}b._data(this[0],"parsedAttrs",true)}}return bB}else{if(typeof bA==="object"){return this.each(function(){b.data(this,bA)})}}bD=bA.split(".");bD[1]=bD[1]?"."+bD[1]:"";if(bC===L){bB=this.triggerHandler("getData"+bD[1]+"!",[bD[0]]);if(bB===L&&this.length){bB=b.data(this[0],bA);bB=a6(this[0],bA,bB)}return bB===L&&bD[1]?this.data(bD[0]):bB}else{return this.each(function(){var bF=b(this),bE=[bD[0],bC];bF.triggerHandler("setData"+bD[1]+"!",bE);b.data(this,bA,bC);bF.triggerHandler("changeData"+bD[1]+"!",bE)})}},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function a6(bz,by,bA){if(bA===L&&bz.nodeType===1){var bx="data-"+by.replace(az,"-$1").toLowerCase();bA=bz.getAttribute(bx);if(typeof bA==="string"){try{bA=bA==="true"?true:bA==="false"?false:bA==="null"?null:b.isNumeric(bA)?parseFloat(bA):aS.test(bA)?b.parseJSON(bA):bA}catch(bB){}b.data(bz,by,bA)}else{bA=L}}return bA}function T(bx){for(var e in bx){if(e==="data"&&b.isEmptyObject(bx[e])){continue}if(e!=="toJSON"){return false}}return true}function bj(bA,bz,bC){var by=bz+"defer",bx=bz+"queue",e=bz+"mark",bB=b._data(bA,by);if(bB&&(bC==="queue"||!b._data(bA,bx))&&(bC==="mark"||!b._data(bA,e))){setTimeout(function(){if(!b._data(bA,bx)&&!b._data(bA,e)){b.removeData(bA,by,true);bB.fire()}},0)}}b.extend({_mark:function(bx,e){if(bx){e=(e||"fx")+"mark";b._data(bx,e,(b._data(bx,e)||0)+1)}},_unmark:function(bA,bz,bx){if(bA!==true){bx=bz;bz=bA;bA=false}if(bz){bx=bx||"fx";var e=bx+"mark",by=bA?0:((b._data(bz,e)||1)-1);if(by){b._data(bz,e,by)}else{b.removeData(bz,e,true);bj(bz,bx,"mark")}}},queue:function(bx,e,bz){var by;if(bx){e=(e||"fx")+"queue";by=b._data(bx,e);if(bz){if(!by||b.isArray(bz)){by=b._data(bx,e,b.makeArray(bz))}else{by.push(bz)}}return by||[]}},dequeue:function(bA,bz){bz=bz||"fx";var bx=b.queue(bA,bz),by=bx.shift(),e={};if(by==="inprogress"){by=bx.shift()}if(by){if(bz==="fx"){bx.unshift("inprogress")}b._data(bA,bz+".run",e);by.call(bA,function(){b.dequeue(bA,bz)},e)}if(!bx.length){b.removeData(bA,bz+"queue "+bz+".run",true);bj(bA,bz,"queue")}}});b.fn.extend({queue:function(e,bx){if(typeof e!=="string"){bx=e;e="fx"}if(bx===L){return b.queue(this[0],e)}return this.each(function(){var by=b.queue(this,e,bx);if(e==="fx"&&by[0]!=="inprogress"){b.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(bx,e){bx=b.fx?b.fx.speeds[bx]||bx:bx;e=e||"fx";return this.queue(e,function(bz,by){var bA=setTimeout(bz,bx);by.stop=function(){clearTimeout(bA)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(bF,by){if(typeof bF!=="string"){by=bF;bF=L}bF=bF||"fx";var e=b.Deferred(),bx=this,bA=bx.length,bD=1,bB=bF+"defer",bC=bF+"queue",bE=bF+"mark",bz;function bG(){if(!(--bD)){e.resolveWith(bx,[bx])}}while(bA--){if((bz=b.data(bx[bA],bB,L,true)||(b.data(bx[bA],bC,L,true)||b.data(bx[bA],bE,L,true))&&b.data(bx[bA],bB,b.Callbacks("once memory"),true))){bD++;bz.add(bG)}}bG();return e.promise()}});var aP=/[\n\t\r]/g,af=/\s+/,aU=/\r/g,g=/^(?:button|input)$/i,D=/^(?:button|input|object|select|textarea)$/i,l=/^a(?:rea)?$/i,an=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,F=b.support.getSetAttribute,bf,aY,aE;b.fn.extend({attr:function(e,bx){return b.access(this,e,bx,true,b.attr)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,bx){return b.access(this,e,bx,true,b.prop)},removeProp:function(e){e=b.propFix[e]||e;return this.each(function(){try{this[e]=L;delete this[e]}catch(bx){}})},addClass:function(bA){var bC,by,bx,bz,bB,bD,e;if(b.isFunction(bA)){return this.each(function(bE){b(this).addClass(bA.call(this,bE,this.className))})}if(bA&&typeof bA==="string"){bC=bA.split(af);for(by=0,bx=this.length;by<bx;by++){bz=this[by];if(bz.nodeType===1){if(!bz.className&&bC.length===1){bz.className=bA}else{bB=" "+bz.className+" ";for(bD=0,e=bC.length;bD<e;bD++){if(!~bB.indexOf(" "+bC[bD]+" ")){bB+=bC[bD]+" "}}bz.className=b.trim(bB)}}}}return this},removeClass:function(bB){var bC,by,bx,bA,bz,bD,e;if(b.isFunction(bB)){return this.each(function(bE){b(this).removeClass(bB.call(this,bE,this.className))})}if((bB&&typeof bB==="string")||bB===L){bC=(bB||"").split(af);for(by=0,bx=this.length;by<bx;by++){bA=this[by];if(bA.nodeType===1&&bA.className){if(bB){bz=(" "+bA.className+" ").replace(aP," ");for(bD=0,e=bC.length;bD<e;bD++){bz=bz.replace(" "+bC[bD]+" "," ")}bA.className=b.trim(bz)}else{bA.className=""}}}}return this},toggleClass:function(bz,bx){var by=typeof bz,e=typeof bx==="boolean";if(b.isFunction(bz)){return this.each(function(bA){b(this).toggleClass(bz.call(this,bA,this.className,bx),bx)})}return this.each(function(){if(by==="string"){var bC,bB=0,bA=b(this),bD=bx,bE=bz.split(af);while((bC=bE[bB++])){bD=e?bD:!bA.hasClass(bC);bA[bD?"addClass":"removeClass"](bC)}}else{if(by==="undefined"||by==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||bz===false?"":b._data(this,"__className__")||""}}})},hasClass:function(e){var bz=" "+e+" ",by=0,bx=this.length;for(;by<bx;by++){if(this[by].nodeType===1&&(" "+this[by].className+" ").replace(aP," ").indexOf(bz)>-1){return true}}return false},val:function(bz){var e,bx,bA,by=this[0];if(!arguments.length){if(by){e=b.valHooks[by.nodeName.toLowerCase()]||b.valHooks[by.type];if(e&&"get" in e&&(bx=e.get(by,"value"))!==L){return bx}bx=by.value;return typeof bx==="string"?bx.replace(aU,""):bx==null?"":bx}return L}bA=b.isFunction(bz);return this.each(function(bC){var bB=b(this),bD;if(this.nodeType!==1){return}if(bA){bD=bz.call(this,bC,bB.val())}else{bD=bz}if(bD==null){bD=""}else{if(typeof bD==="number"){bD+=""}else{if(b.isArray(bD)){bD=b.map(bD,function(bE){return bE==null?"":bE+""})}}}e=b.valHooks[this.nodeName.toLowerCase()]||b.valHooks[this.type];if(!e||!("set" in e)||e.set(this,bD,"value")===L){this.value=bD}})}});b.extend({valHooks:{option:{get:function(e){var bx=e.attributes.value;return !bx||bx.specified?e.value:e.text}},select:{get:function(e){var bC,bx,bB,bz,bA=e.selectedIndex,bD=[],bE=e.options,by=e.type==="select-one";if(bA<0){return null}bx=by?bA:0;bB=by?bA+1:bE.length;for(;bx<bB;bx++){bz=bE[bx];if(bz.selected&&(b.support.optDisabled?!bz.disabled:bz.getAttribute("disabled")===null)&&(!bz.parentNode.disabled||!b.nodeName(bz.parentNode,"optgroup"))){bC=b(bz).val();if(by){return bC}bD.push(bC)}}if(by&&!bD.length&&bE.length){return b(bE[bA]).val()}return bD},set:function(bx,by){var e=b.makeArray(by);b(bx).find("option").each(function(){this.selected=b.inArray(b(this).val(),e)>=0});if(!e.length){bx.selectedIndex=-1}return e}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(bC,bz,bD,bB){var by,e,bA,bx=bC.nodeType;if(!bC||bx===3||bx===8||bx===2){return L}if(bB&&bz in b.attrFn){return b(bC)[bz](bD)}if(!("getAttribute" in bC)){return b.prop(bC,bz,bD)}bA=bx!==1||!b.isXMLDoc(bC);if(bA){bz=bz.toLowerCase();e=b.attrHooks[bz]||(an.test(bz)?aY:bf)}if(bD!==L){if(bD===null){b.removeAttr(bC,bz);return L}else{if(e&&"set" in e&&bA&&(by=e.set(bC,bD,bz))!==L){return by}else{bC.setAttribute(bz,""+bD);return bD}}}else{if(e&&"get" in e&&bA&&(by=e.get(bC,bz))!==null){return by}else{by=bC.getAttribute(bz);return by===null?L:by}}},removeAttr:function(bz,bB){var bA,bC,bx,e,by=0;if(bz.nodeType===1){bC=(bB||"").split(af);e=bC.length;for(;by<e;by++){bx=bC[by].toLowerCase();bA=b.propFix[bx]||bx;b.attr(bz,bx,"");bz.removeAttribute(F?bx:bA);if(an.test(bx)&&bA in bz){bz[bA]=false}}}},attrHooks:{type:{set:function(e,bx){if(g.test(e.nodeName)&&e.parentNode){b.error("type property can't be changed")}else{if(!b.support.radioValue&&bx==="radio"&&b.nodeName(e,"input")){var by=e.value;e.setAttribute("type",bx);if(by){e.value=by}return bx}}}},value:{get:function(bx,e){if(bf&&b.nodeName(bx,"button")){return bf.get(bx,e)}return e in bx?bx.value:null},set:function(bx,by,e){if(bf&&b.nodeName(bx,"button")){return bf.set(bx,by,e)}bx.value=by}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(bB,bz,bC){var by,e,bA,bx=bB.nodeType;if(!bB||bx===3||bx===8||bx===2){return L}bA=bx!==1||!b.isXMLDoc(bB);if(bA){bz=b.propFix[bz]||bz;e=b.propHooks[bz]}if(bC!==L){if(e&&"set" in e&&(by=e.set(bB,bC,bz))!==L){return by}else{return(bB[bz]=bC)}}else{if(e&&"get" in e&&(by=e.get(bB,bz))!==null){return by}else{return bB[bz]}}},propHooks:{tabIndex:{get:function(bx){var e=bx.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):D.test(bx.nodeName)||l.test(bx.nodeName)&&bx.href?0:L}}}});b.attrHooks.tabindex=b.propHooks.tabIndex;aY={get:function(bx,e){var bz,by=b.prop(bx,e);return by===true||typeof by!=="boolean"&&(bz=bx.getAttributeNode(e))&&bz.nodeValue!==false?e.toLowerCase():L},set:function(bx,bz,e){var by;if(bz===false){b.removeAttr(bx,e)}else{by=b.propFix[e]||e;if(by in bx){bx[by]=true}bx.setAttribute(e,e.toLowerCase())}return e}};if(!F){aE={name:true,id:true};bf=b.valHooks.button={get:function(by,bx){var e;e=by.getAttributeNode(bx);return e&&(aE[bx]?e.nodeValue!=="":e.specified)?e.nodeValue:L},set:function(by,bz,bx){var e=by.getAttributeNode(bx);if(!e){e=au.createAttribute(bx);by.setAttributeNode(e)}return(e.nodeValue=bz+"")}};b.attrHooks.tabindex.set=bf.set;b.each(["width","height"],function(bx,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{set:function(by,bz){if(bz===""){by.setAttribute(e,"auto");return bz}}})});b.attrHooks.contenteditable={get:bf.get,set:function(bx,by,e){if(by===""){by="false"}bf.set(bx,by,e)}}}if(!b.support.hrefNormalized){b.each(["href","src","width","height"],function(bx,e){b.attrHooks[e]=b.extend(b.attrHooks[e],{get:function(bz){var by=bz.getAttribute(e,2);return by===null?L:by}})})}if(!b.support.style){b.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||L},set:function(e,bx){return(e.style.cssText=""+bx)}}}if(!b.support.optSelected){b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(bx){var e=bx.parentNode;if(e){e.selectedIndex;if(e.parentNode){e.parentNode.selectedIndex}}return null}})}if(!b.support.enctype){b.propFix.enctype="encoding"}if(!b.support.checkOn){b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,bx){if(b.isArray(bx)){return(e.checked=b.inArray(b(e).val(),bx)>=0)}}})});var a0=/\.(.*)$/,be=/^(?:textarea|input|select)$/i,O=/\./g,bk=/ /g,aG=/[^\w\s.|`]/g,n=/^([^\.]*)?(?:\.(.+))?$/,J=/\bhover(\.\S+)?/,aO=/^key/,bg=/^(?:mouse|contextmenu)|click/,U=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,Y=function(e){var bx=U.exec(e);if(bx){bx[1]=(bx[1]||"").toLowerCase();bx[3]=bx[3]&&new RegExp("(?:^|\\s)"+bx[3]+"(?:\\s|$)")}return bx},j=function(bx,e){return((!e[1]||bx.nodeName.toLowerCase()===e[1])&&(!e[2]||bx.id===e[2])&&(!e[3]||e[3].test(bx.className)))},bv=function(e){return b.event.special.hover?e:e.replace(J,"mouseenter$1 mouseleave$1")};b.event={add:function(bz,bE,bL,bC,bA){var bF,bD,bM,bK,bJ,bH,e,bI,bx,bB,by,bG;if(bz.nodeType===3||bz.nodeType===8||!bE||!bL||!(bF=b._data(bz))){return}if(bL.handler){bx=bL;bL=bx.handler}if(!bL.guid){bL.guid=b.guid++}bM=bF.events;if(!bM){bF.events=bM={}}bD=bF.handle;if(!bD){bF.handle=bD=function(bN){return typeof b!=="undefined"&&(!bN||b.event.triggered!==bN.type)?b.event.dispatch.apply(bD.elem,arguments):L};bD.elem=bz}bE=bv(bE).split(" ");for(bK=0;bK<bE.length;bK++){bJ=n.exec(bE[bK])||[];bH=bJ[1];e=(bJ[2]||"").split(".").sort();bG=b.event.special[bH]||{};bH=(bA?bG.delegateType:bG.bindType)||bH;bG=b.event.special[bH]||{};bI=b.extend({type:bH,origType:bJ[1],data:bC,handler:bL,guid:bL.guid,selector:bA,namespace:e.join(".")},bx);if(bA){bI.quick=Y(bA);if(!bI.quick&&b.expr.match.POS.test(bA)){bI.isPositional=true}}by=bM[bH];if(!by){by=bM[bH]=[];by.delegateCount=0;if(!bG.setup||bG.setup.call(bz,bC,e,bD)===false){if(bz.addEventListener){bz.addEventListener(bH,bD,false)}else{if(bz.attachEvent){bz.attachEvent("on"+bH,bD)}}}}if(bG.add){bG.add.call(bz,bI);if(!bI.handler.guid){bI.handler.guid=bL.guid}}if(bA){by.splice(by.delegateCount++,0,bI)}else{by.push(bI)}b.event.global[bH]=true}bz=null},global:{},remove:function(by,bD,bJ,bz){var bE=b.hasData(by)&&b._data(by),bK,bL,bG,bx,bA,bB,bI,bF,bC,e,bH;if(!bE||!(bI=bE.events)){return}bD=bv(bD||"").split(" ");for(bK=0;bK<bD.length;bK++){bL=n.exec(bD[bK])||[];bG=bL[1];bx=bL[2];if(!bG){bx=bx?"."+bx:"";for(bB in bI){b.event.remove(by,bB+bx,bJ,bz)}return}bF=b.event.special[bG]||{};bG=(bz?bF.delegateType:bF.bindType)||bG;e=bI[bG]||[];bA=e.length;bx=bx?new RegExp("(^|\\.)"+bx.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;if(bJ||bx||bz||bF.remove){for(bB=0;bB<e.length;bB++){bH=e[bB];if(!bJ||bJ.guid===bH.guid){if(!bx||bx.test(bH.namespace)){if(!bz||bz===bH.selector||bz==="**"&&bH.selector){e.splice(bB--,1);if(bH.selector){e.delegateCount--}if(bF.remove){bF.remove.call(by,bH)}}}}}}else{e.length=0}if(e.length===0&&bA!==e.length){if(!bF.teardown||bF.teardown.call(by,bx)===false){b.removeEvent(by,bG,bE.handle)}delete bI[bG]}}if(b.isEmptyObject(bI)){bC=bE.handle;if(bC){bC.elem=null}b.removeData(by,["events","handle"],true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(bx,bF,bC,bL){if(bC&&(bC.nodeType===3||bC.nodeType===8)){return}var bI=bx.type||bx,bz=[],e,by,bE,bJ,bB,bA,bH,bG,bD,bK;if(bI.indexOf("!")>=0){bI=bI.slice(0,-1);by=true}if(bI.indexOf(".")>=0){bz=bI.split(".");bI=bz.shift();bz.sort()}if((!bC||b.event.customEvent[bI])&&!b.event.global[bI]){return}bx=typeof bx==="object"?bx[b.expando]?bx:new b.Event(bI,bx):new b.Event(bI);bx.type=bI;bx.isTrigger=true;bx.exclusive=by;bx.namespace=bz.join(".");bx.namespace_re=bx.namespace?new RegExp("(^|\\.)"+bz.join("\\.(?:.*\\.)?")+"(\\.|$)"):null;bA=bI.indexOf(":")<0?"on"+bI:"";if(bL||!bC){bx.preventDefault()}if(!bC){e=b.cache;for(bE in e){if(e[bE].events&&e[bE].events[bI]){b.event.trigger(bx,bF,e[bE].handle.elem,true)}}return}bx.result=L;if(!bx.target){bx.target=bC}bF=bF!=null?b.makeArray(bF):[];bF.unshift(bx);bH=b.event.special[bI]||{};if(bH.trigger&&bH.trigger.apply(bC,bF)===false){return}bD=[[bC,bH.bindType||bI]];if(!bL&&!bH.noBubble&&!b.isWindow(bC)){bK=bH.delegateType||bI;bB=null;for(bJ=bC.parentNode;bJ;bJ=bJ.parentNode){bD.push([bJ,bK]);bB=bJ}if(bB&&bB===bC.ownerDocument){bD.push([bB.defaultView||bB.parentWindow||bc,bK])}}for(bE=0;bE<bD.length;bE++){bJ=bD[bE][0];bx.type=bD[bE][1];bG=(b._data(bJ,"events")||{})[bx.type]&&b._data(bJ,"handle");if(bG){bG.apply(bJ,bF)}bG=bA&&bJ[bA];if(bG&&b.acceptData(bJ)){bG.apply(bJ,bF)}if(bx.isPropagationStopped()){break}}bx.type=bI;if(!bx.isDefaultPrevented()){if((!bH._default||bH._default.apply(bC.ownerDocument,bF)===false)&&!(bI==="click"&&b.nodeName(bC,"a"))&&b.acceptData(bC)){if(bA&&bC[bI]&&((bI!=="focus"&&bI!=="blur")||bx.target.offsetWidth!==0)&&!b.isWindow(bC)){bB=bC[bA];if(bB){bC[bA]=null}b.event.triggered=bI;bC[bI]();b.event.triggered=L;if(bB){bC[bA]=bB}}}}return bx.result},dispatch:function(bI){bI=b.event.fix(bI||bc.event);var bE=((b._data(this,"events")||{})[bI.type]||[]),bD=bE.delegateCount,bz=[].slice.call(arguments,0),bF=!bI.exclusive&&!bI.namespace,bB=(b.event.special[bI.type]||{}).handle,bx=[],bK,bH,bA,bM,bJ,bC,by,e,bG,bL,bN;bz[0]=bI;bI.delegateTarget=this;if(bD&&!bI.target.disabled&&!(bI.button&&bI.type==="click")){for(bA=bI.target;bA!=this;bA=bA.parentNode||this){bJ={};by=[];for(bK=0;bK<bD;bK++){e=bE[bK];bG=e.selector;bL=bJ[bG];if(e.isPositional){bL=(bL||(bJ[bG]=b(bG))).index(bA)>=0}else{if(bL===L){bL=bJ[bG]=(e.quick?j(bA,e.quick):b(bA).is(bG))}}if(bL){by.push(e)}}if(by.length){bx.push({elem:bA,matches:by})}}}if(bE.length>bD){bx.push({elem:this,matches:bE.slice(bD)})}for(bK=0;bK<bx.length&&!bI.isPropagationStopped();bK++){bC=bx[bK];bI.currentTarget=bC.elem;for(bH=0;bH<bC.matches.length&&!bI.isImmediatePropagationStopped();bH++){e=bC.matches[bH];if(bF||(!bI.namespace&&!e.namespace)||bI.namespace_re&&bI.namespace_re.test(e.namespace)){bI.data=e.data;bI.handleObj=e;bM=(bB||e.handler).apply(bC.elem,bz);if(bM!==L){bI.result=bM;if(bM===false){bI.preventDefault();bI.stopPropagation()}}}}}return bI.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(bx,e){if(bx.which==null){bx.which=e.charCode!=null?e.charCode:e.keyCode}return bx}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement wheelDelta".split(" "),filter:function(bz,by){var bA,bB,e,bx=by.button,bC=by.fromElement;if(bz.pageX==null&&by.clientX!=null){bA=bz.target.ownerDocument||au;bB=bA.documentElement;e=bA.body;bz.pageX=by.clientX+(bB&&bB.scrollLeft||e&&e.scrollLeft||0)-(bB&&bB.clientLeft||e&&e.clientLeft||0);bz.pageY=by.clientY+(bB&&bB.scrollTop||e&&e.scrollTop||0)-(bB&&bB.clientTop||e&&e.clientTop||0)}if(!bz.relatedTarget&&bC){bz.relatedTarget=bC===bz.target?by.toElement:bC}if(!bz.which&&bx!==L){bz.which=(bx&1?1:(bx&2?3:(bx&4?2:0)))}return bz}},fix:function(by){if(by[b.expando]){return by}var bx,bB,e=by,bz=b.event.fixHooks[by.type]||{},bA=bz.props?this.props.concat(bz.props):this.props;by=b.Event(e);for(bx=bA.length;bx;){bB=bA[--bx];by[bB]=e[bB]}if(!by.target){by.target=e.srcElement||au}if(by.target.nodeType===3){by.target=by.target.parentNode}if(by.metaKey===L){by.metaKey=by.ctrlKey}return bz.filter?bz.filter(by,e):by},special:{ready:{setup:b.bindReady},focus:{delegateType:"focusin",noBubble:true},blur:{delegateType:"focusout",noBubble:true},beforeunload:{setup:function(by,bx,e){if(b.isWindow(this)){this.onbeforeunload=e}},teardown:function(bx,e){if(this.onbeforeunload===e){this.onbeforeunload=null}}}},simulate:function(by,bA,bz,bx){var bB=b.extend(new b.Event(),bz,{type:by,isSimulated:true,originalEvent:{}});if(bx){b.event.trigger(bB,null,bA)}else{b.event.dispatch.call(bA,bB)}if(bB.isDefaultPrevented()){bz.preventDefault()}}};b.event.handle=b.event.dispatch;b.removeEvent=au.removeEventListener?function(bx,e,by){if(bx.removeEventListener){bx.removeEventListener(e,by,false)}}:function(bx,e,by){if(bx.detachEvent){bx.detachEvent("on"+e,by)}};b.Event=function(bx,e){if(!(this instanceof b.Event)){return new b.Event(bx,e)}if(bx&&bx.type){this.originalEvent=bx;this.type=bx.type;this.isDefaultPrevented=(bx.defaultPrevented||bx.returnValue===false||bx.getPreventDefault&&bx.getPreventDefault())?i:bm}else{this.type=bx}if(e){b.extend(this,e)}this.timeStamp=bx&&bx.timeStamp||b.now();this[b.expando]=true};function bm(){return false}function i(){return true}b.Event.prototype={preventDefault:function(){this.isDefaultPrevented=i;var bx=this.originalEvent;if(!bx){return}if(bx.preventDefault){bx.preventDefault()}else{bx.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=i;var bx=this.originalEvent;if(!bx){return}if(bx.stopPropagation){bx.stopPropagation()}bx.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i;this.stopPropagation()},isDefaultPrevented:bm,isPropagationStopped:bm,isImmediatePropagationStopped:bm};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bx,e){b.event.special[bx]=b.event.special[e]={delegateType:e,bindType:e,handle:function(bB){var bE=this,bD=bB.relatedTarget,bA=bB.handleObj,by=bA.selector,bC,bz;if(!bD||bA.origType===bB.type||(bD!==bE&&!b.contains(bE,bD))){bC=bB.type;bB.type=bA.origType;bz=bA.handler.apply(this,arguments);bB.type=bC}return bz}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(){if(b.nodeName(this,"form")){return false}b.event.add(this,"click._submit keypress._submit",function(bz){var by=bz.target,bx=b.nodeName(by,"input")||b.nodeName(by,"button")?by.form:L;if(bx&&!bx._submit_attached){b.event.add(bx,"submit._submit",function(e){if(this.parentNode){b.event.simulate("submit",this.parentNode,e,true)}});bx._submit_attached=true}})},teardown:function(){if(b.nodeName(this,"form")){return false}b.event.remove(this,"._submit")}}}if(!b.support.changeBubbles){b.event.special.change={setup:function(){if(be.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){b.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true}});b.event.add(this,"click._change",function(e){if(this._just_changed){this._just_changed=false;b.event.simulate("change",this,e,true)}})}return false}b.event.add(this,"beforeactivate._change",function(by){var bx=by.target;if(be.test(bx.nodeName)&&!bx._change_attached){b.event.add(bx,"change._change",function(e){if(this.parentNode&&!e.isSimulated){b.event.simulate("change",this.parentNode,e,true)}});bx._change_attached=true}})},handle:function(bx){var e=bx.target;if(this!==e||bx.isSimulated||bx.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return bx.handleObj.handler.apply(this,arguments)}},teardown:function(){b.event.remove(this,"._change");return be.test(this.nodeName)}}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(bz,e){var bx=0,by=function(bA){b.event.simulate(e,bA.target,b.event.fix(bA),true)};b.event.special[e]={setup:function(){if(bx++===0){au.addEventListener(bz,by,true)}},teardown:function(){if(--bx===0){au.removeEventListener(bz,by,true)}}}})}b.fn.extend({on:function(by,e,bB,bA,bx){var bC,bz;if(typeof by==="object"){if(typeof e!=="string"){bB=e;e=L}for(bz in by){this.on(bz,e,bB,by[bz],bx)}return this}if(bB==null&&bA==null){bA=e;bB=e=L}else{if(bA==null){if(typeof e==="string"){bA=bB;bB=L}else{bA=bB;bB=e;e=L}}}if(bA===false){bA=bm}else{if(!bA){return this}}if(bx===1){bC=bA;bA=function(bD){b().off(bD);return bC.apply(this,arguments)};bA.guid=bC.guid||(bC.guid=b.guid++)}return this.each(function(){b.event.add(this,by,bA,bB,e)})},one:function(bx,e,bz,by){return this.on.call(this,bx,e,bz,by,1)},off:function(by,e,bA){if(by&&by.preventDefault&&by.handleObj){var bx=by.handleObj;b(by.delegateTarget).off(bx.namespace?bx.type+"."+bx.namespace:bx.type,bx.selector,bx.handler);return this}if(typeof by==="object"){for(var bz in by){this.off(bz,e,by[bz])}return this}if(e===false||typeof e==="function"){bA=e;e=L}if(bA===false){bA=bm}return this.each(function(){b.event.remove(this,by,bA,e)})},bind:function(e,by,bx){return this.on(e,null,by,bx)},unbind:function(e,bx){return this.off(e,null,bx)},live:function(e,by,bx){b(this.context).on(e,this.selector,by,bx);return this},die:function(e,bx){b(this.context).off(e,this.selector||"**",bx);return this},delegate:function(e,bx,bz,by){return this.on(bx,e,bz,by)},undelegate:function(e,bx,by){return arguments.length==1?this.off(e,"**"):this.off(bx,e,by)},trigger:function(e,bx){return this.each(function(){b.event.trigger(e,bx,this)})},triggerHandler:function(e,bx){if(this[0]){return b.event.trigger(e,bx,this[0],true)}},toggle:function(bz){var bx=arguments,e=bz.guid||b.guid++,by=0,bA=function(bB){var bC=(b._data(this,"lastToggle"+bz.guid)||0)%by;b._data(this,"lastToggle"+bz.guid,bC+1);bB.preventDefault();return bx[bC].apply(this,arguments)||false};bA.guid=e;while(by<bx.length){bx[by++].guid=e}return this.click(bA)},hover:function(e,bx){return this.mouseenter(e).mouseleave(bx||e)}});b.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(bx,e){b.fn[e]=function(bz,by){if(by==null){by=bz;bz=null}return arguments.length>0?this.bind(e,bz,by):this.trigger(e)};if(b.attrFn){b.attrFn[e]=true}if(aO.test(e)){b.event.fixHooks[e]=b.event.keyHooks}if(bg.test(e)){b.event.fixHooks[e]=b.event.mouseHooks}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var bJ=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,bE="sizcache"+(Math.random()+"").replace(".",""),bK=0,bN=Object.prototype.toString,bD=false,bC=true,bM=/\\/g,bQ=/\r\n/g,bS=/\W/;[0,0].sort(function(){bC=false;return 0});var bA=function(bX,e,b0,b1){b0=b0||[];e=e||au;var b3=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!bX||typeof bX!=="string"){return b0}var bU,b5,b8,bT,b4,b7,b6,bZ,bW=true,bV=bA.isXML(e),bY=[],b2=bX;do{bJ.exec("");bU=bJ.exec(b2);if(bU){b2=bU[3];bY.push(bU[1]);if(bU[2]){bT=bU[3];break}}}while(bU);if(bY.length>1&&bF.exec(bX)){if(bY.length===2&&bG.relative[bY[0]]){b5=bO(bY[0]+bY[1],e,b1)}else{b5=bG.relative[bY[0]]?[e]:bA(bY.shift(),e);while(bY.length){bX=bY.shift();if(bG.relative[bX]){bX+=bY.shift()}b5=bO(bX,b5,b1)}}}else{if(!b1&&bY.length>1&&e.nodeType===9&&!bV&&bG.match.ID.test(bY[0])&&!bG.match.ID.test(bY[bY.length-1])){b4=bA.find(bY.shift(),e,bV);e=b4.expr?bA.filter(b4.expr,b4.set)[0]:b4.set[0]}if(e){b4=b1?{expr:bY.pop(),set:bH(b1)}:bA.find(bY.pop(),bY.length===1&&(bY[0]==="~"||bY[0]==="+")&&e.parentNode?e.parentNode:e,bV);b5=b4.expr?bA.filter(b4.expr,b4.set):b4.set;if(bY.length>0){b8=bH(b5)}else{bW=false}while(bY.length){b7=bY.pop();b6=b7;if(!bG.relative[b7]){b7=""}else{b6=bY.pop()}if(b6==null){b6=e}bG.relative[b7](b8,b6,bV)}}else{b8=bY=[]}}if(!b8){b8=b5}if(!b8){bA.error(b7||bX)}if(bN.call(b8)==="[object Array]"){if(!bW){b0.push.apply(b0,b8)}else{if(e&&e.nodeType===1){for(bZ=0;b8[bZ]!=null;bZ++){if(b8[bZ]&&(b8[bZ]===true||b8[bZ].nodeType===1&&bA.contains(e,b8[bZ]))){b0.push(b5[bZ])}}}else{for(bZ=0;b8[bZ]!=null;bZ++){if(b8[bZ]&&b8[bZ].nodeType===1){b0.push(b5[bZ])}}}}}else{bH(b8,b0)}if(bT){bA(bT,b3,b0,b1);bA.uniqueSort(b0)}return b0};bA.uniqueSort=function(bT){if(bL){bD=bC;bT.sort(bL);if(bD){for(var e=1;e<bT.length;e++){if(bT[e]===bT[e-1]){bT.splice(e--,1)}}}}return bT};bA.matches=function(e,bT){return bA(e,null,null,bT)};bA.matchesSelector=function(e,bT){return bA(bT,null,null,[e]).length>0};bA.find=function(bZ,e,b0){var bY,bU,bW,bV,bX,bT;if(!bZ){return[]}for(bU=0,bW=bG.order.length;bU<bW;bU++){bX=bG.order[bU];if((bV=bG.leftMatch[bX].exec(bZ))){bT=bV[1];bV.splice(1,1);if(bT.substr(bT.length-1)!=="\\"){bV[1]=(bV[1]||"").replace(bM,"");bY=bG.find[bX](bV,e,b0);if(bY!=null){bZ=bZ.replace(bG.match[bX],"");break}}}}if(!bY){bY=typeof e.getElementsByTagName!=="undefined"?e.getElementsByTagName("*"):[]}return{set:bY,expr:bZ}};bA.filter=function(b3,b2,b6,bW){var bY,e,b1,b8,b5,bT,bV,bX,b4,bU=b3,b7=[],b0=b2,bZ=b2&&b2[0]&&bA.isXML(b2[0]);while(b3&&b2.length){for(b1 in bG.filter){if((bY=bG.leftMatch[b1].exec(b3))!=null&&bY[2]){bT=bG.filter[b1];bV=bY[1];e=false;bY.splice(1,1);if(bV.substr(bV.length-1)==="\\"){continue}if(b0===b7){b7=[]}if(bG.preFilter[b1]){bY=bG.preFilter[b1](bY,b0,b6,b7,bW,bZ);if(!bY){e=b8=true}else{if(bY===true){continue}}}if(bY){for(bX=0;(b5=b0[bX])!=null;bX++){if(b5){b8=bT(b5,bY,bX,b0);b4=bW^b8;if(b6&&b8!=null){if(b4){e=true}else{b0[bX]=false}}else{if(b4){b7.push(b5);e=true}}}}}if(b8!==L){if(!b6){b0=b7}b3=b3.replace(bG.match[b1],"");if(!e){return[]}break}}}if(b3===bU){if(e==null){bA.error(b3)}else{break}}bU=b3}return b0};bA.error=function(e){throw"Syntax error, unrecognized expression: "+e};var by=bA.getText=function(bW){var bU,bV,e=bW.nodeType,bT="";if(e){if(e===1){if(typeof bW.textContent==="string"){return bW.textContent}else{if(typeof bW.innerText==="string"){return bW.innerText.replace(bQ,"")}else{for(bW=bW.firstChild;bW;bW=bW.nextSibling){bT+=by(bW)}}}}else{if(e===3||e===4){return bW.nodeValue}}}else{for(bU=0;(bV=bW[bU]);bU++){if(bV.nodeType!==8){bT+=by(bV)}}}return bT};var bG=bA.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")},type:function(e){return e.getAttribute("type")}},relative:{"+":function(bY,bT){var bV=typeof bT==="string",bX=bV&&!bS.test(bT),bZ=bV&&!bX;if(bX){bT=bT.toLowerCase()}for(var bU=0,e=bY.length,bW;bU<e;bU++){if((bW=bY[bU])){while((bW=bW.previousSibling)&&bW.nodeType!==1){}bY[bU]=bZ||bW&&bW.nodeName.toLowerCase()===bT?bW||false:bW===bT}}if(bZ){bA.filter(bT,bY,true)}},">":function(bY,bT){var bX,bW=typeof bT==="string",bU=0,e=bY.length;if(bW&&!bS.test(bT)){bT=bT.toLowerCase();for(;bU<e;bU++){bX=bY[bU];if(bX){var bV=bX.parentNode;bY[bU]=bV.nodeName.toLowerCase()===bT?bV:false}}}else{for(;bU<e;bU++){bX=bY[bU];if(bX){bY[bU]=bW?bX.parentNode:bX.parentNode===bT}}if(bW){bA.filter(bT,bY,true)}}},"":function(bV,bT,bX){var bW,bU=bK++,e=bP;if(typeof bT==="string"&&!bS.test(bT)){bT=bT.toLowerCase();bW=bT;e=bx}e("parentNode",bT,bU,bV,bW,bX)},"~":function(bV,bT,bX){var bW,bU=bK++,e=bP;if(typeof bT==="string"&&!bS.test(bT)){bT=bT.toLowerCase();bW=bT;e=bx}e("previousSibling",bT,bU,bV,bW,bX)}},find:{ID:function(bT,bU,bV){if(typeof bU.getElementById!=="undefined"&&!bV){var e=bU.getElementById(bT[1]);return e&&e.parentNode?[e]:[]}},NAME:function(bU,bX){if(typeof bX.getElementsByName!=="undefined"){var bT=[],bW=bX.getElementsByName(bU[1]);for(var bV=0,e=bW.length;bV<e;bV++){if(bW[bV].getAttribute("name")===bU[1]){bT.push(bW[bV])}}return bT.length===0?null:bT}},TAG:function(e,bT){if(typeof bT.getElementsByTagName!=="undefined"){return bT.getElementsByTagName(e[1])}}},preFilter:{CLASS:function(bV,bT,bU,e,bY,bZ){bV=" "+bV[1].replace(bM,"")+" ";if(bZ){return bV}for(var bW=0,bX;(bX=bT[bW])!=null;bW++){if(bX){if(bY^(bX.className&&(" "+bX.className+" ").replace(/[\t\n\r]/g," ").indexOf(bV)>=0)){if(!bU){e.push(bX)}}else{if(bU){bT[bW]=false}}}}return false},ID:function(e){return e[1].replace(bM,"")},TAG:function(bT,e){return bT[1].replace(bM,"").toLowerCase()},CHILD:function(e){if(e[1]==="nth"){if(!e[2]){bA.error(e[0])}e[2]=e[2].replace(/^\+|\s*/g,"");var bT=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(bT[1]+(bT[2]||1))-0;e[3]=bT[3]-0}else{if(e[2]){bA.error(e[0])}}e[0]=bK++;return e},ATTR:function(bW,bT,bU,e,bX,bY){var bV=bW[1]=bW[1].replace(bM,"");if(!bY&&bG.attrMap[bV]){bW[1]=bG.attrMap[bV]}bW[4]=(bW[4]||bW[5]||"").replace(bM,"");if(bW[2]==="~="){bW[4]=" "+bW[4]+" "}return bW},PSEUDO:function(bW,bT,bU,e,bX){if(bW[1]==="not"){if((bJ.exec(bW[3])||"").length>1||/^\w/.test(bW[3])){bW[3]=bA(bW[3],null,null,bT)}else{var bV=bA.filter(bW[3],bT,bU,true^bX);if(!bU){e.push.apply(e,bV)}return false}}else{if(bG.match.POS.test(bW[0])||bG.match.CHILD.test(bW[0])){return true}}return bW},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(bU,bT,e){return !!bA(e[3],bU).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(bU){var e=bU.getAttribute("type"),bT=bU.type;return bU.nodeName.toLowerCase()==="input"&&"text"===bT&&(e===bT||e===null)},radio:function(e){return e.nodeName.toLowerCase()==="input"&&"radio"===e.type},checkbox:function(e){return e.nodeName.toLowerCase()==="input"&&"checkbox"===e.type},file:function(e){return e.nodeName.toLowerCase()==="input"&&"file"===e.type},password:function(e){return e.nodeName.toLowerCase()==="input"&&"password"===e.type},submit:function(bT){var e=bT.nodeName.toLowerCase();return(e==="input"||e==="button")&&"submit"===bT.type},image:function(e){return e.nodeName.toLowerCase()==="input"&&"image"===e.type},reset:function(bT){var e=bT.nodeName.toLowerCase();return(e==="input"||e==="button")&&"reset"===bT.type},button:function(bT){var e=bT.nodeName.toLowerCase();return e==="input"&&"button"===bT.type||e==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)},focus:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(bT,e){return e===0},last:function(bU,bT,e,bV){return bT===bV.length-1},even:function(bT,e){return e%2===0},odd:function(bT,e){return e%2===1},lt:function(bU,bT,e){return bT<e[3]-0},gt:function(bU,bT,e){return bT>e[3]-0},nth:function(bU,bT,e){return e[3]-0===bT},eq:function(bU,bT,e){return e[3]-0===bT}},filter:{PSEUDO:function(bU,bZ,bY,b0){var e=bZ[1],bT=bG.filters[e];if(bT){return bT(bU,bY,bZ,b0)}else{if(e==="contains"){return(bU.textContent||bU.innerText||by([bU])||"").indexOf(bZ[3])>=0}else{if(e==="not"){var bV=bZ[3];for(var bX=0,bW=bV.length;bX<bW;bX++){if(bV[bX]===bU){return false}}return true}else{bA.error(e)}}}},CHILD:function(bU,bW){var bV,b2,bY,b1,e,bX,b0,bZ=bW[1],bT=bU;switch(bZ){case"only":case"first":while((bT=bT.previousSibling)){if(bT.nodeType===1){return false}}if(bZ==="first"){return true}bT=bU;case"last":while((bT=bT.nextSibling)){if(bT.nodeType===1){return false}}return true;case"nth":bV=bW[2];b2=bW[3];if(bV===1&&b2===0){return true}bY=bW[0];b1=bU.parentNode;if(b1&&(b1[bE]!==bY||!bU.nodeIndex)){bX=0;for(bT=b1.firstChild;bT;bT=bT.nextSibling){if(bT.nodeType===1){bT.nodeIndex=++bX}}b1[bE]=bY}b0=bU.nodeIndex-b2;if(bV===0){return b0===0}else{return(b0%bV===0&&b0/bV>=0)}}},ID:function(bT,e){return bT.nodeType===1&&bT.getAttribute("id")===e},TAG:function(bT,e){return(e==="*"&&bT.nodeType===1)||!!bT.nodeName&&bT.nodeName.toLowerCase()===e},CLASS:function(bT,e){return(" "+(bT.className||bT.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(bX,bV){var bU=bV[1],e=bA.attr?bA.attr(bX,bU):bG.attrHandle[bU]?bG.attrHandle[bU](bX):bX[bU]!=null?bX[bU]:bX.getAttribute(bU),bY=e+"",bW=bV[2],bT=bV[4];return e==null?bW==="!=":!bW&&bA.attr?e!=null:bW==="="?bY===bT:bW==="*="?bY.indexOf(bT)>=0:bW==="~="?(" "+bY+" ").indexOf(bT)>=0:!bT?bY&&e!==false:bW==="!="?bY!==bT:bW==="^="?bY.indexOf(bT)===0:bW==="$="?bY.substr(bY.length-bT.length)===bT:bW==="|="?bY===bT||bY.substr(0,bT.length+1)===bT+"-":false},POS:function(bW,bT,bU,bX){var e=bT[2],bV=bG.setFilters[e];if(bV){return bV(bW,bU,bT,bX)}}}};var bF=bG.match.POS,bz=function(bT,e){return"\\"+(e-0+1)};for(var bB in bG.match){bG.match[bB]=new RegExp(bG.match[bB].source+(/(?![^\[]*\])(?![^\(]*\))/.source));bG.leftMatch[bB]=new RegExp(/(^(?:.|\r|\n)*?)/.source+bG.match[bB].source.replace(/\\(\d+)/g,bz))}var bH=function(bT,e){bT=Array.prototype.slice.call(bT,0);if(e){e.push.apply(e,bT);return e}return bT};try{Array.prototype.slice.call(au.documentElement.childNodes,0)[0].nodeType}catch(bR){bH=function(bW,bV){var bU=0,bT=bV||[];if(bN.call(bW)==="[object Array]"){Array.prototype.push.apply(bT,bW)}else{if(typeof bW.length==="number"){for(var e=bW.length;bU<e;bU++){bT.push(bW[bU])}}else{for(;bW[bU];bU++){bT.push(bW[bU])}}}return bT}}var bL,bI;if(au.documentElement.compareDocumentPosition){bL=function(bT,e){if(bT===e){bD=true;return 0}if(!bT.compareDocumentPosition||!e.compareDocumentPosition){return bT.compareDocumentPosition?-1:1}return bT.compareDocumentPosition(e)&4?-1:1}}else{bL=function(b0,bZ){if(b0===bZ){bD=true;return 0}else{if(b0.sourceIndex&&bZ.sourceIndex){return b0.sourceIndex-bZ.sourceIndex}}var bX,bT,bU=[],e=[],bW=b0.parentNode,bY=bZ.parentNode,b1=bW;if(bW===bY){return bI(b0,bZ)}else{if(!bW){return -1}else{if(!bY){return 1}}}while(b1){bU.unshift(b1);b1=b1.parentNode}b1=bY;while(b1){e.unshift(b1);b1=b1.parentNode}bX=bU.length;bT=e.length;for(var bV=0;bV<bX&&bV<bT;bV++){if(bU[bV]!==e[bV]){return bI(bU[bV],e[bV])}}return bV===bX?bI(b0,e[bV],-1):bI(bU[bV],bZ,1)};bI=function(bT,e,bU){if(bT===e){return bU}var bV=bT.nextSibling;while(bV){if(bV===e){return -1}bV=bV.nextSibling}return 1}}(function(){var bT=au.createElement("div"),bU="script"+(new Date()).getTime(),e=au.documentElement;bT.innerHTML="<a name='"+bU+"'/>";e.insertBefore(bT,e.firstChild);if(au.getElementById(bU)){bG.find.ID=function(bW,bX,bY){if(typeof bX.getElementById!=="undefined"&&!bY){var bV=bX.getElementById(bW[1]);return bV?bV.id===bW[1]||typeof bV.getAttributeNode!=="undefined"&&bV.getAttributeNode("id").nodeValue===bW[1]?[bV]:L:[]}};bG.filter.ID=function(bX,bV){var bW=typeof bX.getAttributeNode!=="undefined"&&bX.getAttributeNode("id");return bX.nodeType===1&&bW&&bW.nodeValue===bV}}e.removeChild(bT);e=bT=null})();(function(){var e=au.createElement("div");e.appendChild(au.createComment(""));if(e.getElementsByTagName("*").length>0){bG.find.TAG=function(bT,bX){var bW=bX.getElementsByTagName(bT[1]);if(bT[1]==="*"){var bV=[];for(var bU=0;bW[bU];bU++){if(bW[bU].nodeType===1){bV.push(bW[bU])}}bW=bV}return bW}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){bG.attrHandle.href=function(bT){return bT.getAttribute("href",2)}}e=null})();if(au.querySelectorAll){(function(){var e=bA,bV=au.createElement("div"),bU="__sizzle__";bV.innerHTML="<p class='TEST'></p>";if(bV.querySelectorAll&&bV.querySelectorAll(".TEST").length===0){return}bA=function(b6,bX,b1,b5){bX=bX||au;if(!b5&&!bA.isXML(bX)){var b4=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b6);if(b4&&(bX.nodeType===1||bX.nodeType===9)){if(b4[1]){return bH(bX.getElementsByTagName(b6),b1)}else{if(b4[2]&&bG.find.CLASS&&bX.getElementsByClassName){return bH(bX.getElementsByClassName(b4[2]),b1)}}}if(bX.nodeType===9){if(b6==="body"&&bX.body){return bH([bX.body],b1)}else{if(b4&&b4[3]){var b0=bX.getElementById(b4[3]);if(b0&&b0.parentNode){if(b0.id===b4[3]){return bH([b0],b1)}}else{return bH([],b1)}}}try{return bH(bX.querySelectorAll(b6),b1)}catch(b2){}}else{if(bX.nodeType===1&&bX.nodeName.toLowerCase()!=="object"){var bY=bX,bZ=bX.getAttribute("id"),bW=bZ||bU,b8=bX.parentNode,b7=/^\s*[+~]/.test(b6);if(!bZ){bX.setAttribute("id",bW)}else{bW=bW.replace(/'/g,"\\$&")}if(b7&&b8){bX=bX.parentNode}try{if(!b7||b8){return bH(bX.querySelectorAll("[id='"+bW+"'] "+b6),b1)}}catch(b3){}finally{if(!bZ){bY.removeAttribute("id")}}}}}return e(b6,bX,b1,b5)};for(var bT in e){bA[bT]=e[bT]}bV=null})()}(function(){var e=au.documentElement,bU=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.msMatchesSelector;if(bU){var bW=!bU.call(au.createElement("div"),"div"),bT=false;try{bU.call(au.documentElement,"[test!='']:sizzle")}catch(bV){bT=true}bA.matchesSelector=function(bY,b0){b0=b0.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!bA.isXML(bY)){try{if(bT||!bG.match.PSEUDO.test(b0)&&!/!=/.test(b0)){var bX=bU.call(bY,b0);if(bX||!bW||bY.document&&bY.document.nodeType!==11){return bX}}}catch(bZ){}}return bA(b0,null,null,[bY]).length>0}}})();(function(){var e=au.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}bG.order.splice(1,0,"CLASS");bG.find.CLASS=function(bT,bU,bV){if(typeof bU.getElementsByClassName!=="undefined"&&!bV){return bU.getElementsByClassName(bT[1])}};e=null})();function bx(bT,bY,bX,b1,bZ,b0){for(var bV=0,bU=b1.length;bV<bU;bV++){var e=b1[bV];if(e){var bW=false;e=e[bT];while(e){if(e[bE]===bX){bW=b1[e.sizset];break}if(e.nodeType===1&&!b0){e[bE]=bX;e.sizset=bV}if(e.nodeName.toLowerCase()===bY){bW=e;break}e=e[bT]}b1[bV]=bW}}}function bP(bT,bY,bX,b1,bZ,b0){for(var bV=0,bU=b1.length;bV<bU;bV++){var e=b1[bV];if(e){var bW=false;e=e[bT];while(e){if(e[bE]===bX){bW=b1[e.sizset];break}if(e.nodeType===1){if(!b0){e[bE]=bX;e.sizset=bV}if(typeof bY!=="string"){if(e===bY){bW=true;break}}else{if(bA.filter(bY,[e]).length>0){bW=e;break}}}e=e[bT]}b1[bV]=bW}}}if(au.documentElement.contains){bA.contains=function(bT,e){return bT!==e&&(bT.contains?bT.contains(e):true)}}else{if(au.documentElement.compareDocumentPosition){bA.contains=function(bT,e){return !!(bT.compareDocumentPosition(e)&16)}}else{bA.contains=function(){return false}}}bA.isXML=function(e){var bT=(e?e.ownerDocument||e:0).documentElement;return bT?bT.nodeName!=="HTML":false};var bO=function(bU,e,bY){var bX,bZ=[],bW="",b0=e.nodeType?[e]:e;while((bX=bG.match.PSEUDO.exec(bU))){bW+=bX[0];bU=bU.replace(bG.match.PSEUDO,"")}bU=bG.relative[bU]?bU+"*":bU;for(var bV=0,bT=b0.length;bV<bT;bV++){bA(bU,b0[bV],bZ,bY)}return bA.filter(bW,bZ)};bA.attr=b.attr;bA.selectors.attrMap={};b.find=bA;b.expr=bA.selectors;b.expr[":"]=b.expr.filters;b.unique=bA.uniqueSort;b.text=bA.getText;b.isXMLDoc=bA.isXML;b.contains=bA.contains})();var ab=/Until$/,ap=/^(?:parents|prevUntil|prevAll)/,ba=/,/,br=/^.[^:#\[\.,]*$/,Q=Array.prototype.slice,H=b.expr.match.POS,ax={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(e){var by=this,bA,bx;if(typeof e!=="string"){return b(e).filter(function(){for(bA=0,bx=by.length;bA<bx;bA++){if(b.contains(by[bA],this)){return true}}})}var bz=this.pushStack("","find",e),bC,bD,bB;for(bA=0,bx=this.length;bA<bx;bA++){bC=bz.length;b.find(e,this[bA],bz);if(bA>0){for(bD=bC;bD<bz.length;bD++){for(bB=0;bB<bC;bB++){if(bz[bB]===bz[bD]){bz.splice(bD--,1);break}}}}}return bz},has:function(bx){var e=b(bx);return this.filter(function(){for(var bz=0,by=e.length;bz<by;bz++){if(b.contains(this,e[bz])){return true}}})},not:function(e){return this.pushStack(aF(this,e,false),"not",e)},filter:function(e){return this.pushStack(aF(this,e,true),"filter",e)},is:function(e){return !!e&&(typeof e==="string"?H.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(bA,bz){var bx=[],by,e,bB=this[0];if(b.isArray(bA)){var bD=1;while(bB&&bB.ownerDocument&&bB!==bz){for(by=0;by<bA.length;by++){if(b(bB).is(bA[by])){bx.push({selector:bA[by],elem:bB,level:bD})}}bB=bB.parentNode;bD++}return bx}var bC=H.test(bA)||typeof bA!=="string"?b(bA,bz||this.context):0;for(by=0,e=this.length;by<e;by++){bB=this[by];while(bB){if(bC?bC.index(bB)>-1:b.find.matchesSelector(bB,bA)){bx.push(bB);break}else{bB=bB.parentNode;if(!bB||!bB.ownerDocument||bB===bz||bB.nodeType===11){break}}}}bx=bx.length>1?b.unique(bx):bx;return this.pushStack(bx,"closest",bA)},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1}if(typeof e==="string"){return b.inArray(this[0],b(e))}return b.inArray(e.jquery?e[0]:e,this)},add:function(e,bx){var bz=typeof e==="string"?b(e,bx):b.makeArray(e&&e.nodeType?[e]:e),by=b.merge(this.get(),bz);return this.pushStack(C(bz[0])||C(by[0])?by:b.unique(by))},andSelf:function(){return this.add(this.prevObject)}});function C(e){return !e||!e.parentNode||e.parentNode.nodeType===11}b.each({parent:function(bx){var e=bx.parentNode;return e&&e.nodeType!==11?e:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(bx,e,by){return b.dir(bx,"parentNode",by)},next:function(e){return b.nth(e,2,"nextSibling")},prev:function(e){return b.nth(e,2,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(bx,e,by){return b.dir(bx,"nextSibling",by)},prevUntil:function(bx,e,by){return b.dir(bx,"previousSibling",by)},siblings:function(e){return b.sibling(e.parentNode.firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.makeArray(e.childNodes)}},function(e,bx){b.fn[e]=function(bB,by){var bA=b.map(this,bx,bB),bz=Q.call(arguments);if(!ab.test(e)){by=bB}if(by&&typeof by==="string"){bA=b.filter(by,bA)}bA=this.length>1&&!ax[e]?b.unique(bA):bA;if((this.length>1||ba.test(by))&&ap.test(e)){bA=bA.reverse()}return this.pushStack(bA,e,bz.join(","))}});b.extend({filter:function(by,e,bx){if(bx){by=":not("+by+")"}return e.length===1?b.find.matchesSelector(e[0],by)?[e[0]]:[]:b.find.matches(by,e)},dir:function(by,bx,bA){var e=[],bz=by[bx];while(bz&&bz.nodeType!==9&&(bA===L||bz.nodeType!==1||!b(bz).is(bA))){if(bz.nodeType===1){e.push(bz)}bz=bz[bx]}return e},nth:function(bA,e,by,bz){e=e||1;var bx=0;for(;bA;bA=bA[by]){if(bA.nodeType===1&&++bx===e){break}}return bA},sibling:function(by,bx){var e=[];for(;by;by=by.nextSibling){if(by.nodeType===1&&by!==bx){e.push(by)}}return e}});function aF(bz,by,e){by=by||0;if(b.isFunction(by)){return b.grep(bz,function(bB,bA){var bC=!!by.call(bB,bA,bB);return bC===e})}else{if(by.nodeType){return b.grep(bz,function(bB,bA){return(bB===by)===e})}else{if(typeof by==="string"){var bx=b.grep(bz,function(bA){return bA.nodeType===1});if(br.test(by)){return b.filter(by,bx,!e)}else{by=b.filter(by,bx)}}}}return b.grep(bz,function(bB,bA){return(b.inArray(bB,by)>=0)===e})}function a(e){var by=aR.split(" "),bx=e.createDocumentFragment();if(bx.createElement){while(by.length){bx.createElement(by.pop())}}return bx}var aR="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",ag=/ jQuery\d+="(?:\d+|null)"/g,aq=/^\s+/,S=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,d=/<([\w:]+)/,w=/<tbody/i,W=/<|&#?\w+;/,ae=/<(?:script|style)/i,P=/<(?:script|object|embed|option|style)/i,ah=new RegExp("<(?:"+aR.replace(" ","|")+")","i"),o=/checked\s*(?:[^=]|=\s*.checked.)/i,bo=/\/(java|ecma)script/i,aN=/^\s*<!(?:\[CDATA\[|\-\-)/,aw={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},ac=a(au);aw.optgroup=aw.option;aw.tbody=aw.tfoot=aw.colgroup=aw.caption=aw.thead;aw.th=aw.td;if(!b.support.htmlSerialize){aw._default=[1,"div<div>","</div>"]}b.fn.extend({text:function(e){if(b.isFunction(e)){return this.each(function(by){var bx=b(this);bx.text(e.call(this,by,bx.text()))})}if(typeof e!=="object"&&e!==L){return this.empty().append((this[0]&&this[0].ownerDocument||au).createTextNode(e))}return b.text(this)},wrapAll:function(e){if(b.isFunction(e)){return this.each(function(by){b(this).wrapAll(e.call(this,by))})}if(this[0]){var bx=b(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){bx.insertBefore(this[0])}bx.map(function(){var by=this;while(by.firstChild&&by.firstChild.nodeType===1){by=by.firstChild}return by}).append(this)}return this},wrapInner:function(e){if(b.isFunction(e)){return this.each(function(bx){b(this).wrapInner(e.call(this,bx))})}return this.each(function(){var bx=b(this),by=bx.contents();if(by.length){by.wrapAll(e)}else{bx.append(e)}})},wrap:function(e){return this.each(function(){b(this).wrapAll(e)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1){this.insertBefore(e,this.firstChild)}})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bx){this.parentNode.insertBefore(bx,this)})}else{if(arguments.length){var e=b(arguments[0]);e.push.apply(e,this.toArray());return this.pushStack(e,"before",arguments)}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(bx){this.parentNode.insertBefore(bx,this.nextSibling)})}else{if(arguments.length){var e=this.pushStack(this,"after",arguments);e.push.apply(e,b(arguments[0]).toArray());return e}}},remove:function(e,bz){for(var bx=0,by;(by=this[bx])!=null;bx++){if(!e||b.filter(e,[by]).length){if(!bz&&by.nodeType===1){b.cleanData(by.getElementsByTagName("*"));b.cleanData([by])}if(by.parentNode){by.parentNode.removeChild(by)}}}return this},empty:function(){for(var e=0,bx;(bx=this[e])!=null;e++){if(bx.nodeType===1){b.cleanData(bx.getElementsByTagName("*"))}while(bx.firstChild){bx.removeChild(bx.firstChild)}}return this},clone:function(bx,e){bx=bx==null?false:bx;e=e==null?bx:e;return this.map(function(){return b.clone(this,bx,e)})},html:function(bz){if(bz===L){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(ag,""):null}else{if(typeof bz==="string"&&!ae.test(bz)&&(b.support.leadingWhitespace||!aq.test(bz))&&!aw[(d.exec(bz)||["",""])[1].toLowerCase()]){bz=bz.replace(S,"<$1></$2>");try{for(var by=0,bx=this.length;by<bx;by++){if(this[by].nodeType===1){b.cleanData(this[by].getElementsByTagName("*"));this[by].innerHTML=bz}}}catch(bA){this.empty().append(bz)}}else{if(b.isFunction(bz)){this.each(function(bB){var e=b(this);e.html(bz.call(this,bB,e.html()))})}else{this.empty().append(bz)}}}return this},replaceWith:function(e){if(this[0]&&this[0].parentNode){if(b.isFunction(e)){return this.each(function(bz){var by=b(this),bx=by.html();by.replaceWith(e.call(this,bz,bx))})}if(typeof e!=="string"){e=b(e).detach()}return this.each(function(){var by=this.nextSibling,bx=this.parentNode;b(this).remove();if(by){b(by).before(e)}else{b(bx).append(e)}})}else{return this.length?this.pushStack(b(b.isFunction(e)?e():e),"replaceWith",e):this}},detach:function(e){return this.remove(e,true)},domManip:function(bD,bH,bG){var bz,bA,bC,bF,bE=bD[0],bx=[];if(!b.support.checkClone&&arguments.length===3&&typeof bE==="string"&&o.test(bE)){return this.each(function(){b(this).domManip(bD,bH,bG,true)})}if(b.isFunction(bE)){return this.each(function(bJ){var bI=b(this);bD[0]=bE.call(this,bJ,bH?bI.html():L);bI.domManip(bD,bH,bG)})}if(this[0]){bF=bE&&bE.parentNode;if(b.support.parentNode&&bF&&bF.nodeType===11&&bF.childNodes.length===this.length){bz={fragment:bF}}else{bz=b.buildFragment(bD,this,bx)}bC=bz.fragment;if(bC.childNodes.length===1){bA=bC=bC.firstChild}else{bA=bC.firstChild}if(bA){bH=bH&&b.nodeName(bA,"tr");for(var by=0,e=this.length,bB=e-1;by<e;by++){bG.call(bH?bb(this[by],bA):this[by],bz.cacheable||(e>1&&by<bB)?b.clone(bC,true,true):bC)}}if(bx.length){b.each(bx,bq)}}return this}});function bb(e,bx){return b.nodeName(e,"table")?(e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody"))):e}function t(bD,bx){if(bx.nodeType!==1||!b.hasData(bD)){return}var bA,bz,e,bC=b._data(bD),bB=b._data(bx,bC),by=bC.events;if(by){delete bB.handle;bB.events={};for(bA in by){for(bz=0,e=by[bA].length;bz<e;bz++){b.event.add(bx,bA+(by[bA][bz].namespace?".":"")+by[bA][bz].namespace,by[bA][bz],by[bA][bz].data)}}}if(bB.data){bB.data=b.extend({},bB.data)}}function ai(bx,e){var by;if(e.nodeType!==1){return}if(e.clearAttributes){e.clearAttributes()}if(e.mergeAttributes){e.mergeAttributes(bx)}by=e.nodeName.toLowerCase();if(by==="object"){e.outerHTML=bx.outerHTML}else{if(by==="input"&&(bx.type==="checkbox"||bx.type==="radio")){if(bx.checked){e.defaultChecked=e.checked=bx.checked}if(e.value!==bx.value){e.value=bx.value}}else{if(by==="option"){e.selected=bx.defaultSelected}else{if(by==="input"||by==="textarea"){e.defaultValue=bx.defaultValue}}}}e.removeAttribute(b.expando)}b.buildFragment=function(bB,bz,bx){var bA,e,by,bC,bD=bB[0];if(bz&&bz[0]){bC=bz[0].ownerDocument||bz[0]}if(!bC.createDocumentFragment){bC=au}if(bB.length===1&&typeof bD==="string"&&bD.length<512&&bC===au&&bD.charAt(0)==="<"&&!P.test(bD)&&(b.support.checkClone||!o.test(bD))&&(!b.support.unknownElems&&ah.test(bD))){e=true;by=b.fragments[bD];if(by&&by!==1){bA=by}}if(!bA){bA=bC.createDocumentFragment();b.clean(bB,bC,bA,bx)}if(e){b.fragments[bD]=by?bA:1}return{fragment:bA,cacheable:e}};b.fragments={};b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,bx){b.fn[e]=function(by){var bB=[],bE=b(by),bD=this.length===1&&this[0].parentNode;if(bD&&bD.nodeType===11&&bD.childNodes.length===1&&bE.length===1){bE[bx](this[0]);return this}else{for(var bC=0,bz=bE.length;bC<bz;bC++){var bA=(bC>0?this.clone(true):this).get();b(bE[bC])[bx](bA);bB=bB.concat(bA)}return this.pushStack(bB,e,bE.selector)}}});function bh(e){if(typeof e.getElementsByTagName!=="undefined"){return e.getElementsByTagName("*")}else{if(typeof e.querySelectorAll!=="undefined"){return e.querySelectorAll("*")}else{return[]}}}function ay(e){if(e.type==="checkbox"||e.type==="radio"){e.defaultChecked=e.checked}}function E(e){var bx=(e.nodeName||"").toLowerCase();if(bx==="input"){ay(e)}else{if(bx!=="script"&&typeof e.getElementsByTagName!=="undefined"){b.grep(e.getElementsByTagName("input"),ay)}}}b.extend({clone:function(bA,bC,by){var bB=bA.cloneNode(true),e,bx,bz;if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(bA.nodeType===1||bA.nodeType===11)&&!b.isXMLDoc(bA)){ai(bA,bB);e=bh(bA);bx=bh(bB);for(bz=0;e[bz];++bz){if(bx[bz]){ai(e[bz],bx[bz])}}}if(bC){t(bA,bB);if(by){e=bh(bA);bx=bh(bB);for(bz=0;e[bz];++bz){t(e[bz],bx[bz])}}}e=bx=null;return bB},clean:function(by,bA,bJ,bC){var bH;bA=bA||au;if(typeof bA.createElement==="undefined"){bA=bA.ownerDocument||bA[0]&&bA[0].ownerDocument||au}var bK=[],bD;for(var bG=0,bB;(bB=by[bG])!=null;bG++){if(typeof bB==="number"){bB+=""}if(!bB){continue}if(typeof bB==="string"){if(!W.test(bB)){bB=bA.createTextNode(bB)}else{bB=bB.replace(S,"<$1></$2>");var bM=(d.exec(bB)||["",""])[1].toLowerCase(),bz=aw[bM]||aw._default,bF=bz[0],bx=bA.createElement("div");if(bA===au){ac.appendChild(bx)}else{a(bA).appendChild(bx)}bx.innerHTML=bz[1]+bB+bz[2];while(bF--){bx=bx.lastChild}if(!b.support.tbody){var e=w.test(bB),bE=bM==="table"&&!e?bx.firstChild&&bx.firstChild.childNodes:bz[1]==="<table>"&&!e?bx.childNodes:[];for(bD=bE.length-1;bD>=0;--bD){if(b.nodeName(bE[bD],"tbody")&&!bE[bD].childNodes.length){bE[bD].parentNode.removeChild(bE[bD])}}}if(!b.support.leadingWhitespace&&aq.test(bB)){bx.insertBefore(bA.createTextNode(aq.exec(bB)[0]),bx.firstChild)}bB=bx.childNodes}}var bI;if(!b.support.appendChecked){if(bB[0]&&typeof(bI=bB.length)==="number"){for(bD=0;bD<bI;bD++){E(bB[bD])}}else{E(bB)}}if(bB.nodeType){bK.push(bB)}else{bK=b.merge(bK,bB)}}if(bJ){bH=function(bN){return !bN.type||bo.test(bN.type)};for(bG=0;bK[bG];bG++){if(bC&&b.nodeName(bK[bG],"script")&&(!bK[bG].type||bK[bG].type.toLowerCase()==="text/javascript")){bC.push(bK[bG].parentNode?bK[bG].parentNode.removeChild(bK[bG]):bK[bG])}else{if(bK[bG].nodeType===1){var bL=b.grep(bK[bG].getElementsByTagName("script"),bH);bK.splice.apply(bK,[bG+1,0].concat(bL))}bJ.appendChild(bK[bG])}}}return bK},cleanData:function(bx){var bA,by,e=b.cache,bD=b.event.special,bC=b.support.deleteExpando;for(var bB=0,bz;(bz=bx[bB])!=null;bB++){if(bz.nodeName&&b.noData[bz.nodeName.toLowerCase()]){continue}by=bz[b.expando];if(by){bA=e[by];if(bA&&bA.events){for(var bE in bA.events){if(bD[bE]){b.event.remove(bz,bE)}else{b.removeEvent(bz,bE,bA.handle)}}if(bA.handle){bA.handle.elem=null}}if(bC){delete bz[b.expando]}else{if(bz.removeAttribute){bz.removeAttribute(b.expando)}}delete e[by]}}}});function bq(e,bx){if(bx.src){b.ajax({url:bx.src,async:false,dataType:"script"})}else{b.globalEval((bx.text||bx.textContent||bx.innerHTML||"").replace(aN,"/*$0*/"))}if(bx.parentNode){bx.parentNode.removeChild(bx)}}var ak=/alpha\([^)]*\)/i,at=/opacity=([^)]*)/,z=/([A-Z]|^ms)/g,bd=/^-?\d+(?:px)?$/i,bp=/^-?\d/,I=/^([\-+])=([\-+.\de]+)/,a8={position:"absolute",visibility:"hidden",display:"block"},am=["Left","Right"],a2=["Top","Bottom"],Z,aI,aX;b.fn.css=function(e,bx){if(arguments.length===2&&bx===L){return this}return b.access(this,e,bx,true,function(bz,by,bA){return bA!==L?b.style(bz,by,bA):b.css(bz,by)})};b.extend({cssHooks:{opacity:{get:function(by,bx){if(bx){var e=Z(by,"opacity","opacity");return e===""?"1":e}else{return by.style.opacity}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(bz,by,bF,bA){if(!bz||bz.nodeType===3||bz.nodeType===8||!bz.style){return}var bD,bE,bB=b.camelCase(by),bx=bz.style,bG=b.cssHooks[bB];by=b.cssProps[bB]||bB;if(bF!==L){bE=typeof bF;if(bE==="string"&&(bD=I.exec(bF))){bF=(+(bD[1]+1)*+bD[2])+parseFloat(b.css(bz,by));bE="number"}if(bF==null||bE==="number"&&isNaN(bF)){return}if(bE==="number"&&!b.cssNumber[bB]){bF+="px"}if(!bG||!("set" in bG)||(bF=bG.set(bz,bF))!==L){try{bx[by]=bF}catch(bC){}}}else{if(bG&&"get" in bG&&(bD=bG.get(bz,false,bA))!==L){return bD}return bx[by]}},css:function(bA,bz,bx){var by,e;bz=b.camelCase(bz);e=b.cssHooks[bz];bz=b.cssProps[bz]||bz;if(bz==="cssFloat"){bz="float"}if(e&&"get" in e&&(by=e.get(bA,true,bx))!==L){return by}else{if(Z){return Z(bA,bz)}}},swap:function(bz,by,bA){var e={};for(var bx in by){e[bx]=bz.style[bx];bz.style[bx]=by[bx]}bA.call(bz);for(bx in by){bz.style[bx]=e[bx]}}});b.curCSS=b.css;b.each(["height","width"],function(bx,e){b.cssHooks[e]={get:function(bA,bz,by){var bB;if(bz){if(bA.offsetWidth!==0){return p(bA,e,by)}else{b.swap(bA,a8,function(){bB=p(bA,e,by)})}return bB}},set:function(by,bz){if(bd.test(bz)){bz=parseFloat(bz);if(bz>=0){return bz+"px"}}else{return bz}}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(bx,e){return at.test((e&&bx.currentStyle?bx.currentStyle.filter:bx.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":e?"1":""},set:function(bA,bB){var bz=bA.style,bx=bA.currentStyle,e=b.isNumeric(bB)?"alpha(opacity="+bB*100+")":"",by=bx&&bx.filter||bz.filter||"";bz.zoom=1;if(bB>=1&&b.trim(by.replace(ak,""))===""){bz.removeAttribute("filter");if(bx&&!bx.filter){return}}bz.filter=ak.test(by)?by.replace(ak,e):by+" "+e}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(by,bx){var e;b.swap(by,{display:"inline-block"},function(){if(bx){e=Z(by,"margin-right","marginRight")}else{e=by.style.marginRight}});return e}}}});if(au.defaultView&&au.defaultView.getComputedStyle){aI=function(bA,by){var bx,bz,e;by=by.replace(z,"-$1").toLowerCase();if(!(bz=bA.ownerDocument.defaultView)){return L}if((e=bz.getComputedStyle(bA,null))){bx=e.getPropertyValue(by);if(bx===""&&!b.contains(bA.ownerDocument.documentElement,bA)){bx=b.style(bA,by)}}return bx}}if(au.documentElement.currentStyle){aX=function(bB,by){var bC,e,bA,bx=bB.currentStyle&&bB.currentStyle[by],bz=bB.style;if(bx===null&&bz&&(bA=bz[by])){bx=bA}if(!bd.test(bx)&&bp.test(bx)){bC=bz.left;e=bB.runtimeStyle&&bB.runtimeStyle.left;if(e){bB.runtimeStyle.left=bB.currentStyle.left}bz.left=by==="fontSize"?"1em":(bx||0);bx=bz.pixelLeft+"px";bz.left=bC;if(e){bB.runtimeStyle.left=e}}return bx===""?"auto":bx}}Z=aI||aX;function p(by,bx,e){var bA=bx==="width"?by.offsetWidth:by.offsetHeight,bz=bx==="width"?am:a2;if(bA>0){if(e!=="border"){b.each(bz,function(){if(!e){bA-=parseFloat(b.css(by,"padding"+this))||0}if(e==="margin"){bA+=parseFloat(b.css(by,e+this))||0}else{bA-=parseFloat(b.css(by,"border"+this+"Width"))||0}})}return bA+"px"}bA=Z(by,bx,bx);if(bA<0||bA==null){bA=by.style[bx]||0}bA=parseFloat(bA)||0;if(e){b.each(bz,function(){bA+=parseFloat(b.css(by,"padding"+this))||0;if(e!=="padding"){bA+=parseFloat(b.css(by,"border"+this+"Width"))||0}if(e==="margin"){bA+=parseFloat(b.css(by,e+this))||0}})}return bA+"px"}if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(by){var bx=by.offsetWidth,e=by.offsetHeight;return(bx===0&&e===0)||(!b.support.reliableHiddenOffsets&&((by.style&&by.style.display)||b.css(by,"display"))==="none")};b.expr.filters.visible=function(e){return !b.expr.filters.hidden(e)}}var k=/%20/g,ao=/\[\]$/,bu=/\r?\n/g,bs=/#.*$/,aC=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,aZ=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aM=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,aQ=/^(?:GET|HEAD)$/,c=/^\/\//,M=/\?/,a7=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,q=/^(?:select|textarea)/i,h=/\s+/,bt=/([?&])_=[^&]*/,K=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,A=b.fn.load,aa={},r={},aD,s,aV=["*/"]+["*"];try{aD=bn.href}catch(av){aD=au.createElement("a");aD.href="";aD=aD.href}s=K.exec(aD.toLowerCase())||[];function f(e){return function(bA,bC){if(typeof bA!=="string"){bC=bA;bA="*"}if(b.isFunction(bC)){var bz=bA.toLowerCase().split(h),by=0,bB=bz.length,bx,bD,bE;for(;by<bB;by++){bx=bz[by];bE=/^\+/.test(bx);if(bE){bx=bx.substr(1)||"*"}bD=e[bx]=e[bx]||[];bD[bE?"unshift":"push"](bC)}}}}function aW(bx,bG,bB,bF,bD,bz){bD=bD||bG.dataTypes[0];bz=bz||{};bz[bD]=true;var bC=bx[bD],by=0,e=bC?bC.length:0,bA=(bx===aa),bE;for(;by<e&&(bA||!bE);by++){bE=bC[by](bG,bB,bF);if(typeof bE==="string"){if(!bA||bz[bE]){bE=L}else{bG.dataTypes.unshift(bE);bE=aW(bx,bG,bB,bF,bE,bz)}}}if((bA||!bE)&&!bz["*"]){bE=aW(bx,bG,bB,bF,"*",bz)}return bE}function al(by,bz){var bx,e,bA=b.ajaxSettings.flatOptions||{};for(bx in bz){if(bz[bx]!==L){(bA[bx]?by:(e||(e={})))[bx]=bz[bx]}}if(e){b.extend(true,by,e)}}b.fn.extend({load:function(by,bB,bC){if(typeof by!=="string"&&A){return A.apply(this,arguments)}else{if(!this.length){return this}}var bA=by.indexOf(" ");if(bA>=0){var e=by.slice(bA,by.length);by=by.slice(0,bA)}var bz="GET";if(bB){if(b.isFunction(bB)){bC=bB;bB=L}else{if(typeof bB==="object"){bB=b.param(bB,b.ajaxSettings.traditional);bz="POST"}}}var bx=this;b.ajax({url:by,type:bz,dataType:"html",data:bB,complete:function(bE,bD,bF){bF=bE.responseText;if(bE.isResolved()){bE.done(function(bG){bF=bG});bx.html(e?b("<div>").append(bF.replace(a7,"")).find(e):bF)}if(bC){bx.each(bC,[bF,bD,bE])}}});return this},serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?b.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||q.test(this.nodeName)||aZ.test(this.type))}).map(function(e,bx){var by=b(this).val();return by==null?null:b.isArray(by)?b.map(by,function(bA,bz){return{name:bx.name,value:bA.replace(bu,"\r\n")}}):{name:bx.name,value:by.replace(bu,"\r\n")}}).get()}});b.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,bx){b.fn[bx]=function(by){return this.bind(bx,by)}});b.each(["get","post"],function(e,bx){b[bx]=function(by,bA,bB,bz){if(b.isFunction(bA)){bz=bz||bB;bB=bA;bA=L}return b.ajax({type:bx,url:by,data:bA,success:bB,dataType:bz})}});b.extend({getScript:function(e,bx){return b.get(e,L,bx,"script")},getJSON:function(e,bx,by){return b.get(e,bx,by,"json")},ajaxSetup:function(bx,e){if(e){al(bx,b.ajaxSettings)}else{e=bx;bx=b.ajaxSettings}al(bx,e);return bx},ajaxSettings:{url:aD,isLocal:aM.test(s[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":aV},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":bc.String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:f(aa),ajaxTransport:f(r),ajax:function(bB,bz){if(typeof bB==="object"){bz=bB;bB=L}bz=bz||{};var bF=b.ajaxSetup({},bz),bU=bF.context||bF,bI=bU!==bF&&(bU.nodeType||bU instanceof b)?b(bU):b.event,bT=b.Deferred(),bP=b.Callbacks("once memory"),bD=bF.statusCode||{},bE,bJ={},bQ={},bS,bA,bN,bG,bK,bC=0,by,bM,bL={readyState:0,setRequestHeader:function(bV,bW){if(!bC){var e=bV.toLowerCase();bV=bQ[e]=bQ[e]||bV;bJ[bV]=bW}return this},getAllResponseHeaders:function(){return bC===2?bS:null},getResponseHeader:function(bV){var e;if(bC===2){if(!bA){bA={};while((e=aC.exec(bS))){bA[e[1].toLowerCase()]=e[2]}}e=bA[bV.toLowerCase()]}return e===L?null:e},overrideMimeType:function(e){if(!bC){bF.mimeType=e}return this},abort:function(e){e=e||"abort";if(bN){bN.abort(e)}bH(0,e);return this}};function bH(b1,bW,b2,bY){if(bC===2){return}bC=2;if(bG){clearTimeout(bG)}bN=L;bS=bY||"";bL.readyState=b1>0?4:0;var bV,b6,b5,bZ=bW,b0=b2?bl(bF,bL,b2):L,bX,b4;if(b1>=200&&b1<300||b1===304){if(bF.ifModified){if((bX=bL.getResponseHeader("Last-Modified"))){b.lastModified[bE]=bX}if((b4=bL.getResponseHeader("Etag"))){b.etag[bE]=b4}}if(b1===304){bZ="notmodified";bV=true}else{try{b6=G(bF,b0);bZ="success";bV=true}catch(b3){bZ="parsererror";b5=b3}}}else{b5=bZ;if(!bZ||b1){bZ="error";if(b1<0){b1=0}}}bL.status=b1;bL.statusText=""+(bW||bZ);if(bV){bT.resolveWith(bU,[b6,bZ,bL])}else{bT.rejectWith(bU,[bL,bZ,b5])}bL.statusCode(bD);bD=L;if(by){bI.trigger("ajax"+(bV?"Success":"Error"),[bL,bF,bV?b6:b5])}bP.fireWith(bU,[bL,bZ]);if(by){bI.trigger("ajaxComplete",[bL,bF]);if(!(--b.active)){b.event.trigger("ajaxStop")}}}bT.promise(bL);bL.success=bL.done;bL.error=bL.fail;bL.complete=bP.add;bL.statusCode=function(bV){if(bV){var e;if(bC<2){for(e in bV){bD[e]=[bD[e],bV[e]]}}else{e=bV[bL.status];bL.then(e,e)}}return this};bF.url=((bB||bF.url)+"").replace(bs,"").replace(c,s[1]+"//");bF.dataTypes=b.trim(bF.dataType||"*").toLowerCase().split(h);if(bF.crossDomain==null){bK=K.exec(bF.url.toLowerCase());bF.crossDomain=!!(bK&&(bK[1]!=s[1]||bK[2]!=s[2]||(bK[3]||(bK[1]==="http:"?80:443))!=(s[3]||(s[1]==="http:"?80:443))))}if(bF.data&&bF.processData&&typeof bF.data!=="string"){bF.data=b.param(bF.data,bF.traditional)}aW(aa,bF,bz,bL);if(bC===2){return false}by=bF.global;bF.type=bF.type.toUpperCase();bF.hasContent=!aQ.test(bF.type);if(by&&b.active++===0){b.event.trigger("ajaxStart")}if(!bF.hasContent){if(bF.data){bF.url+=(M.test(bF.url)?"&":"?")+bF.data;delete bF.data}bE=bF.url;if(bF.cache===false){var bx=b.now(),bR=bF.url.replace(bt,"$1_="+bx);bF.url=bR+((bR===bF.url)?(M.test(bF.url)?"&":"?")+"_="+bx:"")}}if(bF.data&&bF.hasContent&&bF.contentType!==false||bz.contentType){bL.setRequestHeader("Content-Type",bF.contentType)}if(bF.ifModified){bE=bE||bF.url;if(b.lastModified[bE]){bL.setRequestHeader("If-Modified-Since",b.lastModified[bE])}if(b.etag[bE]){bL.setRequestHeader("If-None-Match",b.etag[bE])}}bL.setRequestHeader("Accept",bF.dataTypes[0]&&bF.accepts[bF.dataTypes[0]]?bF.accepts[bF.dataTypes[0]]+(bF.dataTypes[0]!=="*"?", "+aV+"; q=0.01":""):bF.accepts["*"]);for(bM in bF.headers){bL.setRequestHeader(bM,bF.headers[bM])}if(bF.beforeSend&&(bF.beforeSend.call(bU,bL,bF)===false||bC===2)){bL.abort();return false}for(bM in {success:1,error:1,complete:1}){bL[bM](bF[bM])}bN=aW(r,bF,bz,bL);if(!bN){bH(-1,"No Transport")}else{bL.readyState=1;if(by){bI.trigger("ajaxSend",[bL,bF])}if(bF.async&&bF.timeout>0){bG=setTimeout(function(){bL.abort("timeout")},bF.timeout)}try{bC=1;bN.send(bJ,bH)}catch(bO){if(bC<2){bH(-1,bO)}else{b.error(bO)}}}return bL},param:function(e,by){var bx=[],bA=function(bB,bC){bC=b.isFunction(bC)?bC():bC;bx[bx.length]=encodeURIComponent(bB)+"="+encodeURIComponent(bC)};if(by===L){by=b.ajaxSettings.traditional}if(b.isArray(e)||(e.jquery&&!b.isPlainObject(e))){b.each(e,function(){bA(this.name,this.value)})}else{for(var bz in e){v(bz,e[bz],by,bA)}}return bx.join("&").replace(k,"+")}});function v(by,bA,bx,bz){if(b.isArray(bA)){b.each(bA,function(bC,bB){if(bx||ao.test(by)){bz(by,bB)}else{v(by+"["+(typeof bB==="object"||b.isArray(bB)?bC:"")+"]",bB,bx,bz)}})}else{if(!bx&&bA!=null&&typeof bA==="object"){for(var e in bA){v(by+"["+e+"]",bA[e],bx,bz)}}else{bz(by,bA)}}}b.extend({active:0,lastModified:{},etag:{}});function bl(bF,bE,bB){var bx=bF.contents,bD=bF.dataTypes,by=bF.responseFields,bA,bC,bz,e;for(bC in by){if(bC in bB){bE[by[bC]]=bB[bC]}}while(bD[0]==="*"){bD.shift();if(bA===L){bA=bF.mimeType||bE.getResponseHeader("content-type")}}if(bA){for(bC in bx){if(bx[bC]&&bx[bC].test(bA)){bD.unshift(bC);break}}}if(bD[0] in bB){bz=bD[0]}else{for(bC in bB){if(!bD[0]||bF.converters[bC+" "+bD[0]]){bz=bC;break}if(!e){e=bC}}bz=bz||e}if(bz){if(bz!==bD[0]){bD.unshift(bz)}return bB[bz]}}function G(bJ,bB){if(bJ.dataFilter){bB=bJ.dataFilter(bB,bJ.dataType)}var bF=bJ.dataTypes,bI={},bC,bG,by=bF.length,bD,bE=bF[0],bz,bA,bH,bx,e;for(bC=1;bC<by;bC++){if(bC===1){for(bG in bJ.converters){if(typeof bG==="string"){bI[bG.toLowerCase()]=bJ.converters[bG]}}}bz=bE;bE=bF[bC];if(bE==="*"){bE=bz}else{if(bz!=="*"&&bz!==bE){bA=bz+" "+bE;bH=bI[bA]||bI["* "+bE];if(!bH){e=L;for(bx in bI){bD=bx.split(" ");if(bD[0]===bz||bD[0]==="*"){e=bI[bD[1]+" "+bE];if(e){bx=bI[bx];if(bx===true){bH=e}else{if(e===true){bH=bx}}break}}}}if(!(bH||e)){b.error("No conversion from "+bA.replace(" "," to "))}if(bH!==true){bB=bH?bH(bB):e(bx(bB))}}}}return bB}var aB=b.now(),u=/(\=)\?(&|$)|\?\?/i;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return b.expando+"_"+(aB++)}});b.ajaxPrefilter("json jsonp",function(bF,bC,bE){var bz=bF.contentType==="application/x-www-form-urlencoded"&&(typeof bF.data==="string");if(bF.dataTypes[0]==="jsonp"||bF.jsonp!==false&&(u.test(bF.url)||bz&&u.test(bF.data))){var bD,by=bF.jsonpCallback=b.isFunction(bF.jsonpCallback)?bF.jsonpCallback():bF.jsonpCallback,bB=bc[by],e=bF.url,bA=bF.data,bx="$1"+by+"$2";if(bF.jsonp!==false){e=e.replace(u,bx);if(bF.url===e){if(bz){bA=bA.replace(u,bx)}if(bF.data===bA){e+=(/\?/.test(e)?"&":"?")+bF.jsonp+"="+by}}}bF.url=e;bF.data=bA;bc[by]=function(bG){bD=[bG]};bE.always(function(){bc[by]=bB;if(bD&&b.isFunction(bB)){bc[by](bD[0])}});bF.converters["script json"]=function(){if(!bD){b.error(by+" was not called")}return bD[0]};bF.dataTypes[0]="json";return"script"}});b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){b.globalEval(e);return e}}});b.ajaxPrefilter("script",function(e){if(e.cache===L){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});b.ajaxTransport("script",function(by){if(by.crossDomain){var e,bx=au.head||au.getElementsByTagName("head")[0]||au.documentElement;return{send:function(bz,bA){e=au.createElement("script");e.async="async";if(by.scriptCharset){e.charset=by.scriptCharset}e.src=by.url;e.onload=e.onreadystatechange=function(bC,bB){if(bB||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;if(bx&&e.parentNode){bx.removeChild(e)}e=L;if(!bB){bA(200,"success")}}};bx.insertBefore(e,bx.firstChild)},abort:function(){if(e){e.onload(0,1)}}}}});var B=bc.ActiveXObject?function(){for(var e in N){N[e](0,1)}}:false,y=0,N;function aL(){try{return new bc.XMLHttpRequest()}catch(bx){}}function aj(){try{return new bc.ActiveXObject("Microsoft.XMLHTTP")}catch(bx){}}b.ajaxSettings.xhr=bc.ActiveXObject?function(){return !this.isLocal&&aL()||aj()}:aL;(function(e){b.extend(b.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})})(b.ajaxSettings.xhr());if(b.support.ajax){b.ajaxTransport(function(e){if(!e.crossDomain||b.support.cors){var bx;return{send:function(bD,by){var bC=e.xhr(),bB,bA;if(e.username){bC.open(e.type,e.url,e.async,e.username,e.password)}else{bC.open(e.type,e.url,e.async)}if(e.xhrFields){for(bA in e.xhrFields){bC[bA]=e.xhrFields[bA]}}if(e.mimeType&&bC.overrideMimeType){bC.overrideMimeType(e.mimeType)}if(!e.crossDomain&&!bD["X-Requested-With"]){bD["X-Requested-With"]="XMLHttpRequest"}try{for(bA in bD){bC.setRequestHeader(bA,bD[bA])}}catch(bz){}bC.send((e.hasContent&&e.data)||null);bx=function(bM,bG){var bH,bF,bE,bK,bJ;try{if(bx&&(bG||bC.readyState===4)){bx=L;if(bB){bC.onreadystatechange=b.noop;if(B){delete N[bB]}}if(bG){if(bC.readyState!==4){bC.abort()}}else{bH=bC.status;bE=bC.getAllResponseHeaders();bK={};bJ=bC.responseXML;if(bJ&&bJ.documentElement){bK.xml=bJ}bK.text=bC.responseText;try{bF=bC.statusText}catch(bL){bF=""}if(!bH&&e.isLocal&&!e.crossDomain){bH=bK.text?200:404}else{if(bH===1223){bH=204}}}}}catch(bI){if(!bG){by(-1,bI)}}if(bK){by(bH,bF,bK,bE)}};if(!e.async||bC.readyState===4){bx()}else{bB=++y;if(B){if(!N){N={};b(bc).unload(B)}N[bB]=bx}bC.onreadystatechange=bx}},abort:function(){if(bx){bx(0,1)}}}}})}var R={},a9,m,aA=/^(?:toggle|show|hide)$/,aT=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,a4,aH=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],a5;b.fn.extend({show:function(bz,bC,bB){var by,bA;if(bz||bz===0){return this.animate(a1("show",3),bz,bC,bB)}else{for(var bx=0,e=this.length;bx<e;bx++){by=this[bx];if(by.style){bA=by.style.display;if(!b._data(by,"olddisplay")&&bA==="none"){bA=by.style.display=""}if(bA===""&&b.css(by,"display")==="none"){b._data(by,"olddisplay",x(by.nodeName))}}}for(bx=0;bx<e;bx++){by=this[bx];if(by.style){bA=by.style.display;if(bA===""||bA==="none"){by.style.display=b._data(by,"olddisplay")||""}}}return this}},hide:function(bz,bC,bB){if(bz||bz===0){return this.animate(a1("hide",3),bz,bC,bB)}else{var by,bA,bx=0,e=this.length;for(;bx<e;bx++){by=this[bx];if(by.style){bA=b.css(by,"display");if(bA!=="none"&&!b._data(by,"olddisplay")){b._data(by,"olddisplay",bA)}}}for(bx=0;bx<e;bx++){if(this[bx].style){this[bx].style.display="none"}}return this}},_toggle:b.fn.toggle,toggle:function(by,bx,bz){var e=typeof by==="boolean";if(b.isFunction(by)&&b.isFunction(bx)){this._toggle.apply(this,arguments)}else{if(by==null||e){this.each(function(){var bA=e?by:b(this).is(":hidden");b(this)[bA?"show":"hide"]()})}else{this.animate(a1("toggle",3),by,bx,bz)}}return this},fadeTo:function(e,bz,by,bx){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:bz},e,by,bx)},animate:function(bB,by,bA,bz){var e=b.speed(by,bA,bz);if(b.isEmptyObject(bB)){return this.each(e.complete,[false])}bB=b.extend({},bB);function bx(){if(e.queue===false){b._mark(this)}var bG=b.extend({},e),bM=this.nodeType===1,bK=bM&&b(this).is(":hidden"),bD,bH,bF,bL,bJ,bE,bI,bN,bC;bG.animatedProperties={};for(bF in bB){bD=b.camelCase(bF);if(bF!==bD){bB[bD]=bB[bF];delete bB[bF]}bH=bB[bD];if(b.isArray(bH)){bG.animatedProperties[bD]=bH[1];bH=bB[bD]=bH[0]}else{bG.animatedProperties[bD]=bG.specialEasing&&bG.specialEasing[bD]||bG.easing||"swing"}if(bH==="hide"&&bK||bH==="show"&&!bK){return bG.complete.call(this)}if(bM&&(bD==="height"||bD==="width")){bG.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(b.css(this,"display")==="inline"&&b.css(this,"float")==="none"){if(!b.support.inlineBlockNeedsLayout||x(this.nodeName)==="inline"){this.style.display="inline-block"}else{this.style.zoom=1}}}}if(bG.overflow!=null){this.style.overflow="hidden"}for(bF in bB){bL=new b.fx(this,bG,bF);bH=bB[bF];if(aA.test(bH)){bC=b._data(this,"toggle"+bF)||(bH==="toggle"?bK?"show":"hide":0);if(bC){b._data(this,"toggle"+bF,bC==="show"?"hide":"show");bL[bC]()}else{bL[bH]()}}else{bJ=aT.exec(bH);bE=bL.cur();if(bJ){bI=parseFloat(bJ[2]);bN=bJ[3]||(b.cssNumber[bF]?"":"px");if(bN!=="px"){b.style(this,bF,(bI||1)+bN);bE=((bI||1)/bL.cur())*bE;b.style(this,bF,bE+bN)}if(bJ[1]){bI=((bJ[1]==="-="?-1:1)*bI)+bE}bL.custom(bE,bI,bN)}else{bL.custom(bE,bH,"")}}}return true}return e.queue===false?this.each(bx):this.queue(e.queue,bx)},stop:function(by,bx,e){if(typeof by!=="string"){e=bx;bx=by;by=L}if(bx&&by!==false){this.queue(by||"fx",[])}return this.each(function(){var bA,bz=false,bC=b.timers,bB=b._data(this);if(!e){b._unmark(true,this)}function bD(bG,bH,bF){var bE=bH[bF];b.removeData(bG,bF,true);bE.stop(e)}if(by==null){for(bA in bB){if(bB[bA].stop&&bA.indexOf(".run")===bA.length-4){bD(this,bB,bA)}}}else{if(bB[bA=by+".run"]&&bB[bA].stop){bD(this,bB,bA)}}for(bA=bC.length;bA--;){if(bC[bA].elem===this&&(by==null||bC[bA].queue===by)){if(e){bC[bA](true)}else{bC[bA].saveState()}bz=true;bC.splice(bA,1)}}if(!(e&&bz)){b.dequeue(this,by)}})}});function bi(){setTimeout(ar,0);return(a5=b.now())}function ar(){a5=L}function a1(bx,e){var by={};b.each(aH.concat.apply([],aH.slice(0,e)),function(){by[this]=bx});return by}b.each({slideDown:a1("show",1),slideUp:a1("hide",1),slideToggle:a1("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,bx){b.fn[e]=function(by,bA,bz){return this.animate(bx,by,bA,bz)}});b.extend({speed:function(by,bz,bx){var e=by&&typeof by==="object"?b.extend({},by):{complete:bx||!bx&&bz||b.isFunction(by)&&by,duration:by,easing:bx&&bz||bz&&!b.isFunction(bz)&&bz};e.duration=b.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in b.fx.speeds?b.fx.speeds[e.duration]:b.fx.speeds._default;if(e.queue==null||e.queue===true){e.queue="fx"}e.old=e.complete;e.complete=function(bA){if(b.isFunction(e.old)){e.old.call(this)}if(e.queue){b.dequeue(this,e.queue)}else{if(bA!==false){b._unmark(this)}}};return e},easing:{linear:function(by,bz,e,bx){return e+bx*by},swing:function(by,bz,e,bx){return((-Math.cos(by*Math.PI)/2)+0.5)*bx+e}},timers:[],fx:function(bx,e,by){this.options=e;this.elem=bx;this.prop=by;e.orig=e.orig||{}}});b.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(b.fx.step[this.prop]||b.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var e,bx=b.css(this.elem,this.prop);return isNaN(e=parseFloat(bx))?!bx||bx==="auto"?0:bx:e},custom:function(bB,bA,bz){var e=this,by=b.fx;this.startTime=a5||bi();this.end=bA;this.now=this.start=bB;this.pos=this.state=0;this.unit=bz||this.unit||(b.cssNumber[this.prop]?"":"px");function bx(bC){return e.step(bC)}bx.queue=this.options.queue;bx.elem=this.elem;bx.saveState=function(){if(e.options.hide&&b._data(e.elem,"fxshow"+e.prop)===L){b._data(e.elem,"fxshow"+e.prop,e.start)}};if(bx()&&b.timers.push(bx)&&!a4){a4=setInterval(by.tick,by.interval)}},show:function(){var e=b._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=e||b.style(this.elem,this.prop);this.options.show=true;if(e!==L){this.custom(this.cur(),e)}else{this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur())}b(this.elem).show()},hide:function(){this.options.orig[this.prop]=b._data(this.elem,"fxshow"+this.prop)||b.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(bA){var bC,bD,bx,bz=a5||bi(),e=true,bB=this.elem,by=this.options;if(bA||bz>=by.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();by.animatedProperties[this.prop]=true;for(bC in by.animatedProperties){if(by.animatedProperties[bC]!==true){e=false}}if(e){if(by.overflow!=null&&!b.support.shrinkWrapBlocks){b.each(["","X","Y"],function(bE,bF){bB.style["overflow"+bF]=by.overflow[bE]})}if(by.hide){b(bB).hide()}if(by.hide||by.show){for(bC in by.animatedProperties){b.style(bB,bC,by.orig[bC]);b.removeData(bB,"fxshow"+bC,true);b.removeData(bB,"toggle"+bC,true)}}bx=by.complete;if(bx){by.complete=false;bx.call(bB)}}return false}else{if(by.duration==Infinity){this.now=bz}else{bD=bz-this.startTime;this.state=bD/by.duration;this.pos=b.easing[by.animatedProperties[this.prop]](this.state,bD,0,1,by.duration);this.now=this.start+((this.end-this.start)*this.pos)}this.update()}return true}};b.extend(b.fx,{tick:function(){var by,bx=b.timers,e=0;for(;e<bx.length;e++){by=bx[e];if(!by()&&bx[e]===by){bx.splice(e--,1)}}if(!bx.length){b.fx.stop()}},interval:13,stop:function(){clearInterval(a4);a4=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(e){b.style(e.elem,"opacity",e.now)},_default:function(e){if(e.elem.style&&e.elem.style[e.prop]!=null){e.elem.style[e.prop]=e.now+e.unit}else{e.elem[e.prop]=e.now}}}});b.each(["width","height"],function(e,bx){b.fx.step[bx]=function(by){b.style(by.elem,bx,Math.max(0,by.now))}});if(b.expr&&b.expr.filters){b.expr.filters.animated=function(e){return b.grep(b.timers,function(bx){return e===bx.elem}).length}}function x(bz){if(!R[bz]){var e=au.body,bx=b("<"+bz+">").appendTo(e),by=bx.css("display");bx.remove();if(by==="none"||by===""){if(!a9){a9=au.createElement("iframe");a9.frameBorder=a9.width=a9.height=0}e.appendChild(a9);if(!m||!a9.createElement){m=(a9.contentWindow||a9.contentDocument).document;m.write((au.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");m.close()}bx=m.createElement(bz);m.body.appendChild(bx);by=b.css(bx,"display");e.removeChild(a9)}R[bz]=by}return R[bz]}var V=/^t(?:able|d|h)$/i,ad=/^(?:body|html)$/i;if("getBoundingClientRect" in au.documentElement){b.fn.offset=function(bK){var bA=this[0],bD;if(bK){return this.each(function(e){b.offset.setOffset(this,bK,e)})}if(!bA||!bA.ownerDocument){return null}if(bA===bA.ownerDocument.body){return b.offset.bodyOffset(bA)}try{bD=bA.getBoundingClientRect()}catch(bH){}var bJ=bA.ownerDocument,by=bJ.documentElement;if(!bD||!b.contains(by,bA)){return bD?{top:bD.top,left:bD.left}:{top:0,left:0}}var bE=bJ.body,bF=aK(bJ),bC=by.clientTop||bE.clientTop||0,bG=by.clientLeft||bE.clientLeft||0,bx=bF.pageYOffset||b.support.boxModel&&by.scrollTop||bE.scrollTop,bB=bF.pageXOffset||b.support.boxModel&&by.scrollLeft||bE.scrollLeft,bI=bD.top+bx-bC,bz=bD.left+bB-bG;return{top:bI,left:bz}}}else{b.fn.offset=function(bH){var bB=this[0];if(bH){return this.each(function(bI){b.offset.setOffset(this,bH,bI)})}if(!bB||!bB.ownerDocument){return null}if(bB===bB.ownerDocument.body){return b.offset.bodyOffset(bB)}var bE,by=bB.offsetParent,bx=bB,bG=bB.ownerDocument,bz=bG.documentElement,bC=bG.body,bD=bG.defaultView,e=bD?bD.getComputedStyle(bB,null):bB.currentStyle,bF=bB.offsetTop,bA=bB.offsetLeft;while((bB=bB.parentNode)&&bB!==bC&&bB!==bz){if(b.support.fixedPosition&&e.position==="fixed"){break}bE=bD?bD.getComputedStyle(bB,null):bB.currentStyle;bF-=bB.scrollTop;bA-=bB.scrollLeft;if(bB===by){bF+=bB.offsetTop;bA+=bB.offsetLeft;if(b.support.doesNotAddBorder&&!(b.support.doesAddBorderForTableAndCells&&V.test(bB.nodeName))){bF+=parseFloat(bE.borderTopWidth)||0;bA+=parseFloat(bE.borderLeftWidth)||0}bx=by;by=bB.offsetParent}if(b.support.subtractsBorderForOverflowNotVisible&&bE.overflow!=="visible"){bF+=parseFloat(bE.borderTopWidth)||0;bA+=parseFloat(bE.borderLeftWidth)||0}e=bE}if(e.position==="relative"||e.position==="static"){bF+=bC.offsetTop;bA+=bC.offsetLeft}if(b.support.fixedPosition&&e.position==="fixed"){bF+=Math.max(bz.scrollTop,bC.scrollTop);bA+=Math.max(bz.scrollLeft,bC.scrollLeft)}return{top:bF,left:bA}}}b.offset={bodyOffset:function(e){var by=e.offsetTop,bx=e.offsetLeft;if(b.support.doesNotIncludeMarginInBodyOffset){by+=parseFloat(b.css(e,"marginTop"))||0;bx+=parseFloat(b.css(e,"marginLeft"))||0}return{top:by,left:bx}},setOffset:function(bz,bI,bC){var bD=b.css(bz,"position");if(bD==="static"){bz.style.position="relative"}var bB=b(bz),bx=bB.offset(),e=b.css(bz,"top"),bG=b.css(bz,"left"),bH=(bD==="absolute"||bD==="fixed")&&b.inArray("auto",[e,bG])>-1,bF={},bE={},by,bA;if(bH){bE=bB.position();by=bE.top;bA=bE.left}else{by=parseFloat(e)||0;bA=parseFloat(bG)||0}if(b.isFunction(bI)){bI=bI.call(bz,bC,bx)}if(bI.top!=null){bF.top=(bI.top-bx.top)+by}if(bI.left!=null){bF.left=(bI.left-bx.left)+bA}if("using" in bI){bI.using.call(bz,bF)}else{bB.css(bF)}}};b.fn.extend({position:function(){if(!this[0]){return null}var by=this[0],bx=this.offsetParent(),bz=this.offset(),e=ad.test(bx[0].nodeName)?{top:0,left:0}:bx.offset();bz.top-=parseFloat(b.css(by,"marginTop"))||0;bz.left-=parseFloat(b.css(by,"marginLeft"))||0;e.top+=parseFloat(b.css(bx[0],"borderTopWidth"))||0;e.left+=parseFloat(b.css(bx[0],"borderLeftWidth"))||0;return{top:bz.top-e.top,left:bz.left-e.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||au.body;while(e&&(!ad.test(e.nodeName)&&b.css(e,"position")==="static")){e=e.offsetParent}return e})}});b.each(["Left","Top"],function(bx,e){var by="scroll"+e;b.fn[by]=function(bB){var bz,bA;if(bB===L){bz=this[0];if(!bz){return null}bA=aK(bz);return bA?("pageXOffset" in bA)?bA[bx?"pageYOffset":"pageXOffset"]:b.support.boxModel&&bA.document.documentElement[by]||bA.document.body[by]:bz[by]}return this.each(function(){bA=aK(this);if(bA){bA.scrollTo(!bx?bB:b(bA).scrollLeft(),bx?bB:b(bA).scrollTop())}else{this[by]=bB}})}});function aK(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}b.each(["Height","Width"],function(bx,e){var by=e.toLowerCase();b.fn["inner"+e]=function(){var bz=this[0];return bz?bz.style?parseFloat(b.css(bz,by,"padding")):this[by]():null};b.fn["outer"+e]=function(bA){var bz=this[0];return bz?bz.style?parseFloat(b.css(bz,by,bA?"margin":"border")):this[by]():null};b.fn[by]=function(bB){var bC=this[0];if(!bC){return bB==null?null:this}if(b.isFunction(bB)){return this.each(function(bG){var bF=b(this);bF[by](bB.call(this,bG,bF[by]()))})}if(b.isWindow(bC)){var bD=bC.document.documentElement["client"+e],bz=bC.document.body;return bC.document.compatMode==="CSS1Compat"&&bD||bz&&bz["client"+e]||bD}else{if(bC.nodeType===9){return Math.max(bC.documentElement["client"+e],bC.body["scroll"+e],bC.documentElement["scroll"+e],bC.body["offset"+e],bC.documentElement["offset"+e])}else{if(bB===L){var bE=b.css(bC,by),bA=parseFloat(bE);return b.isNumeric(bA)?bA:bE}else{return this.css(by,typeof bB==="string"?bB:bB+"px")}}}}});bc.jQuery=bc.$=b})(window);var saveDatas=[];var saveDataMenuButtons=[];function SaveData(c,b,a){this.levelIndex=c;this.upgrades=b;this.points=a}function resetSaveDataButtons(){saveDataMenuButtons.length=0}function resetSaveData(){saveDataMenuButtons.length=0;saveDatas.length=0}function getSaveDatasString(){var a="";for(var b=0;b<saveDatas.length;b++){var c=saveDatas[b];a+=c.levelIndex+":"+c.upgrades+":"+c.points+";"}return a}function getSaveDatasFromString(d){var c=[];try{var g=d.split(";");for(var f=0;f<g.length;f++){var b=g[f].split(":");if(b.length==3){var a=new SaveData(Number(b[0]),Number(b[1]),Number(b[2]));c.push(a)}}}catch(h){logit("error in getSaveDataFromString(): "+h+"\n")}return c}function loadDataUsingLocalStorage(){if(typeof(localStorage)=="undefined"){logit("Local storage not found\n")}else{try{var b=localStorage.getItem("data");if(b!=null){var a=getSaveDatasFromString(b);if(a.length>0){saveDatas=a}}}catch(c){logit("Error when using localStorage.getItem(): "+c+"\n")}}}function saveDataUsingLocalStorage(){if(typeof(localStorage)=="undefined"){}else{try{var a=getSaveDatasString();localStorage.setItem("data",a)}catch(b){logit("Error when using localStorage.setItem(): "+b+"\n")}}}function addSaveData(c){var f=[];var g=[];for(var d=0;d<saveDatas.length;d++){var a=saveDatas[d];if(a.levelIndex==c.levelIndex){g.push(a)}else{f.push(a)}}if(g.length==0){f.push(c)}else{if(g.length==1){var j=g[0].upgrades<c.upgrades;var b=g[0].upgrades==c.upgrades;var h=g[0].points<c.points;if(j||(b&&h)){f.push(c)}else{f.push(g[0])}}else{logit("Error in addSaveData(). Found more than one data for index "+c.levelIndex+"\n")}}saveDatas=f;saveDataUsingLocalStorage();var e=getSaveDatasString()}function createsaveDataMenuButtons(){var g=150;var a=(canvas.width-g)*0.5;var h=100;var e=new TextButton(a,h,g,30,"START NEW GAME");e.handler=function(){switchingState=true;stateCounter=0;endStateCounter=30;changeLevel(0);player.hardReset();targetState=SHOWING_INTRO};saveDataMenuButtons.push(e);var d=250;var a=(canvas.width-d)*0.5;h+=20;for(var c=0;c<saveDatas.length;c++){h+=35;var f=saveDatas[c];var b=new TextButton(a,h,d,30,"PLAY LEVEL "+(f.levelIndex+1)+" WITH "+f.upgrades+" UPGRADES");b.handler=createSetLevelHandler(f);saveDataMenuButtons.push(b)}}function createSetLevelHandler(a){return function(){stateCounter=0;endStateCounter=2;switchingState=true;player.hardReset();player.securedUpgrades=a.upgrades;player.securedPoints=a.points;player.softReset();currentLevel=a.levelIndex-1;changeLevel(currentLevel);targetState=SHOWING_LEVEL_COMPLETE}}function stepSaveDataMenu(){updateScrollingBackgroundCamera();if(switchingState&&targetState!=-1){if(transitionToState(targetState)){stateCounter=levelCompleteAnimationSteps-1;resetSaveDataButtons();if(upgradeComponent!=null){upgradeComponent.reset()}}return}else{stateCounter++}if(saveDataMenuButtons.length==0){createsaveDataMenuButtons()}for(var b=0;b<saveDataMenuButtons.length;b++){var a=saveDataMenuButtons[b];a.step()}}function paintSaveDataMenu(){paintScrollingBackground(0);for(var b=0;b<saveDataMenuButtons.length;b++){var a=saveDataMenuButtons[b];a.paint()}}(function(c){var b=null;function a(aE,R){this.flashVersion=8;this.debugMode=true;this.debugFlash=false;this.useConsole=true;this.consoleOnly=false;this.waitForWindowLoad=false;this.nullURL="about:blank";this.allowPolling=true;this.useFastPolling=false;this.useMovieStar=true;this.bgColor="#ffffff";this.useHighPerformance=false;this.flashPollingInterval=null;this.flashLoadTimeout=1000;this.wmode=null;this.allowScriptAccess="always";this.useFlashBlock=false;this.useHTML5Audio=true;this.html5Test=/^(probably|maybe)$/i;this.preferFlash=true;this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:true},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:false},ogg:{type:["audio/ogg; codecs=vorbis"],required:false},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:false}};this.defaultOptions={autoLoad:false,stream:true,autoPlay:false,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onstop:null,onfailure:null,onfinish:null,onbeforefinish:null,onbeforefinishtime:5000,onbeforefinishcomplete:null,onjustbeforefinish:null,onjustbeforefinishtime:200,multiShot:true,multiShotEvents:false,position:null,pan:0,type:null,usePolicyFile:false,volume:100};this.flash9Options={isMovieStar:null,usePeakData:false,useWaveformData:false,useEQData:false,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.version=null;this.versionNumber="V2.97a.20110801";this.movieURL=null;this.url=(aE||null);this.altURL=null;this.swfLoaded=false;this.enabled=false;this.o=null;this.movieID="sm2-container";this.id=(R||"sm2movie");this.swfCSS={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"};this.oMC=null;this.sounds={};this.soundIDs=[];this.muted=false;this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.specialWmodeCase=false;this.didFlashBlock=false;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.baseMimeTypes=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.netStreamMimeTypes=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.netStreamTypes=["aac","flv","mov","mp4","m4v","f4v","m4a","mp4v","3gp","3g2"];this.netStreamPattern=new RegExp("\\.("+this.netStreamTypes.join("|")+")(\\?.*)?$","i");this.mimePattern=this.baseMimeTypes;this.features={buffering:false,peakData:false,waveformData:false,eqData:false,movieStar:false};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null};this.hasHTML5=(typeof Audio!=="undefined"&&typeof new Audio().canPlayType!=="undefined");this.html5={usingFlash:null};this.flash={};this.html5Only=false;this.ignoreFlash=false;var U,aS=this,aB="soundManager",aq=aB+"::",aH="HTML5::",Y,ac=navigator.userAgent,k=c,l=k.location.href.toString(),e=this.flashVersion,aF=document,ae,ax,al=[],m=true,ah,av=false,aM=false,aK=false,I=false,v=false,B,aI=0,V,ak,aN,aR,ar,aj,u,M,aD,N,s,aO,az,ap,aJ,aC,am,H,X=["log","info","warn","error"],Q=8,W,ao,h,o=null,at=null,Z,i,L,y,ab,x,d,af,aT=false,F=false,A,q,w,S,ai=null,ag,D,aw,p,T,aQ,r,j=Array.prototype.slice,aL=false,g,aP,aa,t,C,G=ac.match(/(ipad|iphone|ipod)/i),z=(ac.match(/(mobile|pre\/|xoom)/i)||G),f=ac.match(/msie/i),n=ac.match(/webkit/i),E=(ac.match(/safari/i)&&!ac.match(/chrome/i)),K=(ac.match(/opera/i)),an=(!l.match(/usehtml5audio/i)&&!l.match(/sm2\-ignorebadua/i)&&E&&ac.match(/OS X 10_6_([3-7])/i)),aA=(typeof console!=="undefined"&&typeof console.log!=="undefined"),aG=(typeof aF.hasFocus!=="undefined"?aF.hasFocus():null),ad=(E&&typeof aF.hasFocus==="undefined"),J=!ad,P=/(mp3|mp4|mpa)/i,au=(aF.location?aF.location.protocol.match(/http/i):null),ay=(!au?"http:":"");this.useAltURL=!au;this._global_a=null;if(z){aS.useHTML5Audio=true;aS.preferFlash=false;if(G){aS.ignoreFlash=true;aL=true}}this.ok=function(){return(ai?(aK&&!I):(aS.useHTML5Audio&&aS.hasHTML5))};this.supported=this.ok;this.getMovie=function(aU){return f?k[aU]:(E?Y(aU)||aF[aU]:Y(aU))};this.createSound=function(aW){var aZ=aB+".createSound(): ",aY=null,aX=null,aV=null;if(!aK||!aS.ok()){d(aZ+Z(!aK?"notReady":"notOK"));return false}if(arguments.length===2){aW={id:arguments[0],url:arguments[1]}}aY=ak(aW);aV=aY;if(aV.id.toString().charAt(0).match(/^[0-9]$/)){aS._wD(aZ+Z("badID",aV.id),2)}aS._wD(aZ+aV.id+" ("+aV.url+")",1);if(af(aV.id,true)){aS._wD(aZ+aV.id+" exists",1);return aS.sounds[aV.id]}function aU(){aY=ab(aY);aS.sounds[aV.id]=new U(aV);aS.soundIDs.push(aV.id);return aS.sounds[aV.id]}if(D(aV)){aX=aU();aS._wD("Loading sound "+aV.id+" via HTML5");aX._setup_html5(aV)}else{if(e>8&&aS.useMovieStar){if(aV.isMovieStar===null){aV.isMovieStar=((aV.serverURL||(aV.type?aV.type.match(aS.netStreamPattern):false)||aV.url.match(aS.netStreamPattern))?true:false)}if(aV.isMovieStar){aS._wD(aZ+"using MovieStar handling")}if(aV.isMovieStar){if(aV.usePeakData){B("noPeak");aV.usePeakData=false}if(aV.loops>1){B("noNSLoop")}}}aV=x(aV,aZ);aX=aU();if(e===8){aS.o._createSound(aV.id,aV.onjustbeforefinishtime,aV.loops||1,aV.usePolicyFile)}else{aS.o._createSound(aV.id,aV.url,aV.onjustbeforefinishtime,aV.usePeakData,aV.useWaveformData,aV.useEQData,aV.isMovieStar,(aV.isMovieStar?aV.bufferTime:false),aV.loops||1,aV.serverURL,aV.duration||null,aV.autoPlay,true,aV.autoLoad,aV.usePolicyFile);if(!aV.serverURL){aX.connected=true;if(aV.onconnect){aV.onconnect.apply(aX)}}}if(!aV.serverURL&&(aV.autoLoad||aV.autoPlay)){aX.load(aV)}}if(!aV.serverURL&&aV.autoPlay){aX.play()}return aX};this.destroySound=function(aU,aX){if(!af(aU)){return false}var aW=aS.sounds[aU],aV;aW._iO={};aW.stop();aW.unload();for(aV=0;aV<aS.soundIDs.length;aV++){if(aS.soundIDs[aV]===aU){aS.soundIDs.splice(aV,1);break}}if(!aX){aW.destruct(true)}aW=null;delete aS.sounds[aU];return true};this.load=function(aU,aV){if(!af(aU)){return false}return aS.sounds[aU].load(aV)};this.unload=function(aU){if(!af(aU)){return false}return aS.sounds[aU].unload()};this.play=function(aU,aV){var aW=aB+".play(): ";if(!aK||!aS.ok()){d(aW+Z(!aK?"notReady":"notOK"));return false}if(!af(aU)){if(!(aV instanceof Object)){aV={url:aV}}if(aV&&aV.url){aS._wD(aW+'attempting to create "'+aU+'"',1);aV.id=aU;return aS.createSound(aV).play()}else{return false}}return aS.sounds[aU].play(aV)};this.start=this.play;this.setPosition=function(aU,aV){if(!af(aU)){return false}return aS.sounds[aU].setPosition(aV)};this.stop=function(aU){if(!af(aU)){return false}aS._wD(aB+".stop("+aU+")",1);return aS.sounds[aU].stop()};this.stopAll=function(){var aU;aS._wD(aB+".stopAll()",1);for(aU in aS.sounds){if(aS.sounds.hasOwnProperty(aU)){aS.sounds[aU].stop()}}};this.pause=function(aU){if(!af(aU)){return false}return aS.sounds[aU].pause()};this.pauseAll=function(){var aU;for(aU=aS.soundIDs.length;aU--;){aS.sounds[aS.soundIDs[aU]].pause()}};this.resume=function(aU){if(!af(aU)){return false}return aS.sounds[aU].resume()};this.resumeAll=function(){var aU;for(aU=aS.soundIDs.length;aU--;){aS.sounds[aS.soundIDs[aU]].resume()}};this.togglePause=function(aU){if(!af(aU)){return false}return aS.sounds[aU].togglePause()};this.setPan=function(aU,aV){if(!af(aU)){return false}return aS.sounds[aU].setPan(aV)};this.setVolume=function(aV,aU){if(!af(aV)){return false}return aS.sounds[aV].setVolume(aU)};this.mute=function(aU){var aW=aB+".mute(): ",aV=0;if(typeof aU!=="string"){aU=null}if(!aU){aS._wD(aW+"Muting all sounds");for(aV=aS.soundIDs.length;aV--;){aS.sounds[aS.soundIDs[aV]].mute()}aS.muted=true}else{if(!af(aU)){return false}aS._wD(aW+'Muting "'+aU+'"');return aS.sounds[aU].mute()}return true};this.muteAll=function(){aS.mute()};this.unmute=function(aU){var aW=aB+".unmute(): ",aV;if(typeof aU!=="string"){aU=null}if(!aU){aS._wD(aW+"Unmuting all sounds");for(aV=aS.soundIDs.length;aV--;){aS.sounds[aS.soundIDs[aV]].unmute()}aS.muted=false}else{if(!af(aU)){return false}aS._wD(aW+'Unmuting "'+aU+'"');return aS.sounds[aU].unmute()}return true};this.unmuteAll=function(){aS.unmute()};this.toggleMute=function(aU){if(!af(aU)){return false}return aS.sounds[aU].toggleMute()};this.getMemoryUse=function(){var aU=0;if(aS.o&&e!==8){aU=parseInt(aS.o._getMemoryUse(),10)}return aU};this.disable=function(aV){var aU;if(typeof aV==="undefined"){aV=false}if(I){return false}I=true;B("shutdown",1);for(aU=aS.soundIDs.length;aU--;){W(aS.sounds[aS.soundIDs[aU]])}V(aV);r.remove(k,"load",ar);return true};this.canPlayMIME=function(aV){var aU;if(aS.hasHTML5){aU=aw({type:aV})}if(!ai||aU){return aU}else{return(aV?(aV.match(aS.mimePattern)?true:false):null)}};this.canPlayURL=function(aV){var aU;if(aS.hasHTML5){aU=aw({url:aV})}if(!ai||aU){return aU}else{return(aV?(aV.match(aS.filePattern)?true:false):null)}};this.canPlayLink=function(aU){if(typeof aU.type!=="undefined"&&aU.type){if(aS.canPlayMIME(aU.type)){return true}}return aS.canPlayURL(aU.href)};this.getSoundById=function(aV,aW){if(!aV){throw new Error(aB+".getSoundById(): sID is null/undefined")}var aU=aS.sounds[aV];if(!aU&&!aW){aS._wD('"'+aV+'" is an invalid sound ID.',2)}return aU};this.onready=function(aV,aU){var aW="onready";if(aV&&aV instanceof Function){if(aK){aS._wD(Z("queue",aW))}if(!aU){aU=k}aN(aW,aV,aU);aR();return true}else{throw Z("needFunction",aW)}};this.ontimeout=function(aV,aU){var aW="ontimeout";if(aV&&aV instanceof Function){if(aK){aS._wD(Z("queue",aW))}if(!aU){aU=k}aN(aW,aV,aU);aR({type:aW});return true}else{throw Z("needFunction",aW)}};this._writeDebug=function(aV,a1,aX){var a0="soundmanager-debug",aZ,aY,aU;if(!aS.debugMode){return false}if(typeof aX!=="undefined"&&aX){aV=aV+" | "+new Date().getTime()}if(aA&&aS.useConsole){aU=X[a1];if(typeof console[aU]!=="undefined"){console[aU](aV)}else{console.log(aV)}if(aS.useConsoleOnly){return true}}try{aZ=Y(a0);if(!aZ){return false}aY=aF.createElement("div");if(++aI%2===0){aY.className="sm2-alt"}if(typeof a1==="undefined"){a1=0}else{a1=parseInt(a1,10)}aY.appendChild(aF.createTextNode(aV));if(a1){if(a1>=2){aY.style.fontWeight="bold"}if(a1===3){aY.style.color="#ff3333"}}aZ.insertBefore(aY,aZ.firstChild)}catch(aW){}aZ=null;return true};this._wD=this._writeDebug;this._debug=function(){var aV,aU;B("currentObj",1);for(aV=0,aU=aS.soundIDs.length;aV<aU;aV++){aS.sounds[aS.soundIDs[aV]]._debug()}};this.reboot=function(){aS._wD(aB+".reboot()");if(aS.soundIDs.length){aS._wD("Destroying "+aS.soundIDs.length+" SMSound objects...")}var aV,aU;for(aV=aS.soundIDs.length;aV--;){aS.sounds[aS.soundIDs[aV]].destruct()}try{if(f){at=aS.o.innerHTML}o=aS.o.parentNode.removeChild(aS.o);aS._wD("Flash movie removed.")}catch(aW){B("badRemove",2)}at=o=ai=null;aS.enabled=az=aK=aT=F=av=aM=I=aS.swfLoaded=false;aS.soundIDs=aS.sounds=[];aS.o=null;for(aV in al){if(al.hasOwnProperty(aV)){for(aU=al[aV].length;aU--;){al[aV][aU].fired=false}}}aS._wD(aB+": Rebooting...");k.setTimeout(aS.beginDelayedInit,20)};this.getMoviePercent=function(){return(aS.o&&typeof aS.o.PercentLoaded!=="undefined"?aS.o.PercentLoaded():null)};this.beginDelayedInit=function(){v=true;aO();setTimeout(function(){if(F){return false}aJ();s();F=true;return true},20);aj()};this.destruct=function(){aS._wD(aB+".destruct()");aS.disable(true)};function O(aU){return function(aV){if(!this._t||!this._t._a){if(this._t&&this._t.sID){aS._wD(aH+"ignoring "+aV.type+": "+this._t.sID)}else{aS._wD(aH+"ignoring "+aV.type)}return null}else{return aU.call(this,aV)}}}t={abort:O(function(aU){aS._wD(aH+"abort: "+this._t.sID)}),canplay:O(function(aW){if(this._t._html5_canplay){return true}this._t._html5_canplay=true;aS._wD(aH+"canplay: "+this._t.sID+", "+this._t.url);this._t._onbufferchange(0);var aV=(!isNaN(this._t.position)?this._t.position/1000:null);if(this._t.position&&this.currentTime!==aV){aS._wD(aH+"canplay: setting position to "+aV);try{this.currentTime=aV}catch(aU){aS._wD(aH+"setting position failed: "+aU.message,2)}}}),load:O(function(aU){if(!this._t.loaded){this._t._onbufferchange(0);this._t._whileloading(this._t.bytesTotal,this._t.bytesTotal,this._t._get_html5_duration());this._t._onload(true)}}),emptied:O(function(aU){aS._wD(aH+"emptied: "+this._t.sID)}),ended:O(function(aU){aS._wD(aH+"ended: "+this._t.sID);this._t._onfinish()}),error:O(function(aU){aS._wD(aH+"error: "+this.error.code);this._t._onload(false)}),loadeddata:O(function(aW){var aU=this._t,aV=aU.bytesTotal||1;aS._wD(aH+"loadeddata: "+this._t.sID);if(!aU._loaded&&!E){aU.duration=aU._get_html5_duration();aU._whileloading(aV,aV,aU._get_html5_duration());aU._onload(true)}}),loadedmetadata:O(function(aU){aS._wD(aH+"loadedmetadata: "+this._t.sID)}),loadstart:O(function(aU){aS._wD(aH+"loadstart: "+this._t.sID);this._t._onbufferchange(1)}),play:O(function(aU){aS._wD(aH+"play: "+this._t.sID+", "+this._t.url);this._t._onbufferchange(0)}),playing:O(function(aU){aS._wD(aH+"playing: "+this._t.sID+", "+this._t.url);this._t._onbufferchange(0)}),progress:O(function(aZ){if(this._t.loaded){return false}var aX,aW,a0,aV=0,a2=(aZ.type==="progress"),aU=aZ.target.buffered,aY=(aZ.loaded||0),a1=(aZ.total||1);if(aU&&aU.length){for(aX=aU.length;aX--;){aV=(aU.end(aX)-aU.start(aX))}aY=aV/aZ.target.duration;if(a2&&aU.length>1){a0=[];aW=aU.length;for(aX=0;aX<aW;aX++){a0.push(aZ.target.buffered.start(aX)+"-"+aZ.target.buffered.end(aX))}aS._wD(aH+"progress: timeRanges: "+a0.join(", "))}if(a2&&!isNaN(aY)){aS._wD(aH+"progress: "+this._t.sID+": "+Math.floor(aY*100)+"% loaded")}}if(!isNaN(aY)){this._t._onbufferchange(0);this._t._whileloading(aY,a1,this._t._get_html5_duration());if(aY&&a1&&aY===a1){t.load.call(this,aZ)}}}),ratechange:O(function(aU){aS._wD(aH+"ratechange: "+this._t.sID)}),suspend:O(function(aU){aS._wD(aH+"suspend: "+this._t.sID);t.progress.call(this,aU)}),stalled:O(function(aU){aS._wD(aH+"stalled: "+this._t.sID)}),timeupdate:O(function(aU){this._t._onTimer()}),waiting:O(function(aU){aS._wD(aH+"waiting: "+this._t.sID);this._t._onbufferchange(1)})};U=function(aV){var aX=this,aY,aW,aU;this.sID=aV.id;this.url=aV.url;this.options=ak(aV);this.instanceOptions=this.options;this._iO=this.instanceOptions;this.pan=this.options.pan;this.volume=this.options.volume;this._lastURL=null;this.isHTML5=false;this._a=null;this.id3={};this._debug=function(){if(aS.debugMode){var a1=null,a3=[],a0,a2,aZ=64;for(a1 in aX.options){if(aX.options[a1]!==null){if(aX.options[a1] instanceof Function){a0=aX.options[a1].toString();a0=a0.replace(/\s\s+/g," ");a2=a0.indexOf("{");a3.push(" "+a1+": {"+a0.substr(a2+1,(Math.min(Math.max(a0.indexOf("\n")-1,aZ),aZ))).replace(/\n/g,"")+"... }")}else{a3.push(" "+a1+": "+aX.options[a1])}}}aS._wD("SMSound() merged options: {\n"+a3.join(", \n")+"\n}")}};this._debug();this.load=function(aZ){var a0=null;if(typeof aZ!=="undefined"){aX._iO=ak(aZ,aX.options);aX.instanceOptions=aX._iO}else{aZ=aX.options;aX._iO=aZ;aX.instanceOptions=aX._iO;if(aX._lastURL&&aX._lastURL!==aX.url){B("manURL");aX._iO.url=aX.url;aX.url=null}}if(!aX._iO.url){aX._iO.url=aX.url}aS._wD("SMSound.load(): "+aX._iO.url,1);if(aX._iO.url===aX.url&&aX.readyState!==0&&aX.readyState!==2){B("onURL",1);return aX}aX._lastURL=aX.url;aX.loaded=false;aX.readyState=1;aX.playState=0;if(D(aX._iO)){a0=aX._setup_html5(aX._iO);if(!a0._called_load){aS._wD(aH+"load: "+aX.sID);aX._html5_canplay=false;a0.load();a0._called_load=true;if(aX._iO.autoPlay){aX.play()}}else{aS._wD(aH+"ignoring request to load again: "+aX.sID)}}else{try{aX.isHTML5=false;aX._iO=x(ab(aX._iO));if(e===8){aS.o._load(aX.sID,aX._iO.url,aX._iO.stream,aX._iO.autoPlay,(aX._iO.whileloading?1:0),aX._iO.loops||1,aX._iO.usePolicyFile)}else{aS.o._load(aX.sID,aX._iO.url,aX._iO.stream?true:false,aX._iO.autoPlay?true:false,aX._iO.loops||1,aX._iO.autoLoad?true:false,aX._iO.usePolicyFile)}}catch(a1){B("smError",2);ah("onload",false);aC({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:true})}}return aX};this.unload=function(){if(aX.readyState!==0){aS._wD('SMSound.unload(): "'+aX.sID+'"');if(!aX.isHTML5){if(e===8){aS.o._unload(aX.sID,aS.nullURL)}else{aS.o._unload(aX.sID)}}else{aW();if(aX._a){aX._a.pause();aX._a.src=""}}aY()}return aX};this.destruct=function(aZ){aS._wD('SMSound.destruct(): "'+aX.sID+'"');if(!aX.isHTML5){aX._iO.onfailure=null;aS.o._destroySound(aX.sID)}else{aW();if(aX._a){aX._a.pause();aX._a.src="";if(!aL){aX._remove_html5_events()}aX._a._t=null;aX._a=null}}if(!aZ){aS.destroySound(aX.sID,true)}};this.play=function(a2,a0){var a3="SMSound.play(): ",aZ,a1;a0=a0===undefined?true:a0;if(!a2){a2={}}aX._iO=ak(a2,aX._iO);aX._iO=ak(aX._iO,aX.options);aX.instanceOptions=aX._iO;if(aX._iO.serverURL&&!aX.connected){if(!aX.getAutoPlay()){aS._wD(a3+" Netstream not connected yet - setting autoPlay");aX.setAutoPlay(true)}return aX}if(D(aX._iO)){aX._setup_html5(aX._iO);aU()}if(aX.playState===1&&!aX.paused){aZ=aX._iO.multiShot;if(!aZ){aS._wD(a3+'"'+aX.sID+'" already playing (one-shot)',1);return aX}else{aS._wD(a3+'"'+aX.sID+'" already playing (multi-shot)',1)}}if(!aX.loaded){if(aX.readyState===0){aS._wD(a3+'Attempting to load "'+aX.sID+'"',1);if(!aX.isHTML5){aX._iO.autoPlay=true}aX.load(aX._iO)}else{if(aX.readyState===2){aS._wD(a3+'Could not load "'+aX.sID+'" - exiting',2);return aX}else{aS._wD(a3+'"'+aX.sID+'" is loading - attempting to play..',1)}}}else{aS._wD(a3+'"'+aX.sID+'"')}if(!aX.isHTML5&&e===9&&aX.position>0&&aX.position===aX.duration){aS._wD(a3+'"'+aX.sID+'": Sound at end, resetting to position:0');aX._iO.position=0}if(aX.paused&&aX.position&&aX.position>0){aS._wD(a3+'"'+aX.sID+'" is resuming from paused state',1);aX.resume()}else{aS._wD(a3+'"'+aX.sID+'" is starting to play');aX.playState=1;aX.paused=false;if(!aX.instanceCount||aX._iO.multiShotEvents||(!aX.isHTML5&&e>8&&!aX.getAutoPlay())){aX.instanceCount++}aX.position=(typeof aX._iO.position!=="undefined"&&!isNaN(aX._iO.position)?aX._iO.position:0);if(!aX.isHTML5){aX._iO=x(ab(aX._iO))}if(aX._iO.onplay&&a0){aX._iO.onplay.apply(aX);aX._onplay_called=true}aX.setVolume(aX._iO.volume,true);aX.setPan(aX._iO.pan,true);if(!aX.isHTML5){aS.o._start(aX.sID,aX._iO.loops||1,(e===9?aX._iO.position:aX._iO.position/1000))}else{aU();a1=aX._setup_html5();aX.setPosition(aX._iO.position);a1.play()}}return aX};this.start=this.play;this.stop=function(aZ){if(aX.playState===1){aX._onbufferchange(0);aX.resetOnPosition(0);if(!aX.isHTML5){aX.playState=0}aX.paused=false;if(aX._iO.onstop){aX._iO.onstop.apply(aX)}if(!aX.isHTML5){aS.o._stop(aX.sID,aZ);if(aX._iO.serverURL){aX.unload()}}else{if(aX._a){aX.setPosition(0);aX._a.pause();aX.playState=0;aX._onTimer();aW();aX.unload()}}aX.instanceCount=0;aX._iO={}}return aX};this.setAutoPlay=function(aZ){aS._wD("sound "+aX.sID+" turned autoplay "+(aZ?"on":"off"));aX._iO.autoPlay=aZ;if(!aX.isHTML5){aS.o._setAutoPlay(aX.sID,aZ);if(aZ){if(!aX.instanceCount&&aX.readyState===1){aX.instanceCount++;aS._wD("sound "+aX.sID+" incremented instance count to "+aX.instanceCount)}}}};this.getAutoPlay=function(){return aX._iO.autoPlay};this.setPosition=function(a2){if(a2===undefined){a2=0}var a1,aZ,a0,a4=(aX.isHTML5?Math.max(a2,0):Math.min(aX.duration||aX._iO.duration,Math.max(a2,0)));a1=aX.position;aX.position=a4;a0=aX.position/1000;aX.resetOnPosition(aX.position);aX._iO.position=a4;if(!aX.isHTML5){aZ=(e===9?aX.position:a0);if(aX.readyState&&aX.readyState!==2){aS.o._setPosition(aX.sID,aZ,(aX.paused||!aX.playState))}}else{if(aX._a){if(aX._html5_canplay){if(aX._a.currentTime!==a0){aS._wD("setPosition("+a0+"): setting position");try{aX._a.currentTime=a0;if(aX.playState===0||aX.paused){aX._a.pause()}}catch(a3){aS._wD("setPosition("+a0+"): setting position failed: "+a3.message,2)}}}else{aS._wD("setPosition("+a0+"): delaying, sound not ready")}}}if(aX.isHTML5){if(aX.paused){aX._onTimer(true)}}return aX};this.pause=function(aZ){if(aX.paused||(aX.playState===0&&aX.readyState!==1)){return aX}aS._wD("SMSound.pause()");aX.paused=true;if(!aX.isHTML5){if(aZ||aZ===undefined){aS.o._pause(aX.sID)}}else{aX._setup_html5().pause();aW()}if(aX._iO.onpause){aX._iO.onpause.apply(aX)}return aX};this.resume=function(){if(!aX.paused){return aX}aS._wD("SMSound.resume()");aX.paused=false;aX.playState=1;if(!aX.isHTML5){if(aX._iO.isMovieStar){aX.setPosition(aX.position)}aS.o._pause(aX.sID)}else{aX._setup_html5().play();aU()}if(!aX._onplay_called&&aX._iO.onplay){aX._iO.onplay.apply(aX);aX._onplay_called=true}else{if(aX._iO.onresume){aX._iO.onresume.apply(aX)}}return aX};this.togglePause=function(){aS._wD("SMSound.togglePause()");if(aX.playState===0){aX.play({position:(e===9&&!aX.isHTML5?aX.position:aX.position/1000)});return aX}if(aX.paused){aX.resume()}else{aX.pause()}return aX};this.setPan=function(a0,aZ){if(typeof a0==="undefined"){a0=0}if(typeof aZ==="undefined"){aZ=false}if(!aX.isHTML5){aS.o._setPan(aX.sID,a0)}aX._iO.pan=a0;if(!aZ){aX.pan=a0;aX.options.pan=a0}return aX};this.setVolume=function(aZ,a0){if(typeof aZ==="undefined"){aZ=100}if(typeof a0==="undefined"){a0=false}if(!aX.isHTML5){aS.o._setVolume(aX.sID,(aS.muted&&!aX.muted)||aX.muted?0:aZ)}else{if(aX._a){aX._a.volume=Math.max(0,Math.min(1,aZ/100))}}aX._iO.volume=aZ;if(!a0){aX.volume=aZ;aX.options.volume=aZ}return aX};this.mute=function(){aX.muted=true;if(!aX.isHTML5){aS.o._setVolume(aX.sID,0)}else{if(aX._a){aX._a.muted=true}}return aX};this.unmute=function(){aX.muted=false;var aZ=typeof aX._iO.volume!=="undefined";if(!aX.isHTML5){aS.o._setVolume(aX.sID,aZ?aX._iO.volume:aX.options.volume)}else{if(aX._a){aX._a.muted=false}}return aX};this.toggleMute=function(){return(aX.muted?aX.unmute():aX.mute())};this.onposition=function(a1,a0,aZ){aX._onPositionItems.push({position:a1,method:a0,scope:(typeof aZ!=="undefined"?aZ:aX),fired:false});return aX};this.processOnPosition=function(){var a0,a1,aZ=aX._onPositionItems.length;if(!aZ||!aX.playState||aX._onPositionFired>=aZ){return false}for(a0=aZ;a0--;){a1=aX._onPositionItems[a0];if(!a1.fired&&aX.position>=a1.position){a1.method.apply(a1.scope,[a1.position]);a1.fired=true;aS._onPositionFired++}}return true};this.resetOnPosition=function(aZ){var a1,a2,a0=aX._onPositionItems.length;if(!a0){return false}for(a1=a0;a1--;){a2=aX._onPositionItems[a1];if(a2.fired&&aZ<=a2.position){a2.fired=false;aS._onPositionFired--}}return true};aU=function(){if(aX.isHTML5){w(aX)}};aW=function(){if(aX.isHTML5){S(aX)}};aY=function(){aX._onPositionItems=[];aX._onPositionFired=0;aX._hasTimer=null;aX._onplay_called=false;aX._a=null;aX._html5_canplay=false;aX.bytesLoaded=null;aX.bytesTotal=null;aX.position=null;aX.duration=(aX._iO&&aX._iO.duration?aX._iO.duration:null);aX.durationEstimate=null;aX.failures=0;aX.loaded=false;aX.playState=0;aX.paused=false;aX.readyState=0;aX.muted=false;aX.didBeforeFinish=false;aX.didJustBeforeFinish=false;aX.isBuffering=false;aX.instanceOptions={};aX.instanceCount=0;aX.peakData={left:0,right:0};aX.waveformData={left:[],right:[]};aX.eqData=[];aX.eqData.left=[];aX.eqData.right=[]};aY();this._onTimer=function(a0){var a1,aZ={};if(aX._hasTimer||a0){if(aX._a&&(a0||((aX.playState>0||aX.readyState===1)&&!aX.paused))){aX.duration=aX._get_html5_duration();aX.durationEstimate=aX.duration;a1=aX._a.currentTime?aX._a.currentTime*1000:0;aX._whileplaying(a1,aZ,aZ,aZ,aZ);return true}else{aS._wD('_onTimer: Warn for "'+aX.sID+'": '+(!aX._a?"Could not find element. ":"")+(aX.playState===0?"playState bad, 0?":"playState = "+aX.playState+", OK"));return false}}};this._get_html5_duration=function(){var a0=(aX._a?aX._a.duration*1000:(aX._iO?aX._iO.duration:undefined)),aZ=(a0&&!isNaN(a0)&&a0!==Infinity?a0:(aX._iO?aX._iO.duration:null));return aZ};this._setup_html5=function(a1){var a0=ak(aX._iO,a1),a4=decodeURI,a2=aL?aS._global_a:aX._a,a3=a4(a0.url),aZ=(a2&&a2._t?a2._t.instanceOptions:null);if(a2){if(a2._t&&aZ.url===a0.url&&(!aX._lastURL||(aX._lastURL===aZ.url))){return a2}aS._wD("setting new URL on existing object: "+a3+(aX._lastURL?", old URL: "+aX._lastURL:""));if(aL&&a2._t&&a2._t.playState&&a0.url!==aZ.url){a2._t.stop()}aY();a2.src=a0.url;aX.url=a0.url;aX._lastURL=a0.url;a2._called_load=false}else{aS._wD("creating HTML5 Audio() element with URL: "+a3);a2=new Audio(a0.url);a2._called_load=false;if(aL){aS._global_a=a2}}aX.isHTML5=true;aX._a=a2;a2._t=aX;aX._add_html5_events();a2.loop=(a0.loops>1?"loop":"");if(a0.autoLoad||a0.autoPlay){a2.autobuffer="auto";a2.preload="auto";aX.load();a2._called_load=true}else{a2.autobuffer=false;a2.preload="none"}a2.loop=(a0.loops>1?"loop":"");return a2};this._add_html5_events=function(){if(aX._a._added_events){return false}var aZ;function a0(a2,a1,a3){return aX._a?aX._a.addEventListener(a2,a1,a3||false):null}aS._wD(aH+"adding event listeners: "+aX.sID);aX._a._added_events=true;for(aZ in t){if(t.hasOwnProperty(aZ)){a0(aZ,t[aZ])}}return true};this._remove_html5_events=function(){var a0;function aZ(a2,a1,a3){return(aX._a?aX._a.removeEventListener(a2,a1,a3||false):null)}aS._wD(aH+"removing event listeners: "+aX.sID);aX._a._added_events=false;for(a0 in t){if(t.hasOwnProperty(a0)){aZ(a0,t[a0])}}};this._onload=function(a1){var aZ="SMSound._onload(): ",a0=(a1?true:false);aS._wD(aZ+'"'+aX.sID+'"'+(a0?" loaded.":" failed to load? - "+aX.url),(a0?1:2));if(!a0&&!aX.isHTML5){if(aS.sandbox.noRemote===true){aS._wD(aZ+Z("noNet"),1)}if(aS.sandbox.noLocal===true){aS._wD(aZ+Z("noLocal"),1)}}aX.loaded=a0;aX.readyState=a0?3:2;aX._onbufferchange(0);if(aX._iO.onload){aX._iO.onload.apply(aX,[a0])}return true};this._onbufferchange=function(aZ){var a0="SMSound._onbufferchange()";if(aX.playState===0){return false}if((aZ&&aX.isBuffering)||(!aZ&&!aX.isBuffering)){return false}aX.isBuffering=(aZ===1);if(aX._iO.onbufferchange){aS._wD(a0+": "+aZ);aX._iO.onbufferchange.apply(aX)}return true};this._onfailure=function(a0,a1,aZ){aX.failures++;aS._wD('SMSound._onfailure(): "'+aX.sID+'" count '+aX.failures);if(aX._iO.onfailure&&aX.failures===1){aX._iO.onfailure(aX,a0,a1,aZ)}else{aS._wD("SMSound._onfailure(): ignoring")}};this._onbeforefinish=function(){if(!aX.didBeforeFinish){aX.didBeforeFinish=true;if(aX._iO.onbeforefinish){aS._wD('SMSound._onbeforefinish(): "'+aX.sID+'"');aX._iO.onbeforefinish.apply(aX)}}};this._onjustbeforefinish=function(aZ){if(!aX.didJustBeforeFinish){aX.didJustBeforeFinish=true;if(aX._iO.onjustbeforefinish){aS._wD('SMSound._onjustbeforefinish(): "'+aX.sID+'"');aX._iO.onjustbeforefinish.apply(aX)}}};this._onfinish=function(){var aZ=aX._iO.onfinish;aX._onbufferchange(0);aX.resetOnPosition(0);if(aX._iO.onbeforefinishcomplete){aX._iO.onbeforefinishcomplete.apply(aX)}aX.didBeforeFinish=false;aX.didJustBeforeFinish=false;if(aX.instanceCount){aX.instanceCount--;if(!aX.instanceCount){aX.playState=0;aX.paused=false;aX.instanceCount=0;aX.instanceOptions={};aX._iO={};aW()}if(!aX.instanceCount||aX._iO.multiShotEvents){if(aZ){aS._wD('SMSound._onfinish(): "'+aX.sID+'"');aZ.apply(aX)}}}};this._whileloading=function(aZ,a0,a2,a1){aX.bytesLoaded=aZ;aX.bytesTotal=a0;aX.duration=Math.floor(a2);aX.bufferLength=a1;if(!aX._iO.isMovieStar){if(aX._iO.duration){aX.durationEstimate=(aX.duration>aX._iO.duration)?aX.duration:aX._iO.duration}else{aX.durationEstimate=parseInt((aX.bytesTotal/aX.bytesLoaded)*aX.duration,10)}if(aX.durationEstimate===undefined){aX.durationEstimate=aX.duration}if(aX.readyState!==3&&aX._iO.whileloading){aX._iO.whileloading.apply(aX)}}else{aX.durationEstimate=aX.duration;if(aX.readyState!==3&&aX._iO.whileloading){aX._iO.whileloading.apply(aX)}}};this._whileplaying=function(a1,a2,a4,a0,a3){if(isNaN(a1)||a1===null){return false}aX.position=a1;aX.processOnPosition();if(!aX.isHTML5&&e>8){if(aX._iO.usePeakData&&typeof a2!=="undefined"&&a2){aX.peakData={left:a2.leftPeak,right:a2.rightPeak}}if(aX._iO.useWaveformData&&typeof a4!=="undefined"&&a4){aX.waveformData={left:a4.split(","),right:a0.split(",")}}if(aX._iO.useEQData){if(typeof a3!=="undefined"&&a3&&a3.leftEQ){var aZ=a3.leftEQ.split(",");aX.eqData=aZ;aX.eqData.left=aZ;if(typeof a3.rightEQ!=="undefined"&&a3.rightEQ){aX.eqData.right=a3.rightEQ.split(",")}}}}if(aX.playState===1){if(!aX.isHTML5&&aS.flashVersion===8&&!aX.position&&aX.isBuffering){aX._onbufferchange(0)}if(aX._iO.whileplaying){aX._iO.whileplaying.apply(aX)}if((aX.loaded||(!aX.loaded&&aX._iO.isMovieStar))&&aX._iO.onbeforefinish&&aX._iO.onbeforefinishtime&&!aX.didBeforeFinish&&aX.duration-aX.position<=aX._iO.onbeforefinishtime){aX._onbeforefinish()}}return true};this._onid3=function(a2,aZ){aS._wD('SMSound._onid3(): "'+this.sID+'" ID3 data received.');var a3=[],a1,a0;for(a1=0,a0=a2.length;a1<a0;a1++){a3[a2[a1]]=aZ[a1]}aX.id3=ak(aX.id3,a3);if(aX._iO.onid3){aX._iO.onid3.apply(aX)}};this._onconnect=function(aZ){var a0="SMSound._onconnect(): ";aZ=(aZ===1);aS._wD(a0+'"'+aX.sID+'"'+(aZ?" connected.":" failed to connect? - "+aX.url),(aZ?1:2));aX.connected=aZ;if(aZ){aX.failures=0;if(af(aX.sID)){if(aX.getAutoPlay()){aX.play(undefined,aX.getAutoPlay())}else{if(aX._iO.autoLoad){aX.load()}}}if(aX._iO.onconnect){aX._iO.onconnect.apply(aX,[aZ])}}};this._ondataerror=function(aZ){if(aX.playState>0){aS._wD("SMSound._ondataerror(): "+aZ);if(aX._iO.ondataerror){aX._iO.ondataerror.apply(aX)}}}};ap=function(){return(aF.body||aF._docElement||aF.getElementsByTagName("div")[0])};Y=function(aU){return aF.getElementById(aU)};ak=function(aV,aU){var aY={},aW,aX,aZ;for(aW in aV){if(aV.hasOwnProperty(aW)){aY[aW]=aV[aW]}}aX=(typeof aU==="undefined"?aS.defaultOptions:aU);for(aZ in aX){if(aX.hasOwnProperty(aZ)&&typeof aY[aZ]==="undefined"){aY[aZ]=aX[aZ]}}return aY};r=(function(){var aW=(k.attachEvent),aV={add:(aW?"attachEvent":"addEventListener"),remove:(aW?"detachEvent":"removeEventListener")};function aY(a2){var a1=j.call(a2),a0=a1.length;if(aW){a1[1]="on"+a1[1];if(a0>3){a1.pop()}}else{if(a0===3){a1.push(false)}}return a1}function aX(a0,a3){var a1=a0.shift(),a2=[aV[a3]];if(aW){a1[a2](a0[0],a0[1])}else{a1[a2].apply(a1,a0)}}function aZ(){aX(aY(arguments),"add")}function aU(){aX(aY(arguments),"remove")}return{add:aZ,remove:aU}}());D=function(aU){return(!aU.serverURL&&(aU.type?aw({type:aU.type}):aw({url:aU.url})||aS.html5Only))};aw=function(aX){if(!aS.useHTML5Audio||!aS.hasHTML5){return false}var aV=(aX.url||null),aU=(aX.type||null),aY=aS.audioFormats,a2,aZ,a1,a0;function aW(a3){return(aS.preferFlash&&g&&!aS.ignoreFlash&&(typeof aS.flash[a3]!=="undefined"&&aS.flash[a3]))}if(aU&&aS.html5[aU]!=="undefined"){return(aS.html5[aU]&&!aW(aU))}if(!p){p=[];for(a0 in aY){if(aY.hasOwnProperty(a0)){p.push(a0);if(aY[a0].related){p=p.concat(aY[a0].related)}}}p=new RegExp("\\.("+p.join("|")+")(\\?.*)?$","i")}a1=(aV?aV.toLowerCase().match(p):null);if(!a1||!a1.length){if(!aU){return false}else{aZ=aU.indexOf(";");a1=(aZ!==-1?aU.substr(0,aZ):aU).substr(6)}}else{a1=a1[1]}if(a1&&typeof aS.html5[a1]!=="undefined"){return(aS.html5[a1]&&!aW(a1))}else{aU="audio/"+a1;a2=aS.html5.canPlayType({type:aU});aS.html5[a1]=a2;return(a2&&aS.html5[aU]&&!aW(aU))}};aQ=function(){if(!aS.useHTML5Audio||typeof Audio==="undefined"){return false}var aU=(typeof Audio!=="undefined"?(K?new Audio(null):new Audio()):null),aZ,aY={},aW,aX;function aV(a1){var a3,a4,a2,a0=false;if(!aU||typeof aU.canPlayType!=="function"){return false}if(a1 instanceof Array){for(a4=0,a2=a1.length;a4<a2&&!a0;a4++){if(aS.html5[a1[a4]]||aU.canPlayType(a1[a4]).match(aS.html5Test)){a0=true;aS.html5[a1[a4]]=true;aS.flash[a1[a4]]=!!(aS.preferFlash&&g&&a1[a4].match(P))}}return a0}else{a3=(aU&&typeof aU.canPlayType==="function"?aU.canPlayType(a1):false);return !!(a3&&(a3.match(aS.html5Test)))}}aW=aS.audioFormats;for(aZ in aW){if(aW.hasOwnProperty(aZ)){aY[aZ]=aV(aW[aZ].type);aY["audio/"+aZ]=aY[aZ];if(aS.preferFlash&&!aS.ignoreFlash&&aZ.match(P)){aS.flash[aZ]=true}else{aS.flash[aZ]=false}if(aW[aZ]&&aW[aZ].related){for(aX=aW[aZ].related.length;aX--;){aY["audio/"+aW[aZ].related[aX]]=aY[aZ];aS.html5[aW[aZ].related[aX]]=aY[aZ];aS.flash[aW[aZ].related[aX]]=aY[aZ]}}}}aY.canPlayType=(aU?aV:null);aS.html5=ak(aS.html5,aY);return true};N={notReady:"Not loaded yet - wait for soundManager.onload()/onready()",notOK:"Audio support is not available.",domError:aq+"createMovie(): appendChild/innerHTML call failed. DOM not ready or other error.",spcWmode:aq+"createMovie(): Removing wmode, preventing known SWF loading issue(s)",swf404:aB+": Verify that %s is a valid path.",tryDebug:"Try "+aB+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:aB+": Non-HTTP page ("+aF.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:aB+": Special case: Waiting for focus-related event..",waitImpatient:aB+": Getting impatient, still waiting for Flash%s...",waitForever:aB+": Waiting indefinitely for Flash (will recover if unblocked)...",needFunction:aB+": Function object expected for %s",badID:'Warning: Sound ID "%s" should be a string, starting with a non-numeric character',noMS:"MovieStar mode not enabled. Exiting.",currentObj:"--- "+aB+"._debug(): Current sound objects ---",waitEI:aq+"initMovie(): Waiting for ExternalInterface call from Flash..",waitOnload:aB+": Waiting for window.onload()",docLoaded:aB+": Document already loaded",onload:aq+"initComplete(): calling soundManager.onload()",onloadOK:aB+".onload() complete",init:aq+"init()",didInit:aq+"init(): Already called?",flashJS:aB+": Attempting to call Flash from JS..",noPolling:aB+": Polling (whileloading()/whileplaying() support) is disabled.",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"Warning: Failed to remove flash movie.",noPeak:"Warning: peakData features unsupported for movieStar formats",shutdown:aB+".disable(): Shutting down",queue:aB+": Queueing %s handler",smFail:aB+": Failed to initialise.",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+aS.swfCSS.swfTimedout+" CSS..",fbLoaded:"Flash loaded",fbHandler:aq+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:aB+".load(): current URL already assigned.",badFV:aB+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",mfOn:"mobileFlash::enabling on-screen flash repositioning",policy:"Enabling usePolicyFile for data access"};Z=function(){var aV=j.call(arguments),aY=aV.shift(),aX=(N&&N[aY]?N[aY]:""),aW,aU;if(aX&&aV&&aV.length){for(aW=0,aU=aV.length;aW<aU;aW++){aX=aX.replace("%s",aV[aW])}}return aX};ab=function(aU){if(e===8&&aU.loops>1&&aU.stream){B("as2loop");aU.stream=false}return aU};x=function(aV,aU){if(aV&&!aV.usePolicyFile&&(aV.onid3||aV.usePeakData||aV.useWaveformData||aV.useEQData)){aS._wD((aU||"")+Z("policy"));aV.usePolicyFile=true}return aV};d=function(aU){if(typeof console!=="undefined"&&typeof console.warn!=="undefined"){console.warn(aU)}else{aS._wD(aU)}};ae=function(){return false};W=function(aV){var aU;for(aU in aV){if(aV.hasOwnProperty(aU)&&typeof aV[aU]==="function"){aV[aU]=ae}}aU=null};ao=function(aU){if(typeof aU==="undefined"){aU=false}if(I||aU){B("smFail",2);aS.disable(aU)}};h=function(aU){var aV=null;if(aU){if(aU.match(/\.swf(\?.*)?$/i)){aV=aU.substr(aU.toLowerCase().lastIndexOf(".swf?")+4);if(aV){return aU}}else{if(aU.lastIndexOf("/")!==aU.length-1){aU=aU+"/"}}}return(aU&&aU.lastIndexOf("/")!==-1?aU.substr(0,aU.lastIndexOf("/")+1):"./")+aS.movieURL};M=function(){if(e!==8&&e!==9){aS._wD(Z("badFV",e,Q));aS.flashVersion=Q}var aU=(aS.debugMode||aS.debugFlash?"_debug.swf":".swf");if(aS.useHTML5Audio&&!aS.html5Only&&aS.audioFormats.mp4.required&&aS.flashVersion<9){aS._wD(Z("needfl9"));aS.flashVersion=9}e=aS.flashVersion;aS.version=aS.versionNumber+(aS.html5Only?" (HTML5-only mode)":(e===9?" (AS3/Flash 9)":" (AS2/Flash 8)"));if(e>8){aS.defaultOptions=ak(aS.defaultOptions,aS.flash9Options);aS.features.buffering=true}if(e>8&&aS.useMovieStar){aS.defaultOptions=ak(aS.defaultOptions,aS.movieStarOptions);aS.filePatterns.flash9=new RegExp("\\.(mp3|"+aS.netStreamTypes.join("|")+")(\\?.*)?$","i");aS.mimePattern=aS.netStreamMimeTypes;aS.features.movieStar=true}else{aS.useMovieStar=false;aS.features.movieStar=false}aS.filePattern=aS.filePatterns[(e!==8?"flash9":"flash8")];aS.movieURL=(e===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",aU);aS.features.peakData=aS.features.waveformData=aS.features.eqData=(e>8)};am=function(aU,aV){if(!aS.o||!aS.allowPolling){return false}aS.o._setPolling(aU,aV)};H=function(){if(aS.debugURLParam.test(l)){aS.debugMode=true}if(Y(aS.debugID)){return false}var aZ,aY,aU,aW,aV;if(aS.debugMode&&!Y(aS.debugID)&&((!aA||!aS.useConsole)||(aS.useConsole&&aA&&!aS.consoleOnly))){aZ=aF.createElement("div");aZ.id=aS.debugID+"-toggle";aW={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};aZ.appendChild(aF.createTextNode("-"));aZ.onclick=y;aZ.title="Toggle SM2 debug console";if(ac.match(/msie 6/i)){aZ.style.position="absolute";aZ.style.cursor="hand"}for(aV in aW){if(aW.hasOwnProperty(aV)){aZ.style[aV]=aW[aV]}}aY=aF.createElement("div");aY.id=aS.debugID;aY.style.display=(aS.debugMode?"block":"none");if(aS.debugMode&&!Y(aZ.id)){try{aU=ap();aU.appendChild(aZ)}catch(aX){throw new Error(Z("domError")+" \n"+aX.toString())}aU.appendChild(aY)}}aU=null};af=this.getSoundById;B=function(aV,aU){if(!aV){return""}else{return aS._wD(Z(aV),aU)}};if(l.indexOf("sm2-debug=alert")+1&&aS.debugMode){aS._wD=function(aU){c.alert(aU)}}y=function(){var aV=Y(aS.debugID),aU=Y(aS.debugID+"-toggle");if(!aV){return false}if(m){aU.innerHTML="+";aV.style.display="none"}else{aU.innerHTML="-";aV.style.display="block"}m=!m};ah=function(aX,aU,aV){if(typeof sm2Debugger!=="undefined"){try{sm2Debugger.handleEvent(aX,aU,aV)}catch(aW){}}return true};L=function(){var aU=[];if(aS.debugMode){aU.push(aS.swfCSS.sm2Debug)}if(aS.debugFlash){aU.push(aS.swfCSS.flashDebug)}if(aS.useHighPerformance){aU.push(aS.swfCSS.highPerf)}return aU.join(" ")};i=function(){var aV=Z("fbHandler"),aX=aS.getMoviePercent(),aW=aS.swfCSS,aU={type:"FLASHBLOCK"};if(aS.html5Only){return false}if(!aS.ok()){if(ai){aS.oMC.className=L()+" "+aW.swfDefault+" "+(aX===null?aW.swfTimedout:aW.swfError);aS._wD(aV+": "+Z("fbTimeout")+(aX?" ("+Z("fbLoaded")+")":""))}aS.didFlashBlock=true;aR({type:"ontimeout",ignoreInit:true,error:aU});aC(aU)}else{if(aS.didFlashBlock){aS._wD(aV+": Unblocked")}if(aS.oMC){aS.oMC.className=[L(),aW.swfDefault,aW.swfLoaded+(aS.didFlashBlock?" "+aW.swfUnblocked:"")].join(" ")}}};aN=function(aW,aV,aU){if(typeof al[aW]==="undefined"){al[aW]=[]}al[aW].push({method:aV,scope:(aU||null),fired:false})};aR=function(a0){if(!a0){a0={type:"onready"}}if(!aK&&a0&&!a0.ignoreInit){return false}if(a0.type==="ontimeout"&&aS.ok()){return false}var aW={success:(a0&&a0.ignoreInit?aS.ok():!I)},aV=(a0&&a0.type?al[a0.type]||[]:[]),aU=[],a1,aZ,aY=[aW],aX=(ai&&aS.useFlashBlock&&!aS.ok());if(a0.error){aY[0].error=a0.error}for(a1=0,aZ=aV.length;a1<aZ;a1++){if(aV[a1].fired!==true){aU.push(aV[a1])}}if(aU.length){aS._wD(aB+": Firing "+aU.length+" "+a0.type+"() item"+(aU.length===1?"":"s"));for(a1=0,aZ=aU.length;a1<aZ;a1++){if(aU[a1].scope){aU[a1].method.apply(aU[a1].scope,aY)}else{aU[a1].method.apply(this,aY)}if(!aX){aU[a1].fired=true}}}return true};ar=function(){k.setTimeout(function(){if(aS.useFlashBlock){i()}aR();if(aS.onload instanceof Function){B("onload",1);aS.onload.apply(k);B("onloadOK",1)}if(aS.waitForWindowLoad){r.add(k,"load",ar)}},1)};aP=function(){if(g!==undefined){return g}var aU=false,a1=navigator,aX=a1.plugins,a0,aW,aV,aZ=k.ActiveXObject;if(aX&&aX.length){aW="application/x-shockwave-flash";aV=a1.mimeTypes;if(aV&&aV[aW]&&aV[aW].enabledPlugin&&aV[aW].enabledPlugin.description){aU=true}}else{if(typeof aZ!=="undefined"){try{a0=new aZ("ShockwaveFlash.ShockwaveFlash")}catch(aY){}aU=(!!a0)}}g=aU;return aU};ag=function(){var aW,aV,aU=(ac.match(/iphone os (1|2|3_0|3_1)/i)?true:false);if(aU){aS.hasHTML5=false;aS.html5Only=true;if(aS.oMC){aS.oMC.style.display="none"}return false}if(aS.useHTML5Audio){if(!aS.html5||!aS.html5.canPlayType){aS._wD("SoundManager: No HTML5 Audio() support detected.");aS.hasHTML5=false;return true}else{aS.hasHTML5=true}if(an){aS._wD(aq+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(!g?" would use flash fallback for MP3/MP4, but none detected.":"will use flash fallback for MP3/MP4, if available"),1);if(aP()){return true}}}else{return true}for(aV in aS.audioFormats){if(aS.audioFormats.hasOwnProperty(aV)){if((aS.audioFormats[aV].required&&!aS.html5.canPlayType(aS.audioFormats[aV].type))||aS.flash[aV]||aS.flash[aS.audioFormats[aV].type]){aW=true}}}if(aS.ignoreFlash){aW=false}aS.html5Only=(aS.hasHTML5&&aS.useHTML5Audio&&!aW);return(!aS.html5Only)};w=function(aU){if(!aU._hasTimer){aU._hasTimer=true}};S=function(aU){if(aU._hasTimer){aU._hasTimer=false}};aC=function(aU){aU=(typeof aU!=="undefined"?aU:{});if(aS.onerror instanceof Function){aS.onerror.apply(k,[{type:(typeof aU.type!=="undefined"?aU.type:null)}])}if(typeof aU.fatal!=="undefined"&&aU.fatal){aS.disable()}};aa=function(){if(!an||!aP()){return false}var aU=aS.audioFormats,aV,aW;for(aW in aU){if(aU.hasOwnProperty(aW)){if(aW==="mp3"||aW==="mp4"){aS._wD(aB+": Using flash fallback for "+aW+" format");aS.html5[aW]=false;if(aU[aW]&&aU[aW].related){for(aV=aU[aW].related.length;aV--;){aS.html5[aU[aW].related[aV]]=false}}}}}};this._setSandboxType=function(aU){var aV=aS.sandbox;aV.type=aU;aV.description=aV.types[(typeof aV.types[aU]!=="undefined"?aU:"unknown")];aS._wD("Flash security sandbox type: "+aV.type);if(aV.type==="localWithFile"){aV.noRemote=true;aV.noLocal=false;B("secNote",2)}else{if(aV.type==="localWithNetwork"){aV.noRemote=false;aV.noLocal=true}else{if(aV.type==="localTrusted"){aV.noRemote=false;aV.noLocal=false}}}};this._externalInterfaceOK=function(aU){if(aS.swfLoaded){return false}var aV=new Date().getTime();aS._wD(aq+"externalInterfaceOK()"+(aU?" (~"+(aV-aU)+" ms)":""));ah("swf",true);ah("flashtojs",true);aS.swfLoaded=true;ad=false;if(an){aa()}if(f){setTimeout(ax,100)}else{ax()}};aJ=function(a9,aZ){if(av&&aM){return false}function a7(){aS._wD("-- SoundManager 2 "+aS.version+(!aS.html5Only&&aS.useHTML5Audio?(aS.hasHTML5?" + HTML5 audio":", no HTML5 audio support"):"")+(!aS.html5Only?(aS.useMovieStar?", MovieStar mode":"")+(aS.useHighPerformance?", high performance mode, ":", ")+((aS.flashPollingInterval?"custom ("+aS.flashPollingInterval+"ms)":(aS.useFastPolling?"fast":"normal"))+" polling")+(aS.wmode?", wmode: "+aS.wmode:"")+(aS.debugFlash?", flash debug mode":"")+(aS.useFlashBlock?", flashBlock mode":""):"")+" --",1)}if(aS.html5Only){M();a7();aS.oMC=Y(aS.movieID);ax();av=true;aM=true;return false}var a8=(aZ||aS.url),a3=(aS.altURL||a8),be="JS/Flash audio component (SoundManager 2)",bb,a0,a6=ap(),bc,a4,a2,a5=L(),a1,aX,bd,aU="auto",aV=null,aY=aF.getElementsByTagName("html")[0];aV=(aY&&aY.dir&&aY.dir.match(/rtl/i));a9=(typeof a9==="undefined"?aS.id:a9);function aW(bf,bg){return'<param name="'+bf+'" value="'+bg+'" />'}M();aS.url=h(au?a8:a3);aZ=aS.url;aS.wmode=(!aS.wmode&&aS.useHighPerformance&&!aS.useMovieStar?"transparent":aS.wmode);if(aS.wmode!==null&&(ac.match(/msie 8/i)||(!f&&!aS.useHighPerformance))&&navigator.platform.match(/win32|win64/i)){aS.specialWmodeCase=true;B("spcWmode");aS.wmode=null}bb={name:a9,id:a9,src:aZ,width:aU,height:aU,quality:"high",allowScriptAccess:aS.allowScriptAccess,bgcolor:aS.bgColor,pluginspage:ay+"//www.macromedia.com/go/getflashplayer",title:be,type:"application/x-shockwave-flash",wmode:aS.wmode,hasPriority:"true"};if(aS.debugFlash){bb.FlashVars="debug=1"}if(!aS.wmode){delete bb.wmode}if(f){a0=aF.createElement("div");a4=['<object id="'+a9+'" data="'+aZ+'" type="'+bb.type+'" title="'+bb.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+ay+'//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="'+bb.width+'" height="'+bb.height+'">',aW("movie",aZ),aW("AllowScriptAccess",aS.allowScriptAccess),aW("quality",bb.quality),(aS.wmode?aW("wmode",aS.wmode):""),aW("bgcolor",aS.bgColor),aW("hasPriority","true"),(aS.debugFlash?aW("FlashVars",bb.FlashVars):""),"</object>"].join("")}else{a0=aF.createElement("embed");for(bc in bb){if(bb.hasOwnProperty(bc)){a0.setAttribute(bc,bb[bc])}}}H();a5=L();a6=ap();if(a6){aS.oMC=(Y(aS.movieID)||aF.createElement("div"));if(!aS.oMC.id){aS.oMC.id=aS.movieID;aS.oMC.className=aS.swfCSS.swfDefault+" "+a5;a1=null;a2=null;if(!aS.useFlashBlock){if(aS.useHighPerformance){a1={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}}else{a1={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"};if(aV){a1.left=Math.abs(parseInt(a1.left,10))+"px"}}}if(n){aS.oMC.style.zIndex=10000}if(!aS.debugFlash){for(aX in a1){if(a1.hasOwnProperty(aX)){aS.oMC.style[aX]=a1[aX]}}}try{if(!f){aS.oMC.appendChild(a0)}a6.appendChild(aS.oMC);if(f){a2=aS.oMC.appendChild(aF.createElement("div"));a2.className=aS.swfCSS.swfBox;a2.innerHTML=a4}aM=true}catch(ba){throw new Error(Z("domError")+" \n"+ba.toString())}}else{bd=aS.oMC.className;aS.oMC.className=(bd?bd+" ":aS.swfCSS.swfDefault)+(a5?" "+a5:"");aS.oMC.appendChild(a0);if(f){a2=aS.oMC.appendChild(aF.createElement("div"));a2.className=aS.swfCSS.swfBox;a2.innerHTML=a4}aM=true}}av=true;a7();aS._wD(aq+"createMovie(): Trying to load "+aZ+(!au&&aS.altURL?" (alternate URL)":""),1);return true};s=function(){if(aS.html5Only){aJ();return false}if(aS.o){return false}aS.o=aS.getMovie(aS.id);if(!aS.o){if(!o){aJ(aS.id,aS.url)}else{if(!f){aS.oMC.appendChild(o)}else{aS.oMC.innerHTML=at}o=null;av=true}aS.o=aS.getMovie(aS.id)}if(aS.o){B("waitEI")}if(aS.oninitmovie instanceof Function){setTimeout(aS.oninitmovie,1)}return true};aj=function(){setTimeout(u,1000)};u=function(){if(aT){return false}aT=true;r.remove(k,"load",aj);if(ad&&!aG){B("waitFocus");return false}var aU;if(!aK){aU=aS.getMoviePercent();aS._wD(Z("waitImpatient",(aU===100?" (SWF loaded)":(aU>0?" (SWF "+aU+"% loaded)":""))))}setTimeout(function(){aU=aS.getMoviePercent();if(!aK){aS._wD(aB+": No Flash response within expected time.\nLikely causes: "+(aU===0?"Loading "+aS.movieURL+" may have failed (and/or Flash "+e+"+ not present?), ":"")+"Flash blocked or JS-Flash security error."+(aS.debugFlash?" "+Z("checkSWF"):""),2);if(!au&&aU){B("localFail",2);if(!aS.debugFlash){B("tryDebug",2)}}if(aU===0){aS._wD(Z("swf404",aS.url))}ah("flashtojs",false,": Timed out"+au?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")}if(!aK&&J){if(aU===null){if(aS.useFlashBlock||aS.flashLoadTimeout===0){if(aS.useFlashBlock){i()}B("waitForever")}else{ao(true)}}else{if(aS.flashLoadTimeout===0){B("waitForever")}else{ao(true)}}}},aS.flashLoadTimeout)};aD=function(){function aU(){r.remove(k,"focus",aD);r.remove(k,"load",aD)}if(aG||!ad){aU();return true}J=true;aG=true;aS._wD(aq+"handleFocus()");if(E&&ad){r.remove(k,"mousemove",aD)}aT=false;aU();return true};V=function(aW){if(aK){return false}if(aS.html5Only){aS._wD("-- SoundManager 2: loaded --");aK=true;ar();ah("onload",true);return true}var aU=(aS.useFlashBlock&&aS.flashLoadTimeout&&!aS.getMoviePercent()),aV;if(!aU){aK=true;if(I){aV={type:(!g&&ai?"NO_FLASH":"INIT_TIMEOUT")}}}aS._wD("-- SoundManager 2 "+(I?"failed to load":"loaded")+" ("+(I?"security/load error":"OK")+") --",1);if(I||aW){if(aS.useFlashBlock&&aS.oMC){aS.oMC.className=L()+" "+(aS.getMoviePercent()===null?aS.swfCSS.swfTimedout:aS.swfCSS.swfError)}aR({type:"ontimeout",error:aV});ah("onload",false);aC(aV);return false}else{ah("onload",true)}r.add(k,"unload",ae);if(aS.waitForWindowLoad&&!v){B("waitOnload");r.add(k,"load",ar);return false}else{if(aS.waitForWindowLoad&&v){B("docLoaded")}ar()}return true};C=function(){var aV,aU=[];if(aS.useHTML5Audio&&aS.hasHTML5){for(aV in aS.audioFormats){if(aS.audioFormats.hasOwnProperty(aV)){aU.push(aV+": "+aS.html5[aV]+(!aS.html5[aV]&&g&&aS.flash[aV]?" (using flash)":(aS.preferFlash&&aS.flash[aV]&&g?" (preferring flash)":(!aS.html5[aV]?" ("+(aS.audioFormats[aV].required?"required, ":"")+"and no flash support)":""))))}}aS._wD("-- SoundManager 2: HTML5 support tests ("+aS.html5Test+"): "+aU.join(", ")+" --",1)}};ax=function(){B("init");if(aK){B("didInit");return false}function aU(){r.remove(k,"load",aS.beginDelayedInit)}if(aS.html5Only){if(!aK){aU();aS.enabled=true;V()}return true}s();try{B("flashJS");aS.o._externalInterfaceTest(false);if(!aS.allowPolling){B("noPolling",1)}else{am(true,(aS.flashPollingInterval||(aS.useFastPolling?10:50)))}if(!aS.debugMode){aS.o._disableDebug()}aS.enabled=true;ah("jstoflash",true)}catch(aV){aS._wD("js/flash exception: "+aV.toString());ah("jstoflash",false);aC({type:"JS_TO_FLASH_EXCEPTION",fatal:true});ao(true);V();return false}V();aU();return true};aO=function(){if(az){return false}az=true;H();(function(){var aY="sm2-usehtml5audio=",aX=l.toLowerCase(),aW=null,aV="sm2-preferflash=",aZ=null,aU=(typeof console!=="undefined"&&typeof console.log!=="undefined");if(aX.indexOf(aY)!==-1){aW=(aX.charAt(aX.indexOf(aY)+aY.length)==="1");if(aU){console.log((aW?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter")}aS.useHTML5Audio=aW}if(aX.indexOf(aV)!==-1){aZ=(aX.charAt(aX.indexOf(aV)+aV.length)==="1");if(aU){console.log((aZ?"Enabling ":"Disabling ")+"preferFlash via URL parameter")}aS.preferFlash=aZ}}());if(!g&&aS.hasHTML5){aS._wD("SoundManager: No Flash detected"+(!aS.useHTML5Audio?", enabling HTML5.":". Trying HTML5-only mode."));aS.useHTML5Audio=true;aS.preferFlash=false}aQ();aS.html5.usingFlash=ag();ai=aS.html5.usingFlash;C();if(!g&&ai){aS._wD("SoundManager: Fatal error: Flash is needed to play some required formats, but is not available.");aS.flashLoadTimeout=1}if(aF.removeEventListener){aF.removeEventListener("DOMContentLoaded",aO,false)}s();return true};T=function(){if(aF.readyState==="complete"){aO();aF.detachEvent("onreadystatechange",T)}return true};aP();r.add(k,"focus",aD);r.add(k,"load",aD);r.add(k,"load",aj);if(E&&ad){r.add(k,"mousemove",aD)}if(aF.addEventListener){aF.addEventListener("DOMContentLoaded",aO,false)}else{if(aF.attachEvent){aF.attachEvent("onreadystatechange",T)}else{ah("onload",false);aC({type:"NO_DOM2_EVENTS",fatal:true})}}if(aF.readyState==="complete"){setTimeout(aO,100)}}if(typeof SM2_DEFER==="undefined"||!SM2_DEFER){b=new a()}c.SoundManager=a;c.soundManager=b}(window));var ClassicalNoise=function(b){if(b==undefined){b=Math}this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.p=[];for(var a=0;a<256;a++){this.p[a]=Math.floor(b.random()*256)}this.perm=[];for(var a=0;a<512;a++){this.perm[a]=this.p[a&255]}};ClassicalNoise.prototype.dot=function(b,a,d,c){return b[0]*a+b[1]*d+b[2]*c};ClassicalNoise.prototype.mix=function(d,c,e){return(1-e)*d+e*c};ClassicalNoise.prototype.fade=function(a){return a*a*a*(a*(a*6-15)+10)};ClassicalNoise.prototype.noise=function(s,r,p){var h=Math.floor(s);var f=Math.floor(r);var e=Math.floor(p);s=s-h;r=r-f;p=p-e;h=h&255;f=f&255;e=e&255;var c=this.perm[h+this.perm[f+this.perm[e]]]%12;var a=this.perm[h+this.perm[f+this.perm[e+1]]]%12;var o=this.perm[h+this.perm[f+1+this.perm[e]]]%12;var m=this.perm[h+this.perm[f+1+this.perm[e+1]]]%12;var F=this.perm[h+1+this.perm[f+this.perm[e]]]%12;var E=this.perm[h+1+this.perm[f+this.perm[e+1]]]%12;var L=this.perm[h+1+this.perm[f+1+this.perm[e]]]%12;var K=this.perm[h+1+this.perm[f+1+this.perm[e+1]]]%12;var k=this.dot(this.grad3[c],s,r,p);var H=this.dot(this.grad3[F],s-1,r,p);var D=this.dot(this.grad3[o],s,r-1,p);var i=this.dot(this.grad3[L],s-1,r-1,p);var j=this.dot(this.grad3[a],s,r,p-1);var G=this.dot(this.grad3[E],s-1,r,p-1);var C=this.dot(this.grad3[m],s,r-1,p-1);var g=this.dot(this.grad3[K],s-1,r-1,p-1);var B=this.fade(s);var A=this.fade(r);var t=this.fade(p);var d=this.mix(k,H,B);var b=this.mix(j,G,B);var q=this.mix(D,i,B);var n=this.mix(C,g,B);var J=this.mix(d,q,A);var I=this.mix(b,n,A);var l=this.mix(J,I,t);return l};var GAME_SCREEN=0;var MAIN_MENU=100;var HOW_TO_MENU=101;var CREDITS_MENU=102;var SHOWING_INTRO=200;var SHOWING_LEVEL_INFO=201;var PLAYING_GAME=203;var SHOWING_LEVEL_COMPLETE=204;var SHOWING_LEVEL_FAIL=205;var SHOWING_GAME_COMPLETE=206;var PAUSE_MENU=207;var SHOWING_GAME_OVER=208;var SAVE_DATA_MENU=209;var SOLDIER_1=0;var BOSS_1=6;var BOSS_2=7;var BOSS_3_1=8;var BOSS_3_2=9;var BOSS_4_1=10;var BOSS_4_2=11;var BOSS_5_1=12;var BOSS_5_2=13;var BOSS_5_3=14;var IDLE=0;var PATROL=1;var ATTACK=2;var VISIBLE_ATTACK=0;var SEARCHING_ATTACK=1;var STILL_PATROL=0;var LEFT_RIGHT_PATROL=1;var UP_DOWN_PATROL=2;var SQUARE_CW_PATROL=3;var SQUARE_CCW_PATROL=4;var ATTACK_STAY=0;var ATTACK_FOLLOW=1;var ATTACK_FOLLOW_NO_PATROL=3;var EXTRA_LIFE=0;var AMMO_REFILL=1;var UPGRADE=2;var LEVEL_NORMAL_PLAY=0;var LEVEL_BOSS_PLAY=1;var GREEN_PANTS=0;var RED_PANTS=1;var WHITE_PANTS=2;var BLACK_PANTS=3;var PLAYER_HEAD=0;var BLACK_HOOD=1;var GRAY_HELMET=2;var GRAY_HAT=3;var RED_HOOD=4;var GREEN_HELMET=5;var GREEN_HAT=6;var WHITE_HAT=7;var GREEN_JACKET=0;var WHITE_JACKET=1;var RIFLE=0;var GRENADES=1;var ROCKETS=2;var LARGE_STONE_PARTICLE=0;var LARGE_WOOD_PARTICLE=1;var LARGE_BLOOD_PARTICLE=2;var SMALL_STONE_PARTICLE=3;var SMALL_WOOD_PARTICLE=4;var SMALL_BLOOD_PARTICLE=5;var LARGE_WATER_PARTICLE=6;var SMALL_WATER_PARTICLE=7;var GREEN_LEAF_PARTICLE=8;var LARGE_SNOW_PARTICLE=9;var SMALL_SNOW_PARTICLE=10;var GRAY_1="#161616";var GRAY_2="#2a2a2a";var GRAY_3="#434343";var GRAY_4="#777777";var GRAY_5="#ababab";var GRAY_6="#c9c9c9";var BROWN_1="#291c05";var BROWN_2="#4d3609";var BROWN_3="#6d4c0d";var BROWN_4="#8b6110";var BROWN_5="#bf8616";var BROWN_6="#bf923b";var GREEN_1="#002200";var GREEN_2="#007d00";var GREEN_3="#00ab00";var GREEN_4="#00ff00";var GREEN_5="#3cff3c";var GREEN_6="#6dff6d";var RED_1="#760000";var RED_2="#a20000";var RED_3="#c80000";var RED_4="#ff0000";var RED_5="#ff2424";var RED_6="#ff5050";var RED_7="#ff8686";var MOUSE_AND_KEYBOARD=0;var KEYBOARD_ONLY=1;var TOUCHSCREEN=2;function WaterSurfaceAnimation(a,b){this.x=a;this.y=b;this.duration=60;this.imageDuration=this.duration/4;this.tick=0;this.done=false}WaterSurfaceAnimation.prototype.step=function(){this.tick++;if(this.tick>this.duration){this.done=true}};WaterSurfaceAnimation.prototype.paint=function(){if(!this.done){var a=Math.floor(this.tick/this.imageDuration);var b=ctx.globalAlpha;ctx.globalAlpha=Math.min(0.7,1-this.tick/this.duration);ctx.drawImage(ImageHandler.images.projectiles,a*48,64,48,48,this.x-cameraX-24,this.y-cameraY-24,48,48);ctx.globalAlpha=b}};function paintAnimatedHumanoid(n,j,b,l,d,k,m,g,h,i){if(ImageHandler.allLoaded){n=Math.round(n);j=Math.round(j);var e=ImageHandler.images.animations;if(i<32){var c=b*32+(m%2)*224;var a=112+l*32+Math.floor(m/2)*224;ctx.drawImage(ImageHandler.images.animations,c,a,32,32-i,scaleUp*(n-0.5*Tiles.tileSize-cameraX),scaleUp*(i+j-0.5*Tiles.tileSize-cameraY),scaleUp*32,scaleUp*(32-i))}var c=l*32+g*128;var a=16+(h?48:0)+k*(96+128);var o=0;var f=0;if(l==0){o=3}else{if(l==3){o=-3}}ctx.drawImage(ImageHandler.images.animations,c,a,32,48,scaleUp*(n+o-0.5*Tiles.tileSize-cameraX),scaleUp*(i+j-24-0.5*Tiles.tileSize-cameraY),scaleUp*32,scaleUp*48);c=l*16+64*d;a=0;o=0;f=0;if(l==1){f=-1}ctx.drawImage(ImageHandler.images.animations,c,a,16,16,scaleUp*(n+o-8-cameraX),scaleUp*(i+j+f-34-cameraY),scaleUp*16,scaleUp*16)}}var gradient=null;var cameraYStepSign=1;var creditsTexts=["PROGRAMMING, GRAPHICS AND MUSIC BY PER NYBLOM, SPRINGWORLDGAMES.COM","SFXS BY PER NYBLOM AND BFXR","","","THANKS TO THE FOLLOWING:","","* BFXR.NET FOR A VERY GOOD SFX GENERATOR","* DR PETTER FOR CREATING MUSAGI, DRPETTER.SE","* CHRISTOPH AT STACKOVERFLOW FOR JS MAP IMPLEMENTATION","* THE JQUERY TEAM, JQUERY.COM","* GIMP TEAM, GIMP.ORG","* DON HO, CREATOR OF NOTEPAD++",];var howToPlayTexts=["MOUSE TO AIM","","MOUSE BUTTON TO FIRE","","ASDW OR ARROWS TO MOVE","","123 TO SELECT WEAPONS. 1: GUN, 2: GRENADES, 3: MISSILES","","E AND Q TO CYCLE BETWEEN WEAPONS","","HOLD MOUSE BUTTON TO CONTROL MISSILES",];var menuItems=[{xTex:8,yTex:256,width:128,height:32,state:SHOWING_INTRO,over:false,selected:true,handler:function(){if(saveDatas.length>0){this.state=SAVE_DATA_MENU}else{this.state=SHOWING_INTRO}}},{xTex:8,yTex:224,width:285,height:32,state:HOW_TO_MENU,over:false,selected:false},{xTex:8,yTex:288,width:180,height:32,state:CREDITS_MENU,over:false,selected:false}];var pauseMenuItems=[{xTex:300,yTex:192,width:154,height:32,state:PLAYING_GAME,over:false,selected:true},{xTex:300,yTex:256,width:181,height:32,state:PLAYING_GAME,over:false,selected:false,handler:function(){player.softReset();changeLevel(currentLevel)}},{xTex:300,yTex:224,width:236,height:32,state:MAIN_MENU,over:false,selected:false}];function getStateTransitionFraction(){return 1-stateCounter/endStateCounter}function paintScrollingBackground(a){paintTilesAndObjects(levels[currentLevel],false);if(gradient==null){gradient=ctx.createLinearGradient(0,0,0,canvas.height);gradient.addColorStop(0,"rgba(0, 0, 0, 1)");gradient.addColorStop(1,"rgba(0, 0, 0, 0.4)")}ctx.fillStyle=gradient;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#ffffffff"}function paintTitle(e){var b=canvas.width;var d=canvas.height;var c=566;var f=188;var i=-c;var g=b/2-c/2;var a=e*g+(1-e)*i;ctx.drawImage(ImageHandler.images.largeText,0,0,c,f/2,a,10,c,f/2);i=c;a=e*g+(1-e)*i;ctx.drawImage(ImageHandler.images.largeText,0,f/2,c,f/2,a,120,c,f/2)}function paintGameScreen(){if(switchingState){ctx.globalAlpha=getStateTransitionFraction()}var a=canvas.width;var e=canvas.height;if(ImageHandler.allLoaded){var d=300;var c=stateCounter2/d;if(c>1){paintScrollingBackground(0)}paintTitle(Math.min(1,c))}if(Math.floor(stateCounter2/50)%3!=0){var f="CLICK OR PRESS ANY KEY TO START!";var b=f.length*8;Font.drawString(a*0.5-b*0.5,220,f)}ctx.globalAlpha=1}function paintMousePointer(){paintReticleCross(Input.mouseX,Input.mouseY,15*scaleUp,18*scaleUp,"#00ff00")}function stepGameScreen(){moveToMainMenuIfAnythingHappens(30);playTitleMusic();stateCounter2++;updateScrollingBackgroundCamera()}function updateScrollingBackgroundCamera(){var c=levels[currentLevel].height*Tiles.tileSize;var a=canvas.height/scaleUp;var b=c-a;cameraY+=cameraYStepSign;if(cameraY>b){cameraYStepSign=-1;cameraY=b}else{if(cameraY<0){cameraYStepSign=1;cameraY=0}}}function getMenuItemDimension(a,b){return[50,220+35*b,a[b].width,a[b].height]}function paintMenuItem(b,d){var e=b[d];var f=getMenuItemDimension(b,d);var a=f[0];var h=f[1];var g=e.text;if(e.selected){g="> "+g}if(e.over){}var c=ctx.globalAlpha;if(e.selected){ctx.globalAlpha=0.95}else{ctx.globalAlpha=0.5}ctx.drawImage(ImageHandler.images.largeText,e.xTex,e.yTex,e.width,e.height,a,h,e.width,e.height);ctx.globalAlpha=c}function paintMainMenu(){if(switchingState){ctx.globalAlpha=getStateTransitionFraction()}if(ImageHandler.allLoaded){paintScrollingBackground(3);paintTitle(1)}for(var a=0;a<menuItems.length;a++){paintMenuItem(menuItems,a)}ctx.globalAlpha=1}function getMouseOverItem(a){for(var b=0;b<a.length;b++){var c=a[b];var d=getMenuItemDimension(a,b);var e=Input.mouseX>=d[0]&&Input.mouseX<d[0]+d[2]&&Input.mouseY>=d[1]&&Input.mouseY<d[1]+d[3];if(e){return c}}return null}function getSelectedItem(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.selected){return c}}return null}function switchToMenuItemState(a){if(a!=null){stateCounter=0;endStateCounter=30;switchingState=true;if(a.handler){a.handler.call(a)}targetState=a.state}}function stepMenuItems(b){if(Input.keyJustPressed(Input.enterKey)){var e=getSelectedItem(b);switchToMenuItemState(e)}else{if(Input.mouseJustPressed){var e=getMouseOverItem(b);switchToMenuItemState(e)}else{var d=0;if(Input.keyJustPressed(Input.upKey)){d=-1}else{if(Input.keyJustPressed(Input.downKey)){d=1}}var a=-1;var f=-1;for(var c=0;c<b.length;c++){var e=b[c];var g=getMenuItemDimension(b,c);var h=Input.mouseX>=g[0]&&Input.mouseX<g[0]+g[2]&&Input.mouseY>=g[1]&&Input.mouseY<g[1]+g[3];if(h){f=c}e.over=h;if(e.selected){a=c}}if(f!=-1){a=f}for(var c=0;c<b.length;c++){var e=b[c];e.selected=c==a}if(a!=-1){b[a].selected=false;a+=d;if(a>=b.length){a=0}else{if(a<0){a=b.length-1}}b[a].selected=true}}}}function stepMainMenu(){stateCounter2++;playTitleMusic();if(switchingState&&targetState!=-1){transitionToState(targetState);return}else{stateCounter++}updateScrollingBackgroundCamera();stepMenuItems(menuItems)}function paintHowToMenu(){if(switchingState){ctx.globalAlpha=getStateTransitionFraction()}if(ImageHandler.allLoaded){paintScrollingBackground(3)}for(var a=0;a<howToPlayTexts.length;a++){Font.drawString(50,50+a*10,howToPlayTexts[a])}ctx.globalAlpha=1}function stepHowToMenu(){stateCounter2++;moveToMainMenuIfAnythingHappens(20);updateScrollingBackgroundCamera()}function paintCreditsMenu(){if(switchingState){ctx.globalAlpha=getStateTransitionFraction()}if(ImageHandler.allLoaded){paintScrollingBackground(0)}for(var a=0;a<creditsTexts.length;a++){Font.drawString(50,50+a*10,creditsTexts[a])}ctx.globalAlpha=1}function stepCreditsMenu(){stateCounter2++;moveToMainMenuIfAnythingHappens(20);updateScrollingBackgroundCamera()}function paintPauseMenu(){if(switchingState){ctx.globalAlpha=getStateTransitionFraction()}Font.drawString(10,10,"PAUSED...");for(var a=0;a<pauseMenuItems.length;a++){paintMenuItem(pauseMenuItems,a)}ctx.globalAlpha=1}function stepPauseMenu(){if(Input.keyJustPressed(Input.escapeKey)){state=PLAYING_GAME}if(switchingState&&targetState!=-1){transitionToState(targetState);return}else{stateCounter++}stepMenuItems(pauseMenuItems)}function moveToMainMenuIfAnythingHappens(a){if(switchingState){transitionToState(MAIN_MENU)}else{if(stateCounter>50&&(Input.anyKeyJustPressed()||Input.mouseJustPressed)){stateCounter=0;endStateCounter=a;switchingState=true}else{stateCounter++}}}function TextButton(b,e,c,a,d){this.x=b;this.y=e;this.text=d;this.width=c;this.height=a;this.hover=false;this.pressed=false;this.clicked=false;this.handler=null}TextButton.prototype.paint=function(){ctx.lineWidth=3;if(this.pressed){ctx.strokeStyle="#ababab";ctx.fillStyle="#ffff00"}else{if(this.hover){ctx.strokeStyle="#ababab";ctx.fillStyle="#b9b900"}else{ctx.strokeStyle="#777777";ctx.fillStyle="#595959"}}ctx.fillRect(this.x,this.y,this.width,this.height);ctx.strokeRect(this.x,this.y,this.width,this.height);var a=this.text.length*8;Font.drawString(this.x+0.5*(this.width-a),this.y+0.5*(this.height-8),this.text)};TextButton.prototype.step=function(){this.clicked=this.pressed&&!Input.mouseDown;this.hover=rectContains(this.getRect(),[Input.mouseX,Input.mouseY]);this.pressed=this.hover&&Input.mouseDown;if(this.clicked&&this.handler!=null){this.handler.call(this)}};TextButton.prototype.getRect=function(){return[this.x,this.y,this.width,this.height]};function StepButton(a,d,c,b){this.x=a;this.y=d;this.width=26;this.height=26;this.inc=c;this.property=b;this.hover=false;this.pressed=false;this.clicked=false}StepButton.prototype.paint=function(){var a=10;if(this.inc==-1){a=9}var c=6;if(this.hover){c=8}if(this.pressed){c=7}var b=ImageHandler.images.tilesBackground;ctx.drawImage(b,a*32+3,c*32+3,this.width,this.height,this.x,this.y,this.width,this.height)};StepButton.prototype.getRect=function(){return[this.x,this.y,this.width,this.height]};StepButton.prototype.step=function(){this.clicked=this.pressed&&!Input.mouseDown;this.hover=rectContains(this.getRect(),[Input.mouseX,Input.mouseY]);this.pressed=this.hover&&Input.mouseDown};function UpgradeComponent(a,f,c,e,d,b){this.x=a;this.y=f;this.steps=c;this.text=e;this.property=d;this.pointsSpent=0;this.panel=b;this.buttons=[]}UpgradeComponent.prototype.performUpgrade=function(){player[this.property]=player[this.property]+this.pointsSpent;player.securedUpgrades-=this.pointsSpent};UpgradeComponent.prototype.reset=function(){this.pointsSpent=0};UpgradeComponent.prototype.paint=function(){var d=player[this.property];var e=ImageHandler.images.tilesBackground;Font.drawString(this.x,this.y+12,this.text);var c=146;if(ImageHandler.allLoaded){ctx.drawImage(e,7*32,6*32,8,32,this.x+c,this.y,8,32);var a=this.x+c+8;for(var b=0;b<this.steps;b++){ctx.drawImage(e,7*32+8,6*32,16,32,a,this.y,16,32);if(b<d){ctx.drawImage(e,8*32+8,6*32,16,32,a,this.y,16,32)}else{if(b<d+this.pointsSpent){ctx.drawImage(e,8*32+8,8*32,16,32,a,this.y,16,32)}else{ctx.drawImage(e,8*32+8,7*32,16,32,a,this.y,16,32)}}a+=16}ctx.drawImage(e,7*32+24,6*32,8,32,a,this.y,8,32);a+=12;if(this.buttons.length==0){this.buttons.push(new StepButton(a,this.y+3,-1,this.property));a+=32;this.buttons.push(new StepButton(a,this.y+3,1,this.property))}for(var b=0;b<this.buttons.length;b++){this.buttons[b].paint()}}};UpgradeComponent.prototype.step=function(){var c=player[this.property];for(var b=0;b<this.buttons.length;b++){var a=this.buttons[b];a.step();if(a.clicked){if(a.inc==-1&&this.pointsSpent>0){this.pointsSpent--}else{if(a.inc==1&&this.pointsSpent<this.panel.pointsToSpend&&this.pointsSpent+c<this.steps){this.pointsSpent++}}}}};function UpgradePanel(h,f){this.x=h;this.y=f;this.components=[];var e=130;var j=32;this.continueButton=new TextButton(canvas.width-e-10-68,canvas.height-j-10,e,j,"CONTINUE");var a=0;var b=this;var g=5;var i=30;var c=300;var k=10;var d=2;this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"MAX HEALTH","maxHealthUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"EXTRA GRENADES","maxGrenadesUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"EXTRA ROCKETS","maxRocketsUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"RIFLE DAMAGE","gunDamageUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"GRENADE DAMAGE","grenadeDamageUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"ROCKET DAMAGE","rocketDamageUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"RIFLE FIRE RATE","gunReloadTimeUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"GRENADE FIRE RATE","grenadeReloadTimeUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"ROCKET FIRE RATE","rocketReloadTimeUpgrades",b));this.components.push(new UpgradeComponent(h+Math.floor(a/k)*c,f+i*(a++),g,"GRENADE RANGE","grenadeMaxRangeUpgrades",b));this.reset()}UpgradePanel.prototype.performUpgrade=function(){for(var a=0;a<this.components.length;a++){this.components[a].performUpgrade()}};UpgradePanel.prototype.reset=function(){this.pointsToSpend=player.securedUpgrades;for(var a=0;a<this.components.length;a++){this.components[a].reset()}};UpgradePanel.prototype.step=function(){this.pointsToSpend=player.securedUpgrades;var a=[];for(var c=0;c<this.components.length;c++){var b=this.components[c];a[c]=b.pointsSpent;b.step()}for(var c=0;c<this.components.length;c++){var b=this.components[c];this.pointsToSpend-=b.pointsSpent}if(this.pointsToSpend<0){this.pointsToSpend=player.securedUpgrades;for(var c=0;c<this.components.length;c++){var b=this.components[c];b.pointsSpent=a[c];this.pointsToSpend-=b.pointsSpent}}this.continueButton.step()};UpgradePanel.prototype.paint=function(){for(var a=0;a<this.components.length;a++){this.components[a].paint()}this.continueButton.paint()};function TextAnimation(a,d,c,b){this.x=a;this.y=d;this.text=c;this.duration=b;this.delay=0;this.initDuration=b}TextAnimation.prototype.step=function(){if(this.delay>0){this.delay--}else{this.duration--}};TextAnimation.prototype.paint=function(){};function PlayerConnectedTextAnimation(a,c,b){TextAnimation.call(this,player.x,player.y-20,c,b);this.type=a}PlayerConnectedTextAnimation.prototype=new TextAnimation();PlayerConnectedTextAnimation.prototype.paint=function(){if(this.delay<=0){switch(this.type){case 0:var a=1-this.duration/this.initDuration;Font.drawString(scaleUp*(player.x-this.text.length*4-cameraX),scaleUp*(player.y-20-a*40-cameraY),this.text);break;case 1:if(Math.floor(this.duration/10)%2==0){Font.drawString(scaleUp*(player.x-this.text.length*4-cameraX),scaleUp*(player.y-50-cameraY),this.text)}break;case 2:break}}};function PointsTextAnimation(a,e,d,c,b){TextAnimation.call(this,a,e,c,b);this.z=d}PointsTextAnimation.prototype=new TextAnimation();PointsTextAnimation.prototype.paint=function(){if(this.delay<=0){var b=1-this.duration/this.initDuration;var a=ctx.globalAlpha;ctx.globalAlpha=1-b*b;var d=scaleUp*(this.x-this.text.length*4-cameraX);var c=scaleUp*(this.y-this.z-b*10-cameraY);c=Math.max(scaleUp*40,Math.min(c,canvas.height-scaleUp*this.text.length*8));Font.drawString(d,c,this.text);ctx.globalAlpha=a}};function Map(a){this.current=undefined;this.size=0;this.isLinked=true;if(a===false){this.disableLinking()}}Map.from=function(d,a,c){var b=new Map(c);for(var e in d){if(a||d.hasOwnProperty(e)){b.put(e,d[e])}}return b};Map.noop=function(){return this};Map.illegal=function(){throw new Error("can't do this with unlinked maps")};Map.prototype.disableLinking=function(){this.isLinked=false;this.link=Map.noop;this.unlink=Map.noop;this.disableLinking=Map.noop;this.next=Map.illegal;this.key=Map.illegal;this.value=Map.illegal;this.removeAll=Map.illegal;this.each=Map.illegal;this.flip=Map.illegal;this.drop=Map.illegal;this.listKeys=Map.illegal;this.listValues=Map.illegal;return this};Map.prototype.hash=function(a){return a instanceof Object?(a.__hash||(a.__hash="object "+ ++arguments.callee.current)):(typeof a)+" "+String(a)};Map.prototype.hash.current=0;Map.prototype.link=function(a){if(this.size===0){a.prev=a;a.next=a;this.current=a}else{a.prev=this.current.prev;a.prev.next=a;a.next=this.current;this.current.prev=a}};Map.prototype.unlink=function(a){if(this.size===0){this.current=undefined}else{a.prev.next=a.next;a.next.prev=a.prev;if(a===this.current){this.current=a.next}}};Map.prototype.get=function(a){var b=this[this.hash(a)];return typeof b==="undefined"?undefined:b.value};Map.prototype.put=function(a,c){var d=this.hash(a);if(this.hasOwnProperty(d)){this[d].value=c}else{var b={key:a,value:c};this[d]=b;this.link(b);++this.size}return this};Map.prototype.remove=function(a){var b=this.hash(a);if(this.hasOwnProperty(b)){--this.size;this.unlink(this[b]);delete this[b]}return this};Map.prototype.removeAll=function(){while(this.size){this.remove(this.key())}return this};Map.prototype.contains=function(a){return this.hasOwnProperty(this.hash(a))};Map.prototype.isUndefined=function(a){var b=this.hash(a);return this.hasOwnProperty(b)?typeof this[b]==="undefined":false};Map.prototype.next=function(){this.current=this.current.next};Map.prototype.key=function(){return this.current.key};Map.prototype.value=function(){return this.current.value};Map.prototype.each=function(c,a){if(typeof a==="undefined"){a=this}for(var b=this.size;b--;this.next()){var d=c.call(a,this.key(),this.value(),b>0);if(typeof d==="number"){b+=d}}return this};Map.prototype.flip=function(e){var d=new Map(e);for(var a=this.size;a--;this.next()){var c=this.value(),b=d.get(c);if(b){b.push(this.key())}else{d.put(c,[this.key()])}}return d};Map.prototype.drop=function(c,a){if(typeof a==="undefined"){a=this}for(var b=this.size;b--;){if(c.call(a,this.key(),this.value())){this.remove(this.key());--b}else{this.next()}}return this};Map.prototype.listValues=function(){var b=[];for(var a=this.size;a--;this.next()){b.push(this.value())}return b};Map.prototype.listKeys=function(){var b=[];for(var a=this.size;a--;this.next()){b.push(this.key())}return b};Map.prototype.toString=function(){var a="[object Map";function b(d,e,c){a+="    { "+this.hash(d)+" : "+e+" }"+(c?",":"")+"\n"}if(this.isLinked&&this.size){a+="\n";this.each(b)}a+="]";return a};Map.reverseIndexTableFrom=function(g,f){var e=new Map(f);for(var b=0,a=g.length;b<a;++b){var c=g[b],d=e.get(c);if(d){d.push(b)}else{e.put(c,[b])}}return e};Map.cross=function(h,g,e,b){var f,a;if(h.isLinked){f=h;a=g}else{if(g.isLinked){f=g;a=h}else{Map.illegal()}}for(var d=f.size;d--;f.next()){var c=f.key();if(a.contains(c)){e.call(b,c,h.get(c),g.get(c))}}return b};Map.uniqueArray=function(d){var c=new Map;for(var b=0,a=d.length;b<a;++b){c.put(d[b])}return c.listKeys()};var upgradeComponent=null;var helpMessage1=["USE THE KEYS A, S, D, W TO MOVE","AIM WITH THE MOUSE","FIRE THE WEAPON WITH LEFT MOUSE BUTTON","KEYS 1, 2 AND 3 SWITCH WEAPONS","CYCLE WEAPONS WITH Q, E AND RIGHT MOUSE BUTTON"];var helpMessage2=["PRESS 1 TO SELECT THE RIFLE AS WEAPON","YOU HAVE AN UNLIMITED SUPPLY OF BULLETS"];var helpMessage3=["USE GRENADES TO REACH ENEMIES BEHIND OBSTACLES","PRESS 2 TO SELECT GRENADES AS WEAPON"];var helpMessage4=["ROCKETS GIVE MORE DAMAGE AND YOU CAN STEER THEM","PRESS 3 TO SELECT THE ROCKET LAUNCHER AS WEAPON"];var controlButton=null;var soundButton=null;function createControlAndSoundButtonsIfNeccessary(){if(controlButton==null){controlButton={x:canvas.width-64*scaleUp,y:canvas.height-scaleUp*(10+32),over:false};soundButton={x:canvas.width-32*scaleUp,y:canvas.height-scaleUp*(10+32),over:false}}}function paintControlAndSoundButtons(){createControlAndSoundButtonsIfNeccessary();if(controlButton.over){ctx.strokeStyle="#ffffff";ctx.lineWidth=2;ctx.strokeRect(controlButton.x,controlButton.y,32*scaleUp,32*scaleUp)}ctx.drawImage(ImageHandler.images.tilesBackground,352+controlMode*32,224,32,32,controlButton.x,controlButton.y,32*scaleUp,32*scaleUp);if(soundButton.over){ctx.strokeStyle="#ffffff";ctx.lineWidth=2;ctx.strokeRect(soundButton.x,soundButton.y,32*scaleUp,32*scaleUp)}ctx.drawImage(ImageHandler.images.tilesBackground,352,192,32,32,soundButton.x,soundButton.y,32*scaleUp,32*scaleUp);if(Sound.mute){ctx.drawImage(ImageHandler.images.tilesBackground,384,192,32,32,soundButton.x,soundButton.y,32*scaleUp,32*scaleUp)}}function stepControlAndSoundButtons(){createControlAndSoundButtonsIfNeccessary();controlButton.over=rectContains([controlButton.x,controlButton.y,32,32],[Input.mouseX,Input.mouseY]);if(controlButton.over&&Input.mouseJustPressed){controlMode=(controlMode+1)%2}soundButton.over=rectContains([soundButton.x,soundButton.y,32,32],[Input.mouseX,Input.mouseY]);if(soundButton.over&&Input.mouseJustPressed){if(Sound.mute){Sound.unMuteSound()}else{Sound.muteSound()}}}var finalScene={counter:0,counter2:0,boatState:0,boatX:-100,boatY:200,boatVx:0.1,boatVy:0,surfaceAnimations:[],waterParticles:[],texts:["MISSION COMPLETE!","","","THE WORLD IS NOW SLIGHTLY LESS DANGEROUS","AND OUR HERO IS HAPPY FOR THE LUXURIOUS RIDE BACK TO BASE","","","","","","","","THANKS FOR PLAYING NORTHERN RETREAT","","PROGRAMMING, DESIGN, GRAPHICS AND MUSIC BY PER NYBLOM","SPRINGWORLDGAMES.COM"],reset:function(){this.counter=0;this.counter2=0;this.boatX=-100;this.boatY=200;particles.length=0;this.waterParticles.length=0;this.surfaceAnimations.length=0},step:function(){cameraX=0;cameraY=0;this.boatX+=this.boatVx;this.boatY+=this.boatVy;this.boatVx*=0.997;this.boatVy*=0.997;stepAndRemove(particles,levels[0]);stepAndRemove(this.waterParticles,levels[0]);if(this.counter2==200){this.boatState=0}else{if(this.counter2==400){this.boatState=1;this.boatVx+=0.2;this.counter2=0;var h=new WaterSurfaceParticle(this.boatX+40,this.boatY,-1,0,80+80*Math.random());addParticle(h);h=new WaterSurfaceParticle(this.boatX+40,this.boatY+70,-1,0,80+80*Math.random());addParticle(h)}}var k=Math.max(1,Math.round(10-this.boatVx*5));if(this.counter%k==0){var g=1+Math.round(Math.random()*this.boatVx*5);for(var e=0;e<g;e++){var c=Math.random()*7;var f=new NonGasParticle(this.boatX+78+c,this.boatY+60-c,0,Math.random()*this.boatVx,0,4*this.boatVx*(1+Math.random()*1),Math.floor(10+Math.random()*10),SMALL_WATER_PARTICLE,Math.floor(Math.random()*4));this.waterParticles.push(f)}}if(this.counter%30==0){var h=new WaterSurfaceParticle(this.boatX+10+Math.random()*40,this.boatY+30+30*Math.random(),0,0,80+80*Math.random());addParticle(h)}if(this.counter%10==0){for(var e=0;e<32;e++){for(var d=0;d<14;d++){if(Math.random()<0.04){var m=(e+Math.random())*Tiles.tileSize;var l=(d+Math.random())*Tiles.tileSize;var b=30+Math.random()*70;var n=Math.round(Math.random()*2+1);var a=new WaterGlimmerParticle(m,l,0,0,0,0,b,0.5+0.5*Math.random(),n);addParticle(a)}}}}this.counter++;this.counter2++},paint:function(){ctx.globalAlpha=1;ctx.fillStyle="#5252ff";ctx.fillRect(0,0,canvas.width,canvas.height);if(this.gradient==null){this.gradient=ctx.createLinearGradient(0,0,0,canvas.height);this.gradient.addColorStop(0,"rgba(1, 1, 1, 0.0)");this.gradient.addColorStop(1,"rgba(1, 1, 1, 0.8)")}ctx.fillStyle=this.gradient;ctx.fillRect(0,0,canvas.width,canvas.height);for(var b=0;b<particles.length;b++){var e=particles[b];if(e!=null){e.paint()}}ctx.drawImage(ImageHandler.images.projectiles,64+this.boatState*96,176,96,80,this.boatX,this.boatY,96,80);for(var b=0;b<this.waterParticles.length;b++){var e=this.waterParticles[b];if(e!=null){e.paint()}}for(var b=0;b<this.texts.length;b++){var d=this.texts[b];if(d.length>0){var c=8*d.length;var a=Math.round(0.5*(canvas.width-c));Font.drawString(a,Math.round(canvas.height-this.counter*0.12+b*10),d)}}}};var gameCompleteAnimationSteps=350;function stepShowingGameComplete(a){if(stateCounter<gameCompleteAnimationSteps){stepWithSlowdown(a,30,gameCompleteAnimationSteps,-1)}else{if(finalScene.boatX>canvas.width+100||(stateCounter>200&&(Input.keyJustPressed(Input.enterKey)||Input.keyJustPressed(Input.escapeKey)))){currentLevel=0;changeLevel(currentLevel);player.hardReset();state=GAME_SCREEN;finalScene.reset()}finalScene.step()}stateCounter++}function paintShowingGameComplete(b){if(stateCounter<gameCompleteAnimationSteps){paintPlayingGame(b);paintFadeOut(0,100,0.3,"#ffffff");var a=stateCounter/30;paintLargeTextAnimation(a,8,384,254,32,0)}else{finalScene.paint()}}function stepShowingIntro(a){if(stateCounter>50&&Input.anyKeyJustPressed()||Input.mouseJustPressed){state=PLAYING_GAME;stateCounter=0;player.hardReset()}cameraY=a.height*Tiles.tileSize-360;stepLevel();stateCounter++}function paintShowingIntro(e){paintPlayingGame(e);paintFadeIn(0,1200,0.95,0.5,"#000000");var b=Math.min(1,stateCounter/30);var d=-178;var c=0.5*(canvas.width-178);var a=b*c+(1-b)*d;ctx.drawImage(ImageHandler.images.todo,a,50);paintPressAnyKey(0.9)}function stepShowingLevelInfo(){if(Input.anyKeyJustPressed()||Input.mouseJustPressed){state=PLAYING_GAME;stateCounter=0}}function paintShowingLevelInfo(){Font.drawString(10,10,"LEVEL INFO FOR LEVEL "+(currentLevel+1)+" GOES HERE...")}function createUpgradeComponentIfNecessary(){if(upgradeComponent==null){upgradeComponent=new UpgradePanel(10,50)}}function playTitleMusic(){if(Sound.isPlaying(Sound.BOSS_MUSIC_ID)){Sound.stop(Sound.BOSS_MUSIC_ID)}if(!Sound.isPlaying(Sound.TITLE_MUSIC_ID)){Sound.play(Sound.TITLE_MUSIC_ID)}}function playBossMusic(){if(!Sound.isPlaying(Sound.BOSS_MUSIC_ID)){Sound.play(Sound.BOSS_MUSIC_ID)}if(Sound.isPlaying(Sound.TITLE_MUSIC_ID)){Sound.stop(Sound.TITLE_MUSIC_ID)}}function playLevelComplete(){playTitleMusic();Sound.play(Sound.FANFARE_MUSIC_ID)}function playFailure(){if(Sound.isPlaying(Sound.TITLE_MUSIC_ID)){Sound.stop(Sound.TITLE_MUSIC_ID)}if(Sound.isPlaying(Sound.BOSS_MUSIC_ID)){Sound.stop(Sound.BOSS_MUSIC_ID)}Sound.play(Sound.SAD_MUSIC_ID)}function stopBossMusic(){if(Sound.isPlaying(Sound.BOSS_MUSIC_ID)){Sound.stop(Sound.BOSS_MUSIC_ID)}}var levelCompleteAnimationSteps=350;function stepShowingLevelComplete(a){if(stateCounter<levelCompleteAnimationSteps){stepWithSlowdown(a,30,levelCompleteAnimationSteps,-1)}else{createUpgradeComponentIfNecessary();if(upgradeComponent.continueButton.clicked){upgradeComponent.performUpgrade();currentLevel++;changeLevel(currentLevel);player.softReset();state=PLAYING_GAME;stateCounter=0}updateScrollingBackgroundCamera();playTitleMusic();upgradeComponent.step()}stateCounter2++;stateCounter++}function paintShowingLevelComplete(b){if(stateCounter<levelCompleteAnimationSteps){paintPlayingGame(b);paintFadeOut(0,100,0.3,"#ffffff");var a=stateCounter/30;paintLargeTextAnimation(a,8,416,382,32,0)}else{createUpgradeComponentIfNecessary();paintScrollingBackground(0);Font.drawString(10,10,"LEVEL "+(currentLevel+1)+" COMPLETE!!!");Font.drawString(10,10+2*10*scaleUp,"UPGRADE POINTS LEFT: "+upgradeComponent.pointsToSpend);upgradeComponent.paint()}}function paintLargeTextAnimation(k,e,c,h,a,g){switch(g){case 0:var i=Math.min(1,k);var d=-h;var j=0.5*(canvas.width-h);var b=j*i+d*(1-i);var f=canvas.height*0.3;ctx.drawImage(ImageHandler.images.largeText,e,c,h,a,b,f,h,a);break}}function paintPressAnyKey(b){var a="CLICK OR PRESS ANY KEY TO CONTINUE";var c=a.length*8;Font.drawString(0.5*(canvas.width-c),canvas.height*b,a)}function paintFadeOut(c,b,d,a){if(stateCounter>=c){ctx.globalAlpha=Math.min(d,Math.max(0,(stateCounter-c)/b));ctx.fillStyle=a;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.globalAlpha=1}}function paintFadeIn(d,b,e,c,a){if(stateCounter>=d){ctx.globalAlpha=Math.min(e,Math.max(c,1-(stateCounter-d)/b))}else{ctx.globalAlpha=1}ctx.fillStyle=a;ctx.fillRect(0,0,canvas.width,canvas.height);ctx.globalAlpha=1}function stepWithSlowdown(e,c,b,a){var d=Math.max(1,Math.floor(stateCounter/c));if((stateCounter%d)==0&&stateCounter<b){stepPlayer(e);stepLevel();cameraY+=a}}function stepShowingLevelFail(a){if(stateCounter>50&&(Input.anyKeyJustPressed()||Input.mouseJustPressed)){player.softReset();changeLevel(currentLevel);state=PLAYING_GAME;stateCounter=0}stepWithSlowdown(a,30,200,-1);stateCounter++}function paintShowingLevelFail(b){paintPlayingGame(b);paintFadeOut(0,100,0.9,"#000000");var a=stateCounter/30;paintLargeTextAnimation(a,8,352,180,32,0);paintPressAnyKey(0.7)}function stepShowingGameOver(a){if(stateCounter>50&&(Input.anyKeyJustPressed()||Input.mouseJustPressed)){player.hardReset();changeLevel(0);state=GAME_SCREEN}stepWithSlowdown(a,30,200,-1);stateCounter++}function paintShowingGameOver(b){paintPlayingGame(b);paintFadeOut(0,300,0.7,"#ffffff");var a=stateCounter/50;paintLargeTextAnimation(a,8,320,234,32,0);paintPressAnyKey(0.7)}function stepPlayingGame(d){stateCounter++;updateCamera(d);stepPlayer(d);stepLevel();if(player.health<=0){stateCounter=0;state=SHOWING_LEVEL_FAIL;playFailure()}if(state==PLAYING_GAME){switch(levelMode){case LEVEL_NORMAL_PLAY:var b=false;for(var a=0;a<bosses.length;a++){if(bosses[a].state==ATTACK){b=true}}if(b){playBossMusic();levelMode=LEVEL_BOSS_PLAY}break;case LEVEL_BOSS_PLAY:playBossMusic();break}}if(Input.keyJustPressed(Input.escapeKey)){state=PAUSE_MENU;stateCounter=0}var c=true;if(bosses.length>0){for(var a=0;a<bosses.length;a++){if(bosses[a].alive){c=false;break}}}else{for(var a=0;a<enemies.length;a++){if(enemies[a].alive){c=false;break}}}if(c){if(currentLevel<levels.length-1){state=SHOWING_LEVEL_COMPLETE;player.levelComplete();createUpgradeComponentIfNecessary();upgradeComponent.reset();playLevelComplete();stateCounter=0;addSaveData(new SaveData(currentLevel+1,player.getTotalUpgrades(),player.securedPoints))}else{state=SHOWING_GAME_COMPLETE;player.levelComplete();playLevelComplete();stateCounter=0}}}function paintPlayingGame(c){if(ImageHandler.allLoaded){paintTilesAndObjects(c,true);if(state==PLAYING_GAME){paintReticle(c)}for(var a=0;a<textAnimations.length;a++){var b=textAnimations[a];if(b!=null){b.paint()}}paintInterface(c)}}function storeEntityYPos(c,d){for(var b=0;b<d.length;b++){var a=d[b];if(a!=null){var e=Math.floor(a.y/Tiles.tileSize);if(e>=0){if(c[e]==null){c[e]=[]}c[e].push(a)}}}}function paintComplexTile(i,o,g,f,p){var l=o.surfaceTile;var k=Tiles.tileSize;var d=Tiles.tileSize*scaleUp;var q=k/2;var r=false;var b=false;var a=false;var n=false;var e=false;var c=null;var m=null;var h=null;var j=null;if(l!=-1){i.drawImage(o.backgroundImage,0,(6+o.surfaceTile)*k,k,k,scaleUp*(g*k-cameraX),scaleUp*(f*k-cameraY),d,d);r=true}if(g>0){c=p[g-1][f];if(c.surfaceTile!=-1&&(l==-1||(c.surfaceTile!=l))){i.drawImage(o.backgroundImage,k,(6+c.surfaceTile)*k,q,k,scaleUp*(g*k-cameraX),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*k);b=true}}if(g<p.length-1){m=p[g+1][f];if(m.surfaceTile!=-1&&(l==-1||(m.surfaceTile!=l))){i.drawImage(o.backgroundImage,k+k/2,(6+m.surfaceTile)*k,q,k,scaleUp*(g*k+q-cameraX),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*k);a=true}}if(f>0){h=p[g][f-1];if(h.surfaceTile!=-1&&(l==-1||(h.surfaceTile!=l))){i.drawImage(o.backgroundImage,k*2,(6+h.surfaceTile)*k,k,q,scaleUp*(g*k-cameraX),scaleUp*(f*k-cameraY),scaleUp*k,scaleUp*q);n=true}}if(f<p[0].length-1){j=p[g][f+1];if(j.surfaceTile!=-1&&(l==-1||(j.surfaceTile!=l))){i.drawImage(o.backgroundImage,k*2,(6+j.surfaceTile)*k+q,k,q,scaleUp*(g*k-cameraX),scaleUp*(f*k+q-cameraY),scaleUp*k,scaleUp*q);e=true}}if(n&&b){i.drawImage(o.backgroundImage,k*4,(6+c.surfaceTile)*k,q,q,scaleUp*(g*k-cameraX),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*q)}if(n&&a){i.drawImage(o.backgroundImage,k*4+q,(6+h.surfaceTile)*k,q,q,scaleUp*(g*k-cameraX+q),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*q)}if(e&&a){i.drawImage(o.backgroundImage,k*4+q,(6+j.surfaceTile)*k+q,q,q,scaleUp*(g*k+q-cameraX),scaleUp*(f*k+q-cameraY),scaleUp*q,scaleUp*q)}if(e&&b){i.drawImage(o.backgroundImage,k*4,(6+j.surfaceTile)*k+q,q,q,scaleUp*(g*k-cameraX),scaleUp*(f*k+q-cameraY),scaleUp*q,scaleUp*q)}if(l==-1){if(c!=null&&h!=null&&c.surfaceTile==-1&&h.surfaceTile==-1){var s=p[g-1][f-1];if(s.surfaceTile!=-1){i.drawImage(s.backgroundImage,k*3,(6+s.surfaceTile)*k,q,q,scaleUp*(g*k-cameraX),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*q)}}if(m!=null&&h!=null&&m.surfaceTile==-1&&h.surfaceTile==-1){var s=p[g+1][f-1];if(s.surfaceTile!=-1){i.drawImage(s.backgroundImage,k*3+q,(6+s.surfaceTile)*k,q,q,scaleUp*(g*k+q-cameraX),scaleUp*(f*k-cameraY),scaleUp*q,scaleUp*q)}}if(m!=null&&j!=null&&m.surfaceTile==-1&&j.surfaceTile==-1){var s=p[g+1][f+1];if(s.surfaceTile!=-1){i.drawImage(s.backgroundImage,k*3+q,(6+s.surfaceTile)*k+q,q,q,scaleUp*(g*k+q-cameraX),scaleUp*(f*k+q-cameraY),scaleUp*q,scaleUp*q)}}if(c!=null&&j!=null&&c.surfaceTile==-1&&j.surfaceTile==-1){var s=p[g-1][f+1];if(s.surfaceTile!=-1){i.drawImage(s.backgroundImage,k*3,(6+s.surfaceTile)*k+q,q,q,scaleUp*(g*k-cameraX),scaleUp*(f*k+q-cameraY),scaleUp*q,scaleUp*q)}}}}function paintWall(i,h,g){var a=i[h][g];var j=Tiles.tileSize;var d=true;var e=true;var k=true;var b=true;if(h>0){var f=i[h-1][g];d=f.specialSolidObjectId==0}if(g>0){var f=i[h][g-1];e=f.specialSolidObjectId==0}if(g<i[0].length-1){var f=i[h][g+1];b=f.specialSolidObjectId==0}if(h<i.length-1){var f=i[h+1][g];k=f.specialSolidObjectId==0}var c=false;if((d&&k)||(!e&&!b)){ctx.drawImage(a.solidObjectImage,8*j,2*j,j,j*2,scaleUp*(j*h-cameraX),scaleUp*(j*(g-1)-cameraY),scaleUp*j,scaleUp*2*j);c=true}if(b){ctx.drawImage(a.solidObjectImage,7*j+j/4,2*j,j/2,j*2,scaleUp*(j*h+j/4-cameraX),scaleUp*(j*(g-1)-cameraY),scaleUp*j/2,scaleUp*2*j)}else{if(e){ctx.drawImage(a.solidObjectImage,6*j+j/4,2*j,j/2,j*2,scaleUp*(j*h+j/4-cameraX),scaleUp*(j*(g-1)-cameraY),scaleUp*j/2,scaleUp*2*j)}}if(!c&&(e||b)){if(d){ctx.drawImage(a.solidObjectImage,8*j,2*j,j/4,j*2,scaleUp*(j*h-cameraX),scaleUp*(j*(g-1)-cameraY),scaleUp*j/4,scaleUp*2*j)}if(k){ctx.drawImage(a.solidObjectImage,8.75*j,2*j,j/4,j*2,scaleUp*(j*h+3/4*j-cameraX),scaleUp*(j*(g-1)-cameraY),scaleUp*j/4,scaleUp*2*j)}}}function paintTilesAndObjects(b,d){var F=b.gridInfos;var r=32;var e=r*scaleUp;var k=F.length;var f=F[0].length;var E=Math.max(0,Math.floor(cameraY/Tiles.tileSize));var B=Math.min(b.height,2+(cameraY+canvas.height)/Tiles.tileSize);if(!b.backgroundImage){var m=document.createElement("canvas");b.backgroundImage=m;m.width=F.length*Tiles.tileSize;m.height=b.height*Tiles.tileSize;var t=m.getContext("2d");var l=cameraX;var j=cameraY;cameraX=0;cameraY=0;for(var o=0;o<F.length;o++){var a=F[o];for(var n=0;n<b.height;n++){var A=a[n];t.drawImage(A.backgroundImage,A.backgroundCellX*r,A.backgroundCellY*r,r,r,scaleUp*(o*r-cameraX),scaleUp*(n*r-cameraY),e,e);paintComplexTile(t,A,o,n,F);if(A.decorationCellX!=-1&&!A.containsPickup){t.drawImage(A.decorationImage,A.decorationCellX*r,A.decorationCellY*r,r,r,scaleUp*(o*r-cameraX),scaleUp*(n*r-cameraY),e,e)}}}cameraX=l;cameryY=j}ctx.drawImage(b.backgroundImage,-cameraX,-cameraY);if(false){}var w=Math.floor(player.y/Tiles.tileSize);var v=false;var u=[];for(var n=E;n<B;n++){u[n]=null}if(d){storeEntityYPos(u,pickups);storeEntityYPos(u,projectiles);storeEntityYPos(u,enemies);storeEntityYPos(u,particles)}for(var n=E;n<B;n++){for(var o=0;o<k;o++){var a=F[o];var A=a[n];if(A.solidObjectCellX!=-1){var c=A.solidObjectHeight*r;var s=A.solidObjectWidth*r;if(c>0&&s>0){var q=r*(o-A.solidObjectCenterOffsetX);var p=r*(n-A.solidObjectHeight+1+A.solidObjectCenterOffsetY);var h=s*scaleUp;var g=c*scaleUp;if(A.specialSolidObjectId==-1){ctx.drawImage(A.solidObjectImage,A.solidObjectCellX*r,A.solidObjectCellY*r,s,c,scaleUp*(q-cameraX),scaleUp*(p-cameraY),h,g)}else{if(A.specialSolidObjectId==0){paintWall(F,o,n)}}}}}var D=u[n];if(D!=null){for(var z=0;z<D.length;z++){var C=D[z];C.paint()}}if(d&&!v&&w==n){paintPlayer(b);v=true}}if(!v&&d){paintPlayer(b)}}var cameraYOffsetFactor=0.7;function updateCamera(a){var c=canvas.width/scaleUp;var j=canvas.height/scaleUp;var g=c/Tiles.tileSize;var k=j/Tiles.tileSize;var e=c*0.5;var i=j*0.5;var b=a.width*Tiles.tileSize;var h=a.height*Tiles.tileSize;var f=0.03;var d=0.75;if(controlMode==MOUSE_AND_KEYBOARD){if(Input.mouseY+(cameraY+50)*scaleUp<player.y*scaleUp){cameraAbove=true}else{if(Input.mouseY+(cameraY-50)*scaleUp>player.y*scaleUp){cameraAbove=false}}}else{if(controlMode==KEYBOARD_ONLY){if(player.aimDirection[1]>0.1){cameraAbove=false}else{if(player.aimDirection[1]<-0.1){cameraAbove=true}}d=0.6;f=0.01}}if(cameraAbove){cameraYOffsetFactor=(1-f)*cameraYOffsetFactor+f*d}else{cameraYOffsetFactor=(1-f)*cameraYOffsetFactor+f*(1-d)}cameraX=Math.round(Math.max(0,Math.min(b-c,player.x-e)));cameraY=Math.round(Math.max(0,Math.min(h-j,player.y-j*cameraYOffsetFactor)))}function paintInterface(a){if(ImageHandler.allLoaded){var h=Tiles.tileSize;var d=h*scaleUp;var p=0;var l=player.securedUpgrades+player.gatheredUpgrades;var g=Math.ceil(l/10);for(var q=0;q<l;q++){var m=Math.floor(q/10);var c=q%10;ctx.drawImage(ImageHandler.images.tilesBackground,h*5,h*5,h,h,0.75*d*c,p+m*d,d,d)}p+=g*d;for(var q=0;q<player.rocketCount;q++){ctx.drawImage(ImageHandler.images.tilesBackground,h*3,h*5,h,h,0.5*d*q,p,d,d)}p+=d;for(var q=0;q<player.grenadeCount;q++){ctx.drawImage(ImageHandler.images.tilesBackground,h*4,h*5,h,h,0.5*d*q,p,d,d)}var k=player.maxHealth*50*scaleUp;var f=10;Font.drawString(f,canvas.height-scaleUp*20,"HEALTH:");f+=scaleUp*(7*8+10);paintHealthBar(player,f,canvas.height-scaleUp*25,k,15*scaleUp);f+=k+scaleUp*50;var r=canvas.height-scaleUp*25;var s=f;for(var q=0;q<bosses.length;q++){var o=bosses[q];if(o.alive&&o.state==ATTACK){var b=o.bossName.length*8*scaleUp;Font.drawString(s-b-scaleUp*5,r+6*scaleUp,o.bossName);paintHealthBar(o,s,r,scaleUp*o.maxHealth*20,15*scaleUp);r-=scaleUp*20}}var j=scaleUp*15*8;var e="SCORE: "+(player.securedPoints+player.gatheredPoints);Font.drawString(canvas.width-j,scaleUp*10,e);if(state==PLAYING_GAME){var n=getGridInfo(a,player.x,player.y);if(n!=null){switch(n.messageType){case 0:paintSimpleHelpMessage(helpMessage1);break;case 1:paintSimpleHelpMessage(helpMessage2);break;case 2:paintSimpleHelpMessage(helpMessage3);break;case 3:paintSimpleHelpMessage(helpMessage4);break}}}}}function paintHelpMessageBackground(b,e,d,a){var c=ctx.globalAlpha;ctx.globalAlpha=0.5;ctx.fillStyle="black";ctx.fillRect(b,e,d,a);ctx.globalAlpha=c}function paintPickupHelpLine(b,e,c,a,d){}function paintPickupHelpMessage(){}function paintSimpleHelpMessage(l){var b=1;for(var d=0;d<l.length;d++){var f=l[d];b=Math.max(f.length,b)}var k=canvas.width;var e=canvas.height;var j=10*scaleUp;var c=b*8*scaleUp;var g=l.length*j;var a=Math.round(k*0.5-c*0.5);var m=Math.round(20*scaleUp);paintHelpMessageBackground(a-10*scaleUp,m-10*scaleUp,c+20*scaleUp,g+20*scaleUp);for(var d=0;d<l.length;d++){var f=l[d];Font.drawString(a,m,f);m+=j}}var Tiles={};Tiles.tileSize=32;Tiles.initLevel=function(f){var b=levels[f];b.playerStartX=0.5*Tiles.tileSize;b.playerStartY=0.5*Tiles.tileSize;b.gridInfos=[];for(var n=0;n<b.width;n++){b.gridInfos[n]=[];for(var l=0;l<b.height;l++){var g={patternIndex:-1};b.gridInfos[n][l]=g;var h=b.backgroundTiles[l].charAt(n);g.backgroundImage=ImageHandler.images.tilesBackground;if(h=="r"){g.backgroundCellX=0;g.backgroundCellY=0}else{if(h=="s"){g.backgroundCellX=1;g.backgroundCellY=0}else{if(h=="n"){g.backgroundCellX=2;g.backgroundCellY=0}else{if(h=="m"){g.backgroundCellX=3;g.backgroundCellY=0}else{if(h=="w"){g.backgroundCellX=4;g.backgroundCellY=0}else{if(h=="g"){g.backgroundCellX=5;g.backgroundCellY=0}else{output.innerHTML+="unknown background tile "+h;g.backgroundCellX=0;g.backgroundCellY=0}}}}}}h=b.decorations[l].charAt(n);g.decorationImage=ImageHandler.images.tilesBackground;g.decorationCellX=-1;g.decorationString=h;g.containsPickup=false;g.particleEmitType=-1;g.messageType=-1;if(h=="p"){g.decorationCellX=0;g.decorationCellY=1}else{if(h=="g"){g.decorationCellX=1;g.decorationCellY=1}else{if(h=="D"){g.decorationCellX=9;g.decorationCellY=1}else{if(h=="E"){g.decorationCellX=10;g.decorationCellY=1}else{if(h=="f"){g.decorationCellX=2;g.decorationCellY=1}else{if(h=="A"){g.decorationCellX=6;g.decorationCellY=1}else{if(h=="l"){g.decorationCellX=3;g.decorationCellY=1}else{if(h=="B"){g.decorationCellX=7;g.decorationCellY=1}else{if(h=="s"){g.decorationCellX=4;g.decorationCellY=1}else{if(h=="C"){g.decorationCellX=8;g.decorationCellY=1}else{if(h=="n"){g.decorationCellX=5;g.decorationCellY=1}else{if(h=="h"){g.decorationCellX=0;g.decorationCellY=5;g.containsPickup=true}else{if(h=="r"){g.decorationCellX=1;g.decorationCellY=5;g.containsPickup=true}else{if(h=="o"){g.decorationCellX=2;g.decorationCellY=5;g.containsPickup=true}else{if(h=="u"){g.decorationCellX=5;g.decorationCellY=5;g.containsPickup=true}else{if(h=="i"){g.decorationCellX=100;g.particleEmitType=0}else{if(h=="m"){g.decorationCellX=100;g.particleEmitType=1}else{if(h=="1"){g.messageType=0}else{if(h=="2"){g.messageType=1}else{if(h=="3"){g.messageType=2}else{if(h=="4"){g.messageType=3}else{if(h=="5"){g.messageType=4}else{if(h=="6"){g.messageType=5}else{if(h=="7"){g.messageType=6}else{decorationCellX=-1}}}}}}}}}}}}}}}}}}}}}}}}h=b.objects[l].charAt(n);g.solidObjectImage=ImageHandler.images.tilesBackground;g.solidObjectCellX=-1;g.solidObjectCenterOffsetX=0;g.solidObjectCenterOffsetY=0;g.solidObjectPhysicalWidth=1;g.solidObjectPhysicalHeight=1;g.specialSolidObjectId=-1;g.solidObjectHeight=0;g.movingEntity=null;if(h=="w"){g.solidObjectCellX=0;g.solidObjectCellY=2;g.solidObjectHeight=2;g.solidObjectWidth=1;g.specialSolidObjectId=0;g.solidParticleType=SMALL_STONE_PARTICLE}else{if(h=="j"){g.canSeeThrough=true;g.solidObjectCellX=11;g.solidObjectCellY=5;g.solidObjectWidth=1;g.solidObjectHeight=1;g.solidObjectPhysicalWidth=1;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="n"){g.canSeeThrough=true;g.solidObjectCellX=9;g.solidObjectCellY=3;g.solidObjectWidth=3;g.solidObjectHeight=1;g.solidObjectPhysicalWidth=3;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="o"){g.solidObjectCellX=12;g.solidObjectCellY=2;g.solidObjectWidth=2;g.solidObjectHeight=2;g.solidObjectPhysicalWidth=2;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="<"){g.canSeeThrough=true;g.solidObjectCellX=7;g.solidObjectCellY=4;g.solidObjectWidth=2;g.solidObjectHeight=2;g.solidObjectPhysicalWidth=2;g.solidParticleType=SMALL_STONE_PARTICLE}else{if(h=="J"){g.canSeeThrough=true;g.solidObjectCellX=8;g.solidObjectCellY=11;g.solidObjectWidth=3;g.solidObjectHeight=2;g.solidObjectPhysicalWidth=3;g.solidObjectPhysicalHeight=2;g.solidObjectCenterOffsetY=1;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="q"){g.canSeeThrough=true;g.solidObjectCellX=4;g.solidObjectCellY=3;g.solidObjectWidth=2;g.solidObjectHeight=2;g.solidObjectPhysicalWidth=2;g.solidParticleType=GREEN_LEAF_PARTICLE}else{if(h==">"){g.canSeeThrough=true;g.solidObjectCellX=9;g.solidObjectCellY=4;g.solidObjectWidth=2;g.solidObjectHeight=2;g.solidObjectPhysicalWidth=2;g.solidParticleType=SMALL_STONE_PARTICLE}else{if(h=="t"){g.solidObjectCellX=1;g.solidObjectCellY=2;g.solidObjectHeight=3;g.solidObjectWidth=3;g.solidObjectCenterOffsetX=1;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="x"){g.solidObjectCellX=5;g.solidObjectCellY=7;g.solidObjectHeight=3;g.solidObjectWidth=3;g.solidObjectCenterOffsetX=1;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="T"){g.solidObjectCellX=5;g.solidObjectCellY=10;g.solidObjectHeight=3;g.solidObjectWidth=3;g.solidObjectCenterOffsetX=1;g.solidParticleType=SMALL_WOOD_PARTICLE}else{if(h=="z"){g.canSeeThrough=true;g.solidObjectCellX=4;g.solidObjectCellY=2;g.solidObjectHeight=1;g.solidObjectWidth=1}else{if(h=="p"){b.playerStartX=(n+0.5)*Tiles.tileSize;b.playerStartY=(l+0.5)*Tiles.tileSize}else{if(h=="s"||h=="S"||h=="b"||h=="B"||h=="a"||h=="F"||h=="I"||h=="G"||h=="c"||h=="d"||h=="e"||h=="f"||h=="g"||h=="h"||h=="H"){g.movingEntity=h}}}}}}}}}}}}}}if(g.solidObjectCellX!=-1){for(var c=0;c<g.solidObjectPhysicalHeight;c++){if(l+c<b.objects.length){var m=b.objects[l+c];var a=true;for(var d=0;d<g.solidObjectPhysicalWidth;d++){if(n+d<m.length){var e=m.charAt(n+d);if(e==h){}else{a=false}}else{a=false}}if(!a){g.solidObjectHeight=0;g.solidObjectWidth=0}}else{a=false}}}h=b.surfaceTiles[l].charAt(n);g.surfaceTile=-1;if(h=="g"){g.surfaceTile=0}else{if(h=="w"){g.surfaceTile=1}else{if(h=="s"){g.surfaceTile=2}else{if(h=="a"){g.surfaceTile=3}else{if(h=="i"){g.surfaceTile=4}else{if(h=="A"){g.surfaceTile=5}}}}}}}}};Tiles.init=function(){for(var a=0;a<levels.length;a++){Tiles.initLevel(a)}};function rectCollide(c,a){var d=c[0];var f=c[1];var b=a[0];var e=a[1];return !(f+c[3]<e||f>e+a[3]||d+c[2]<b||d>b+a[2])}function rectContains(e,c){var d=c[0];var b=c[1];var g=e[0];var f=e[1];var h=e[2];var a=e[3];return !(d<g||d>g+h||b<f||b>f+a)}function rectContainsRect(i,h){var f=i[0];var e=i[1];var g=i[2];var d=i[3];var b=h[0];var a=h[1];var c=h[2];var j=h[3];return(b>=f&&b+c<=f+g&&a>=e&&a+j<=e+d)}function rectTranslate(c,b,a){c[0]+=b;c[1]+=a;return c}function rectTranslateCopy(c,b,a){return rectTranslate(rectCopy(c),b,a)}function rectCopy(a){return[a[0],a[1],a[2],a[3]]}function collisionResponse(k,b,a,j,h){var d=vecMinusCopy(a,b);var n=k[0];var g=k[1];var m=n+k[2];var e=g+k[3];var l=d[0];var c=Math.abs(d[1]);var p=1;var i=1;if(b[0]>=m){p=-1;j[0]=m;var f=Math.abs((d[0]-j[0])/d[0]);j[1]=Math.max(g,Math.min(e,b[1]+f*d[1]))}else{if(b[0]<=n){p=-1;j[0]=n;var f=Math.abs((d[0]-j[0])/d[0]);j[1]=Math.max(g,Math.min(e,b[1]+f*d[1]))}}if(b[1]>=e){i=-1;j[1]=e;var o=Math.abs((d[1]-j[1])/d[1]);j[0]=Math.max(n,Math.min(m,b[0]+o*d[0]))}else{if(b[1]<=g){i=-1;j[1]=g;var o=Math.abs((d[1]-j[1])/d[1]);j[0]=Math.max(n,Math.min(m,b[0]+o*d[0]))}}h[0]=d[0]*p;h[1]=d[1]*i}function paintHealthBar(d,c,f,e,b){ctx.beginPath();var a=d.health/d.maxHealth;if(a>0.7){ctx.fillStyle="#00ff00"}else{if(a>0.4){ctx.fillStyle="#ffff00"}else{ctx.fillStyle="#ff0000"}}ctx.fillRect(c+1,f+1,e*a-2,b-2);ctx.strokeStyle="#333333";ctx.lineWidth=1*scaleUp;ctx.strokeRect(c,f,e,b)}function vecCrossWithZ(a){return[-a[1],a[0]]}function vecCrossValue(b,a){return b[0]*a[1]-b[1]*a[0]}function vecNormalize(a){var b=vecLength(a);a[0]/=b;a[1]/=b;return a}function vecCopy(a){return[a[0],a[1]]}function vecNormalizeCopy(a){return vecNormalize(vecCopy(a))}function vecDistanceBetween(b,a){return distanceBetween(b[0],b[1],a[0],a[1])}function vecDot(b,a){return b[0]*a[0]+b[1]*a[1]}function vecMinus(b,a){b[0]-=a[0];b[1]-=a[1];return b}function vecRotate(c,b){var a=c[0];var f=c[1];var e=a*Math.cos(b)-f*Math.sin(b);var d=a*Math.sin(b)+f*Math.cos(b);c[0]=e;c[1]=d;return c}function vecMult(a,b){a[0]*=b;a[1]*=b;return a}function vecMultCopy(a,b){return vecMult(vecCopy(a),b)}function vecPlus(b,a){b[0]+=a[0];b[1]+=a[1];return b}function vecMinusCopy(b,a){return vecMinus(vecCopy(b),a)}function vecPlusCopy(b,a){return vecPlus(vecCopy(b),a)}function vecLength(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function distanceBetween(d,f,b,e){var c=b-d;var a=e-f;return Math.sqrt(c*c+a*a)}var ImageHandler={};ImageHandler.images={};ImageHandler.allLoaded=false;ImageHandler.percentDone=0;ImageHandler.loadImages=function(c,e){var b=0;var a=0;for(var d in c){a++}for(var d in c){ImageHandler.images[d]=new Image();ImageHandler.images[d].onload=function(){if(++b>=a){e()}};if(a>0){ImageHandler.percentDone=Math.round(100*Math.min(1,(b/a)))}else{ImageHandler.percentDone=100}ImageHandler.images[d].src=c[d]}};ImageHandler.init=function(a){var b={tilesBackground:"tiles-background.png",animations:"animations.png",projectiles:"projectiles.png",font:"font.png",largeText:"largetext.png",todo:"todo.png"};ImageHandler.loadImages(b,function(){ImageHandler.allLoaded=true})};var Font={};Font.fontStringArr=["ABCDEFGHIJKLMNOPQRSTUVWXYZ","0123456789.,!><+-;:?*"];Font.largeFontStringArr=["ABCDEFGHIJKLMNOP","QRSTUVWXYZ"];Font.fontMap=new Map();Font.largeFontMap=new Map();Font.init=function(){var l=[Font.fontStringArr,Font.largeFontStringArr];var g=[Font.fontMap,Font.largeFontMap];for(var c=0;c<l.length;c++){var f=l[c];var b=g[c];for(var e=0;e<f.length;e++){var h=f[e];for(var d=0;d<h.length;d++){var a=h.charAt(d);b.put(a,[d,e])}}}};Font.drawString=function(a,g,f){for(var c=0;c<f.length;c++){var d=f.charAt(c);var e=Font.fontMap.get(d);if(typeof e=="undefined"){}else{var b=8*scaleUp;ctx.drawImage(ImageHandler.images.font,e[0]*8,e[1]*8,8,8,a+c*b,g,b,b)}}};Font.drawLargeString=function(a,g,f){for(var c=0;c<f.length;c++){var d=f.charAt(c);var e=Font.largeFontMap.get(d);if(typeof e=="undefined"){}else{var b=16*scaleUp;ctx.drawImage(ImageHandler.images.font,e[0]*16,(e[1]+1)*16,16,16,a+c*b,g,b,b)}}};var Sound={};Sound.gunSoundCounter=0;Sound.GRENADE_THROW_ID=0;Sound.GUN_1_ID=1;Sound.GUN_2_ID=2;Sound.GUN_3_ID=3;Sound.EXPLOSION_ID=4;Sound.ROCKET_LAUNCH_ID=5;Sound.HEALTH_PICKUP_ID=6;Sound.GRENADES_PICKUP_ID=7;Sound.ROCKETS_PICKUP_ID=8;Sound.WEAPON_CLICK_ID=9;Sound.TITLE_MUSIC_ID=10;Sound.BOSS_MUSIC_ID=11;Sound.FANFARE_MUSIC_ID=12;Sound.SAD_MUSIC_ID=13;Sound.HIT_WOOD_ID=14;Sound.HIT_STONE_ID=15;Sound.HIT_LEAVES_ID=16;Sound.HIT_PERSON_ID=17;Sound.sounds=[];Sound.loaded=[];Sound.allLoaded=false;Sound.smInitiated=false;Sound.loadedSounds=0;Sound.percentDone=0;Sound.mute=false;Sound.init=function(){soundManager.debugMode=false;soundManager.url="";soundManager.useHTML5Audio=true;soundManager.preferFlash=false;soundManager.onready(function(){var a=[{name:"gun1",intId:Sound.GUN_1_ID,filename:"shot.mp3"},{name:"gun2",intId:Sound.GUN_2_ID,filename:"shot.mp3"},{name:"gun3",intId:Sound.GUN_3_ID,filename:"shot.mp3"},{name:"grenadethrow",intId:Sound.GRENADE_THROW_ID,filename:"grenadethrow.mp3"},{name:"explosion",intId:Sound.EXPLOSION_ID,filename:"explosion.mp3"},{name:"rocketlaunch",intId:Sound.ROCKET_LAUNCH_ID,filename:"rocketlaunch.mp3"},{name:"healthpickup",intId:Sound.HEALTH_PICKUP_ID,filename:"healthpickup.mp3"},{name:"grenadespickup",intId:Sound.GRENADES_PICKUP_ID,filename:"grenadespickup.mp3"},{name:"rocketspickup",intId:Sound.ROCKETS_PICKUP_ID,filename:"rocketspickup.mp3"},{name:"weaponclick",intId:Sound.WEAPON_CLICK_ID,filename:"weaponclick.mp3"},{name:"mainsong",intId:Sound.TITLE_MUSIC_ID,filename:"mainsong.mp3"},{name:"fanfare",intId:Sound.FANFARE_MUSIC_ID,filename:"fanfare.mp3"},{name:"sad",intId:Sound.SAD_MUSIC_ID,filename:"sad.mp3"},{name:"bosssong",intId:Sound.BOSS_MUSIC_ID,filename:"bosssong.mp3"},{name:"hitperson",intId:Sound.HIT_PERSON_ID,filename:"hitperson.mp3"},{name:"hitwood",intId:Sound.HIT_WOOD_ID,filename:"hitwood.mp3"},{name:"hitstone",intId:Sound.HIT_STONE_ID,filename:"hitstone.mp3"},{name:"hitleaves",intId:Sound.HIT_LEAVES_ID,filename:"hitleaves.mp3"}];Sound.soundInfoArray=a;for(var c=0;c<a.length;c++){var b=a[c];var d=soundManager.createSound({id:b.name,url:b.filename,autoLoad:true,autoPlay:false,onload:function(){Sound.loaded[b.intId]=true;Sound.loadedSounds++;Sound.percentDone=Math.round(100*Math.min(1,(Sound.loadedSounds/Sound.soundInfoArray.length)))},volume:50});Sound.sounds[b.intId]=d}Sound.smInitiated=true})};Sound.isPlaying=function(a){if(Sound.smInitiated){var b=Sound.sounds[a];if(typeof b!="undefined"){return b.playState==1}}return false};Sound.play=function(b,a){if(Sound.smInitiated&&!Sound.mute){if(a){Sound.sounds[b].play(a)}else{Sound.sounds[b].play()}}};Sound.stop=function(a){if(Sound.smInitiated){Sound.sounds[a].stop()}};Sound.muteSound=function(){Sound.stop(Sound.TITLE_MUSIC_ID);Sound.stop(Sound.BOSS_MUSIC_ID);Sound.stop(Sound.SAD_MUSIC_ID);Sound.stop(Sound.FANFARE_MUSIC_ID);Sound.mute=true};Sound.unMuteSound=function(){Sound.mute=false};var Input={};Input.down=[];Input.pressed=[];Input.leftKey=37;Input.upKey=38;Input.rightKey=39;Input.downKey=40;Input.oneKey=49;Input.twoKey=50;Input.threeKey=51;Input.enterKey=13;Input.aKey=65;Input.wKey=87;Input.sKey=83;Input.dKey=68;Input.zKey=90;Input.xKey=88;Input.cKey=67;Input.vKey=86;Input.bKey=66;Input.qKey=81;Input.eKey=69;Input.spaceKey=32;Input.ctrlKey=17;Input.altKey=18;Input.escapeKey=27;Input.mouseDown=false;Input.mouseJustPressed=false;Input.rightMouseDown=false;Input.rightMouseJustPressed=false;Input.mouseX=0;Input.mouseY=0;Input.anyKeyJustPressed=function(){return Input.pressed.length>0};Input.keyJustPressed=function(b){for(var a=0;a<Input.pressed.length;a++){if(Input.pressed[a]==b){return true}}return false};Input.onMouseDown=function(a){switch(a.which){case 1:Input.mouseDown=true;Input.mouseJustPressed=true;break;case 3:Input.rightMouseDown=true;Input.rightMouseJustPressed=true;a.preventDefault();break}return false};Input.onMouseUp=function(a){Input.mouseDown=false;return false};Input.setKeyUpOrDown=function(a,b){Input.down[a.keyCode]=b};Input.onKeyDown=function(a){Input.pressed.push(a.keyCode);Input.setKeyUpOrDown(a,true)};Input.onKeyUp=function(a){Input.setKeyUpOrDown(a,false)};Input.onMouseMove=function(b){var a=$("#mainCanvas").offset();Input.mouseX=b.pageX-a.left;Input.mouseY=b.pageY-a.top};Input.init=function(){$(document).keydown(Input.onKeyDown);$(document).keyup(Input.onKeyUp);$("#mainCanvas").mousedown(Input.onMouseDown);$("#mainCanvas").mouseup(Input.onMouseUp);$("#document").mousemove(Input.onMouseMove);$(window).bind("beforeunload",function(){return"Really want to exit the game?"});$("#mainCanvas").bind("contextmenu",function(b){return false});var a=[33,34,35,36,37,38,39,40];$(document).keydown(function(c){var b=c.which;if($.inArray(b,a)>-1){c.preventDefault();return false}return true})};Input.step=function(){Input.mouseJustPressed=false;Input.rightMouseJustPressed=false;Input.pressed.length=0};var levels=[{index:0,width:20,height:100,backgroundTiles:["rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrwm","rrrrrrrrrrrrrrrrrrmm","rrrrrrrrrrrrrrrrrmmm","rrrrrrrrrrrrrrrrrmmm","rrrrrrrrrrrrrrrrrmmm","rrrrrrrrrrrrrrrrrrmm","mmmmrrrrrrrrrrrrrrrm","mmmmmmrrrrrrrrrrrrrr","mmmmmmmrrrrrrrrrrrrr","mmmmmmmmmmmrrrrrrrrr","mmmmmmmmmmmmmmrrrmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmrmmmmmmm","mmmmmmmmrrrrrrrrrrmm","mmrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm"],surfaceTiles:["....................","....................","....................","....................","....................","...................w","...................w","..................ww",".................www","................www.","................ww..","...............ww..g","...............ww.gg","...............ww..g","................ww..","wwww............www.","wwwwww...........www","...wwww...........ww",".....wwwwww.......ww",".......wwwwwww...www","..gggg.....wwwwwwwww","gggggggggg..wwwwww..","ggggggggggg.www.....","...gggggg...ww......","............ww......","..........wwwww.....",".......wwwwwwwwwww..",".wwwwwwwwwwwwwwwwwww","wwwwwwwww........www","ww.....ww...........",".......ww......gg...",".......ww.....gggg..","gggg...www...ggggg..","ggggg...ww...gggg...","gggggg..www..ggg....","gggggg...www........","ggggg..g..ww........","ggggg.ggg..ww.......","ggg...ggg...www.....",".......gg....wwww...",".......gggg...wwwww.",".........ggg.....www","..........gggg......","aaaa.......gggggg...","aaaa........gggggggg","aaaa..........gggggg","...aaa.........ggggg",".....aaaaaa.......gg","..........a.........","..........a.........","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa","....................","....................","........wwwww....www","...wwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwwwwwwww....wwwwwww","wwwwwwww.....wwwwwww","wwwwwwww.....ww.....","....wwww....ww......","......www...w.......",".......wwwwwww......",".......wwwwwwwww....","........wwwwwwww....","..........wwwwww....","...............wwwww","g.................ww","ggg.................","gggggg............gg",".ggggggg.........ggg",".....ggggg.....ggggg","........gggggggggggg",".........ggggggg....","....................","........wwwww.......",".wwwwwwwwwwwwwwwwww.","wwwwwwwwwwwwwwwwwwww","www.............wwww","w.................ww","...................w","....................","....................","....................",".....gg.............","....gggg............","......gggg........gg","w......gggg.....gggg","ww.......gg..ggggg..","www.......ggggggggg.","www.....ggggg.ggggg.","ww......gggg.....ggg","..................gg","aaaaaaaaaaa........g","..........a.........","..........a.........","..........a.........",".....aaaaaa.........",".....a....a.........",".....a....a........."],objects:["ww..................",".wwwoowwnnnwwwwwwwww","....................","........B....www..x.",".............w......",".x..................","....................","....................","..zwwwwwwwww..x.....","..j........j........","....................","........j...........","..........x.........",".....x..............","....................","........j....x......","....................","....................","....................","....................","....................","....................","...t..s.............",".s........x.......s.",".....<<............t","....................","....................","....................","....................","....................","..................qq","....................",".............t......","...t...........s....","....................",".s..................","....................","....................","....................","....................","....................",".......wwnnn.www....","wwzwwwww.......wwwzw","....................","....j..s............","...............s....","ww..................",".www.s..............","..xw................","...wwwwwwnnn.wwwooww","....................","....................","..............t.....",".................s..","....................","....................","....................","....................","..........s.........",".........zzww.......","....................","..s...........t..w..",".zz..x...........w..",".................w..",".................www","....................","....................","......x.s...s.t.....",".t..................",".....x............w.","...........u.....ww.","<<...............w..",".................w..","......j..........w..",".................www","....................","....................","....................","....................",".........wwwww......",".......wwws..w......",".......w.....w......",".......wwwooww......",".........j..........","...<<...............","................qq..","....www.............","..t...w............t",".....sw.............","......w.............","....www.............","......j.........x...","..x..............<<.",".............w......","wwwwzww......wwwzww.","..w......j...w....w.","w.wwzw...p...w....ww","w...................","wwzww.wzw....wwz.www","....w...wnnnww.....w"],decorations:["..............i.....","h...................","..............mu...o","....s...............","..............h.....",".m.....s............","............s.......","r...m....i......l...","....................",".c.c......c.c......r","..c........c.s......","...s...b.b........f.","........b........u.h","..g.....s...........","....................",".......a.a.........o","........a...........",".......pp..g..s.l...",".......pp........p..",".......pp........p..",".......pp........p..",".................p..",".....u...........p..","....................","....................","...............p....","...p...........p....","...p...........p....","...p...........p....","...p................","...........s........","....................","............l.......","s.l.........ll......","..l................s","......s..........s..",".....h......p.....h.","............p...s...","............p.......","............p.......","...s................","....................","....................","uu..5..............h","...5.5...s..........","....5.......g.....s.","..............o.....","..............rr.g..","g...................","....................","....................","....................","......s.g...........","..s.........p.......","............p...p...","pp..........p...p...","pp..........p...p...","pp..........p...p...","pp..............p...","pp..............p...","pp.........pppp.....","...u................","....................","....................","....................","................p...","................p...","..........h.....p...","....................","....................","u...................","....................",".h...o.o............","....r4.4h.........u.","......4.............",".....pp.............",".....pp.............",".....pp.............",".....pp......u......","....................","....................",".....hr.............","....................","........3.3.s.......",".f.......3....f.....","....................",".l.l....s...s..f....","...l..............l.",".................sll",".............s...s..","...................g",".....2.2............","...s..2..s.....g....",".i.........s.......g","....i....1......m...","........1.1........m",".........1..........",".u....m.....m.......","..m....i.......m....","..................m."]},{index:1,width:20,height:120,backgroundTiles:["rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","mmmmmmrrrrrrrrrrrrrr","mmmmmmmmrrrrrrrrrrrr","mmmmmmmmmmrrrrrrrrrr","mmmmmmmmmmmmrrrrrrrr","mmmmmmmmmmmmmrrrrrrr","mmmmmmmmmmmmmmmrrrrr","mmmmmmmmmmmmmmmmrrrr","mmmmmmmmmmmmmmmmmrrr","mmmmmmmmmmmmmmmmmmmr","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmrr","rrmmmmmmmmrrrmmmrrrr","srrmmmmmrrrrrrrrrsss","ssrrrrrrrrrrrsssssss","ssssssssssssssssssss","ssssssssssssssssssss","sssssssswwwsssssssss","sssssssswsssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","rsssssssssssssssssrr","rrrssssrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr"],surfaceTiles:[".............wwwwwww",".....wwwwwwwwwwww...","...wwwww..........AA",".wwwwww...AAAAAAAAAA","wwwww...AAAAAAAAAAAA","www....AAAAAAAAAAAAA","ww....AAAAA...AAAAAA",".....AAAA........AAA",".AAAAAAA..........AA","AAAAAAAAA...........","..AAA.AA............","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","aaa.................","..a.................","..a.................","..a.................","..a.................","aaaaaaaa............",".......a............",".......a............",".......a............",".......a............",".......a............",".......a............",".......a............",".......a............","aaaaaaaaaaaaaaa.....","aaaaaaaaaaaaaaa.....","............aaa.....","gg..................","gggg......ggg.......","gggggg..gggggg....gg","ggggggggggggggg.gggg","gggggggggggggggggg..","gg.........ggggg....","g............ggggg..","...............ggggg",".................ggg","...................g","wwwwwwwwwww.........","wwwwwwwwwwwww.......","www........www......",".....AA.....www.....","AAAAAAAA.....www....","AAAAAAAAA.....wwwwww","AAAAAAAAA.....wwwwww","..AAAAA......wwwwww.","............wwww....","wwww......wwwww.....","wwwwww...wwww.......","wwwwwwwwwwww........","wwwwwwwwwww.........","ww....wwwwww........","w.......wwwwww.....w",".........wwwwww..www","...........wwwwwwwww",".............wwwwww.","..............www...","...............www..",".................www","..................ww","...................w","....................","....................","....................","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa","....................","....................","....................","....................","....................","..................gg","gg.......gggg...gggg",".gg.....ggggggggg...","..ggggggggggg.......","......ggggg.........",".......ggggg........","......gg..ggg.......","......gg.gggg.......",".......ggggg........","........ggg.........","....................","....................","....................","....................","...........ggggggggg","g....ggggggggggggg..","gggggggg............","....................","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa","...........aaaaaa...","....................","....................","....................","....................","....................","AAA...............AA","AAAA............AAAA","..AAAA.......AAAAAA.","...AAAA....AAAAAAA..","....AAAAAAAAAAAAA...",".....AAAAAAAAAA.....","..AAAAAAAAAA........","AAAAAAAAA...........","AAAA................","....................","....................","....................","...................."],objects:["wwwwwwwnnnwww.......","....................",".............wwwwwww","............F.......","....................","....................","....................","....................","...........x...x....","....................",".......wwwwwwwwwww..","......x....j....x...","....................","..x..........x......",".........x..........","...........j........","................S.r.","......j.............","wwwww...............","....w.b............t",".t..w........xs.....","....ww..............",".....wwwww...wwwwww.",".........w..ww.w....","..S......w.ww.......",".........w.....w....",".........www...wwoow","....................",".........ww......w..","wwwwwwnnnw.......w..",".........w...b...w..",".........w..........",".........ww.........","..........w.........","......S.......www...","................www.",".................w..",".............S...w..","................ww.b","................w.bb","................w...","................ww..",".................www","..s...s.............","www..zzz....s.......","............ww......","....................","....................","....................","....................","....................","....................",".x..................","....................","...S........S.......","....................","....................","....................",".................bqq","................qq..","....................","....................",".S..................","....................","..t.................",".........x..........","....................","....................","....................","...............<<...","....................","....................",".x..................","wwwwwwww.nnnwwwwwwww",".....S..............",".........b..........","wwwwwwnnn.wwwwwwwwww","................x...","....................","....................","....................","....................","....................","....................","..s.................",".......x..S.........","....................",".......b...t........","....................","....................","........S...........","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","..................s.",".......www..........",".b..................","ww..................","....................",".............b......",".............www....","......x.............","....................",".x............x.....","....................","....................","..................<<","................x...","....................","........p...........","ww..................",".wwwwwwwnnnwwwwwwwww","...................."],decorations:["........p...........","..u.....p........oru","........p...........","....................","....................","...o................","....h...............","....................","....................","............h.......",".h.................h","....................","....................","...............r....","...............h....",".............oh.....","....................","....................","....................","u...............g.l.",".........g.........l","...........f........","....................",".......h........o...","o...................","r...................","....................","....................",".............s......","................h..o","...h.......s........","................g...",".f................s.",".........r..........","....................","...............r....","....................",".g..................","...........g........","...................u","..f...l..........h..","..............l.....","....................",".......s....f.......","....................","....................","....f.....s.........",".........pp......l..",".........pp.........",".........pp.......s.",".........pp.........","....................",".................p..",".u........g......p..","...........f.ppppp..",".................p..","...........p.....p..","....pp.....p........","....pp.....p........","....pp.....p........","....pp.....p........","....pp..............",".................p..",".................p..",".................p..",".lll.............p..",".....g...........p..","..................p.","..g.........g.....p.","..................p.","..................p.","...s..o.............","................ro..","....................","..................u.","....................","....................",".s.h.........h......","............s.......","....g...............","........g...........","....................","....................","....................","....................","....................","..........u.........","....................","..........f.........","....................","..s.................","....................","...............s....","....................","....................","....................",".............f..l...","......l......s......","....................","....................","....................","r.......m..........h","u...................","........o...........","....................","....................","............u.......","....................","....................","...................r","....................","....................","............h.......","....................","....................","....................","....................","..u...........i.....","....................","...................."]},{index:2,width:20,height:120,backgroundTiles:["gggggggggggggggggggg","ggggggggrrrrgggggggg","rgggrrrrrrrrrrrrggrr","grggrmmmmmmmmmmrrrrm","ggrrrmmmmmmmmrrrrmmm","gggrrrrrrrrrrrrrmmmm","ggggrrrrrrrrrrrrrmmm","rgggrrrrrrrrrrrrrmmm","rrgrrrrrrrrrrrrrrrmm","rrrrrrrrrrrrrrrrrrrr","rrrmmrrrrrrrrrrrrrrr","rmmmmrrrrrrrrrrrrrrr","mmmmmrrrrrrrrrrrrrrr","mmmmmrrrrrrrrrrrrrrr","rmmmmrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrmm","mrrrrrrrrrrrrrrrrmmm","mmrrrrrrrrrrrrrrrmmm","mrrrrrrrrrrrrrrrrmmr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrmmrr","mrrrrrrrrrrrrrrrmmmr","mmrrrrrrrrrrrrrrmmmr","mmrrrrrrrrrrrrrrmmrr","mmrrrrrrrrrrrrrrrrrr","mrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrmmm","rrrrrrrrrrrrrrrrmmmm","rrrrrrrrrrrrmmmmmmmm","rrrrrrrrrmmmmmmmmmmm","rrrrrrrmmmmmmmmmmmmm","rrrrrmmmmmmmmmmmmmmm","rrrrmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm"],surfaceTiles:["....................",".......wwwww........","ww..wwwwwwwwwwww..ww",".ww.w..........wwww.","..wwwww......wwww...","...wwwwwwwwwwwww....","....wwwwwwwwwwwww...","w...wwwwwwwwwwwwww..","ww.wwwwwwwwwwwwwwww.","wwwwwwwwwwwwwwwwwwww","www..wwwwwwww..wwwww","w....wwwwwwww...wwww",".....wwwwwww....wwww",".....wwwwwww.....www","w....wwwwww......www","wwwwwwwwww.......www","www....ww.......ww..",".ww.............w...","..w.............w...",".ww............ww..w","ww............wwwwww","www...........ww..ww",".ww...........ww...w","..ww..........ww...w","..ww..........www.ww","..ww..........wwwww.",".www................","ww..................","....................","....................","...aaaaaa...........","...aaaaaa........ggg","...aaaaaa.....gggggg","aaaaaaa...gggggggg..","aaaaaa..gggggggg....",".......gggggg.......",".....gggggg.........","....gggg..........ww","ggggggg.........wwww","gggggg........wwwww.",".............wwwww..","............wwww....","............ww......","...........ww.......","www........ww.......","wwwwww....ww........","wwwwwwwww.ww........","....wwwwwwww........",".......wwwwww.......","........wwwww.......","..........wwwwwwwww.","..................ww","....ggggg..........w","...ggggggg.........w","...gggggggg........w",".....ggggg........ww",".................ww.","...............www..","..............wwww..",".....wwwwwwwwww.....","...www..............","..ww................","..w.................","..w.................","..w...........wwwwww","..w..........ww....w","..w.........ww......","..ww.......ww.......","...ww.....ww......gg","....ww.www....gggggg",".....www....gggggg..","..........gggg......","........gggg........",".....ggggg.........w","ggggggg..........www","ggggg...........wwww","gg............wwww..","g.........wwwwwww...","........wwwwwwww....","......wwwww.........",".....www............","....www.............","....wwww............","......wwww..........",".......www..........",".......www..........","....wwwww.........gg","..wwwww..........ggg","..wwww..........gggg","..ww............gggg","..ww...........ggggg","..ww...........ggggg","...ww..........ggggg","....www........ggggg","....wwww........gggg",".....www.........ggg","......wwww........gg",".......wwww.........","........wwww........","..........wwww......","w..........wwww.....","ww..........wwww....","www........wwwwww...",".www....wwwww..www..","..www..wwww.....ww..","...ww.ww........www.","...ww.ww....gg...ww.","....w.ww...gggg...ww","....wwww...gggg...ww","....wwwww.........ww","w.....wwww.......www","ww......wwwwwwwwwww.","wwwww......wwwwww...",".wwwwww....wwwww....","....wwwww.wwwww....g",".....wwwwwwww.....gg",".........wwwww......","..........wwwww.....",".............wwwwwww",".............wwwwwww"],objects:["wwwwwwwwwwwwwwnnnwww","....................","....................","........I...........","....................","x..................x","....................","....................","....................","....................","....................","....w.........w.....","....w.........w.....","....w.........w.....","....w.......x.w.....","....................","....w.........w.....","....w.........w.....","ww.wwwwww.wwwwww.www","......w.....w.......","......w.....w.......","......w.....w.......","......w.....w.......","......w...x.w.......","......w.....w.......","....x.w.....w.......","......w.....w.......","......w.....w...x.ww","......w.....w.....w.",".wwwwwwww.wwwwwwwww.",".w........j.........",".w..........x.......","ww..................","....................","........x...........","....................","....................","....................","....................","....................",".........t..........","....................","....................","....................","....................","....................",".................t..","....................","....................","....................","....................","wzzwww..............","..S..w........wwww..","......w.......wd.w..",".......w......w.....","...d...w......wwzw..","........w.......t...",".wwzww..w....zz.....","....................","....................","....................","....................","....................","....................","....x...............","....................","....................","................t...","....................",".a..................","....................","....................","..........t.........","......t......a......","..t.................","....................","....................","....................","....................","....................","..................g.","..S.................","............s.......",".................S..","....................","....................","....................","....................",".................t..",".............t......","..........x.....qq..",".......t............","...............<<...","....................","....................","....................",".x..................","...<<............ww.",".................w..",".zww.............w..","...w..............a.","....................","....................","....................","....................",".............c......","...........wwww.....",".S.............x....","....................","..c.................","....................","....................","....................","....................","....................","....................","....................","....................",".......p............","wwwwwwwnnnwww......."],decorations:["....................",".p.f........h..r...f",".p..................",".p.ppp........pppppp",".p............p.....","..............p..h..","..r...........p....g",".p.pppppppppppp...p.",".p............p...p.",".p............p...p.",".p............ppppp.",".p...............p..","h.o..............p..","f................p..","...p............pp..","...ppp..............","...p.p.....s......h.","....................","....................","...........u......s.","..s.................","........s...........","....s............f..","l...............o.f.","l...................",".r..................","........h.h.........","..............g.....",".i...h..i.i......i..","....................",".......u............","i...................","........s..or.......",".................f..","....................","....................","....................","................p...","..........f.....p...",".........u......p...","................p...","........ll......p...",".f..................","......f.............","....................","....................","....................","s.................f.",".s...............s..",".............p......",".....u.......p......",".............p......","hr..s...............",".........f.....oh...",".s..................",".....f..s...........","....................","....................",".......p............",".f.....p............","f......p............","................s.s.","..............s.....",".................p..",".................p..",".....h...........p..","....................",".................l..","..............l.....","....................","hu..............f..f",".s..................","....................",".........f.....s....",".....f..............","f...................","........s...pp.....h","............pp......","............pp......","h...........pp......","f...................","u...................","....................","....................","..s.................","......ppppp.........","....................","..................l.","....................","s...........l.l.u..s",".............l......","......l.............",".......l............","...........s......f.",".s.................f","....................","....................","...............s....","..f..........p....u.",".............p......","....f........p......","......s......p......",".............p......",".............p......","....................","o.............u.....","....................","...ppp....f...l..r..",".su..........f.l....",".................p..","..........p......p..","...p..s...p......p..","...p....h.p......p..","...p................","...p..............h.","h...................","...................s",".s..........pppp....","............p.......","...................."]},{index:3,width:20,height:120,backgroundTiles:["rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrmrrrr","rrrrrrrrrrrrrrrmmrrr","rrrrrrrrrrrrrrrrmrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrnnn","rrrrrrrrrrrrrrnnnnnn","rrrrrrrrrrrrnnnnnnnn","rrrrrrrrrrnnnnnnnnnn","rrrrrrrrrnnnnnnnnnnn","rrrrrrrnnnnnnnnnnnnn","rrrrrrnnnnnnnnnnnnnm","rrrrrnnnnnnnnnnnnmmm","rrnnnnnnnnnnnnnnnmnm","nnnnnnnnnnnnnnnnnnnm","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnnnn","nnnnnnnnnnnnnnnnnrww","nnnnnnnnnnnnnnnrwwww","nnnnnnnnnnnnnnnwwwww","nnnnnnnnnnnnnnnwmwww","nnnnnnnnnnnnnnnwmmmw","nnnnnnnnnnnnrwwmmmmm","nnnnrrrrrrrrmmmmmmmm","nrrrrmmmmmmmmmmmrrrr","rrmmmmrrrrrrrrrrrrrr","mmmrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrm","rrrrrrrrrrrrrrrrrrmm","rrrrrrrrrrrrrrrrrmmm","rrrrrrrrrrrrrrrmmmmm","rrrrrrrrrrrrrmmmmmmm","rrrrrrrrrmmmmmmmmmmm","rrrrrmmmmmmmmmmmmmmm","rmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm"],surfaceTiles:["....................","....................","....................","....................","w...................","wwwwww..............","wwwwwwwww...........","..www..wwww.........",".........ww.........","..........www.......","...........www......","............www.....",".............wwwww..","..............wwwwww","...............wwwww",".................www","....................","....................","....................","...ssss.........sss.","..ssssss.......ssss.","..ssssss.....ssssss.","...ssss.....ssssss..","............sssss...","...........sssss....",".i..........sss.....","iii.................","iiiiii..............","iiiiiiii............","iiiiiiiii....s......","iii...iiii...sss....","i.......ii...ssssss.",".............sssssss","..............ssssss","................ssss",".................sss","....................","....................","....................","....................",".....aaaaaaaaa......","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa","....................","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa","....................","i...................","iiiiii..............",".iiiiiiiiiiii.......",".....iiiiiiiii......",".........ii.iii.....",".........i...iii....",".........i....ii....","........iii...ii....","........iiiiiiiii...",".........iiiiiiiii..",".........iiiiiiiii..","........iiiiiiiiii..",".......iiiiiiiiiii..",".......iiiiiiiiii...","........iiiiiii.....","....................","....................",".....ss.............","....sssssssssssss...","...ssssssssssssssss.","..sssssssssssssssss.","sssssssssssssssssss.","ssssssss.......sssss","sssssss..........sss","sssss.....sss..i..ss","ssss.....ssss..ii..s","sss.....ssssss..i..s","ss.....sssssss.....s","ss....ssssssss....ss","ss...ssssssss....sss","s....sssssss...sssss","s.....ssss...sssss..","......sss...ssss....","......ssssssss......","......ssss..........","......ssss..........",".....ss.............","....ss.............w","sssss............www","ss...............www","..................ww","...................w","....................",".....gg.............","...gggg.............","..gggg..............","...gg...............","....................",".................iii","...............iiiii","...............iiiii","...............iiiii","..............iiii.i","...........iiii.....","....iiiiiiii........",".iiii...........ssss","ii....sssssssssss...","...ssss.............","ssss.........sssss..","...........ssssssss.","..........ssss..sss.","..........ssss...sss","..........sss....sss","sss...........s..sss","sssss.......sss.ssss","ssssssssss......ss..","..ssssssssssss.ss...",".......sssssssss....",".....ssssssss.......","sssssssss...........","sssss...............","s...................","...................."],objects:["wwwwww.......wwwwwww","..x..wwwnnnwww.....x","....................","....................","..www....G.....www..","....................","...............x....",".x..................",".....www...www...T..","....ww.......ww.....","...ww.........ww....","...w...........w....","......x.............",".........j..........","....................","....T...........T...","....................","..x...........x.....",".........j..........","....................","....................","....................","....T......f........","....................",".T................x.","....................","....................",".........x..........","....................","....................","....................","....................","....e...............","....................","....................","....................","...........h........","....................","........wwwww.......","wwwwwwwww...wwnnn.zw","....................","....................","....................","wwwwwwwwnnn.wwww.www","......h.............","....................","wzwwwnnn.wwwwwwwzwww","...w................","....................","...w................","w.ww................","..................T.",".T..................","............x.......","....................","....................","..................x.","......x.............","x...................","....................","....................","....................","..T.................","...........f........","....................","....................","..h.................","................T...","....................","....................","....................","....................","....................","....T...............","....................","....................","wwwwwww.............","......w.............","..h...w.............",".e...ww.........e...","....................",".....w............ww",".....w..........www.","wwwwwwwwww.ww.www...","...T.....w..w...h...",".........wf.w.......","..h......w..w.w.....",".........wwww.wwww..","......wwww..........","wwwww.w.........e...",".........w..........",".........w.f...wwzz.",".........w.....w....","....T....w...www....",".e.......w..ww......","........wwwww.......","........w...........","........w...........","www.zzzww...........","....................","....................","....................","....................","....................","....................",".f.....e............",".....zz.............",".T..................",".............T......","wwwww.............c.",".S..w......wwww.wwww","....w......w........","....w......w........","....w......w...w....","..T.w.....xw.....T..","x..........w........",".f..w......w...p....","....w...............","wwwwwwwwwwwwwwnnnwww","...................."],decorations:["....................","h.............h.....","....s..............h","....................","....................",".............s....n.","...................n",".....h..............","....m.........i.....","....................","s...................",".................pp.","........r.o......pp.","g................pp.",".................pp.","..f..............pp.","........s..g.....pp.","n...................",".....gs............n","...........s..n...n.","s...................","h...................",".....or.............","....................","....................","..g................g","....................","....................","..........g.........","....................","....................","....................",".g..................",".g...........g......","....n...............","....................","g.....n.............",".n..........h.......","...g................","....................",".ur................g","...............n...o","....................","....................","...s..............hu","h...................","....................",".ug.r..g...........o",".................g..","r...................","....................","..g.................",".......n............","...........r........","....n........s....g.","..n.................","....................","o.....i.............","..s.................","..................hg","..................no",".....s..............","................n...","..........g.......n.",".............n......","....................","....................","....................","....................","..........g.........","....................",".......n............","....................","..................g.",".............n......","h...................","....................","u....r..............","...n........g.......",".......n...g........","g.n.................","....................","....i.hh...........h",".................u..","u.............no....","...n................","....................","....................","....................",".......h............","r...................","...g..n.............","..........n.........","....................","..............o.....","....................","....................",".......u............","....................","..................h.","..n.............g...","..................g.","..............f.....","..f.................","....................","....hnu..........n..","....................","...................h","i...................","....................","..ho...n............","............rh.....o","....................",".....n..............","....................","............u.....g.",".............g.....f","...u..m.............","....................","...................."]},{index:4,width:20,height:120,backgroundTiles:["rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrnnn","rrrrrrssssssnnnnnnrr","rssssssssssssssnrrrr","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","sssnssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssssssssssssssssss","ssssrrrrrrrrrrrrrsss","rrrrrrrrrrrrrrrrrrrr","rrrrmmmmmmmmrrrrmmmm","rmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmrrrrrrrrmmmm","mmmmrrrrrrrrrrrrrrrm","mmrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrmmrrrrrrrrrr","rrrrrmmmmmmmrrrrrrrr","mmmmmmmmmmmmmrrrrrrr","mmmmmmmmmmmmmmrrrrrr","mmmmmmmmmmmmmmmrrrrr","mmmmmmmmmmmmmmmmmrrr","mmmmmmmmmmmmmmmmmmrr","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","mmmmmmmmmmmmmmmmmmmm","rrmmmmmmmmmmmmmmmmmm","rrrmmmmmmmmmmmmmmmmr","rrrrrrmmmmmmmmmmrrrr","rrrrrrrrmmmrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr","rrrrrrrrrrrrrrrrrrrr"],surfaceTiles:["wwwwwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwwwww......wwwwwwww","w..............wwwww","................www.","................ww..","................wwwS","gggggg...........www","gggggggg......g...ww","ggggggg...S.ggggg..w","ggg.....SSS....ggg.w","....SASSS.......g..w","...................w",".......wwww.......ww","...wwwwwwwwwwwwwwwww","wwwwwwwwwwwwwwwwwwww","wwww.......wwwwww...","w...................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","....................","......gggggggggggg..","...ggggggggggggggggg",".gggggggggggggg.....","ggggggg...ggggg.....","gg.......gggg.......","g.......gggg........","........ggg........g",".......ggggggggggggg","......ggggggggg.....",".....ggggggg........","....gggggg..........","...ggggg............",".gggggg.............","gggggg..............","..ggg.............ww","..gg.............www",".gg............wwwww",".g............wwwww.","gg..........wwwwww..",".........wwwwww.....","........wwwww.......","......wwww..........","......www...........","......www...........","......ww............","......www...........","......wwww..........",".......wwww.........",".........www........",".........wwww.......","..........www.......","...........www......","............www.....","............wwww....",".............www....",".............www....",".............www....",".............www....",".............www....","............wwww....","...........wwwww....",".........wwwwww.....","........wwwwww......",".......wwwwwww......","......wwwwwww.......","....wwwwwwww........","..wwwwwwwwwwww......","wwwwwwww..wwwww.....","wwwww......wwwwww...","............wwwwww..",".............wwwwww.","...............wwwww","................wwww","..................ww","....................","....................","....................","....................","....................","....................","....................","....................","................aaaa","aaaaaaaaaaaaaaaaaaaa","aaaaaaaaaaaaaaaaaaaa",".aaaaaa.............","....................","....................","....................","....................","....................","....................","....................","ww.................w","wwww..............ww","..wwww...........www","...wwwww...wwwwwwww.","......wwwwwwwwwwwww.","........www......www","..................ww","....................","....................","....................","...................."],objects:["....................","....................","....................","....................","...JJJ..............","...JJJ.wwww.........","..w.......w.........","www.......wwww.....w",".............www....","...............w....","....H....Q.....ww...","...x............ww..","....................","...............x..w.","..................w.","......wwwwww.....ww.","..wwwww....ww.wwww..","www.................","....................","..................j.",".....j...j..j.......","j...................",".......x............","................x...","....................","..x.................","....................","....................","....................",".........G......x...","....................","....................","....x...............","...........x..wwwwww","..............w..w..","wwwww.........w..ww.","....wwww....www.....",".........j......t...","....................","...t................","....<<..............","....................","....................","............t.....t.",".........t..........","............<<......","....................","....t...............","...............x....","..........x.........","....................","....................","....x...............","....................","....................",".......I............","..............ww....",".x........wwwww.....","..qq........w...qq..","............w.x.....","...ww.......w.......","wwww.j......w...<<..","............w.......","....................","............w.......","....................","wwwww.wwww..........","..w......ww.........","..w.......ww........","...x................","..........x.w.......","............w.......","............w.......","............w.......",".x.........ww.......","...........w......x.","........F...........","...x...ww...........",".....www............","....ww..............","w.www...............","....................","....................","....................","........j...........","....................","....................","....................","....................",".............x......",".x..................","....................","....................","....................",".............x......","........B...........","..x.................","...wwwwwwwwwww..wwww","wwww................","....................","....................","......wwj..wwwwwwwww","wwwwwww.............","....................",".............x......","....................","....................","....x...............","....................","....................","....................","............x.......","....................","....x...............","....................",".........j..........","....................","wwwwww...p...wwwwwww",".....wwwnnnwww......","...................."],decorations:["....................","....................","....................","....................","....................","......r.............","....................","....................","...................h","....................","....................","h...................","....................","....................","....................",".....i..........i...",".............p......",".............p......",".............p......",".............p......",".o...........po.....","....................","......lm............","...............lm...",".........s..........",".l...s............h.","..l.................",".h..................",".........r..........","...s..........s.ml..","................l...","....................","...lm...............","....o.......l.......","....................","....................","....................","..........o.........","....................","....................","..............s.....",".h..................","....................",".s..................","....................",".......s............","..................h.","....................","..........l....i....",".........l.l........",".......s..l..s...p..",".................p..",".................p..","....l............p..","..r..s...........p..",".................p..","...s................","..o.................",".....pppppp....l....",".............l.r....","..............l.....","....o...............","....................","...............s....","....................","....................","....................","........s...........","....................","..l...............s.","...l.......o........",".h...s..............","....................","....................",".m..................","....s............l.o","..........p.........","..l.r.....p.........","...l......p.........","..........p.........","..........p....h....","..........pppp......","pp........p.........","pp.......rp.........","pp........p.........","pp.........pppppppp.","....................","....................","....................","........s...l.......","r............l......","....................","....................","....................",".............m......","...s................","....................","....................","....ss...s.....s....","....................","....................","..........h.........",".......r.o..........","....................","....................",".............ll.....","....................",".....l..............","...l................","....................",".......s............","...........l........","....................","....................",".............s......",".........s..........",".i.s.............i..","....................","....................","...................."]}];var currentLevel=-1;var levelMode=LEVEL_NORMAL_PLAY;var cameraX=0;var cameraY=0;var cameraAbove=true;var forces=[];var projectiles=[];var enemies=[];var bosses=[];var particles=[];var pickups=[];var textAnimations=[];function damageExplosion(c,h,f,d,b,a){var g=distanceBetween(d.x,d.y,c,h);if(g<=a){if(currentLevel>=0&&visibleBetween(levels[currentLevel],c,h,d.x,d.y)){var e=b*(1-g/a);d.hit(e);return e}}return 0}function addExplosion(n,m,l,g,F,f,a,b,E){var p=new ExplosionForce(n,m,l,g,f,a);addOrSteal(p,forces,10);var k=vecLength([player.x-n,player.y-m]);var o=50;if(k>0.1){o=50*(100/(100+k))}Sound.play(Sound.EXPLOSION_ID,{volume:o});var A=0;var c=[];var j=[];for(var v=0;v<enemies.length;v++){var e=enemies[v];if(e.alive){var C=damageExplosion(n,m,l,e,F,f);if(C>0){var D=vecNormalize([e.x-n,e.y-m]);addDamageSplash(e.x,e.y,C);A++;if(b==-1){var u=player.getPointsForExplosionDamage(C);j.push(u);c.push(e)}}}}var d=0;for(var v=0;v<c.length;v++){var u=j[v]*c.length*E;var e=c[v];addTextAnimation(new PointsTextAnimation(e.x,e.y,l,""+u,20));player.increasePoints(u);d+=u}if(c.length>1){var q=new PlayerConnectedTextAnimation(0,"MULTI HIT X"+A,60);q.delay=30;addTextAnimation(q)}var C=damageExplosion(n,m,l,player,F,f);if(C>0){addDamageSplash(player.x,player.y,C)}var t=F*15;var G=5+F;for(var v=0;v<t;v++){var h=v/t;var B=Math.PI*2*h;B+=Math.random()*0.1;var s=Math.random()*G*0.2+G*0.8;var w=Math.round(f/s);var r=new FireParticle(n,m,l,Math.cos(B)*s,Math.sin(B)*s,Math.random()*2,w);r.addSmoke=true;r.collides=true;r.destroys=true;addParticle(r)}return d}function addOrSteal(h,a,b){if(a.length<b){a.push(h);return true}else{var g=0;var d=-1;for(var f=0;f<a.length;f++){var c=a[f];if(c==null){a[f]=h;return true}else{if(c.duration<g){g=c.duration;d=f}}}if(d!=-1){a[d]=h;return true}return false}return true}function addProjectile(a){return addOrSteal(a,projectiles,40)}function addParticle(a){return addOrSteal(a,particles,500)}function addTextAnimation(a){return addOrSteal(a,textAnimations,10)}function stepAndRemove(b,f){var a=0;for(var d=0;d<b.length;d++){var c=b[d];if(c!=null){c.step(f);var e=c.duration;if(e<=0){b[d]=null;a++}else{if(a>0){b[d-a]=c}else{a=0}}}else{a++}}if(a>0){b.length=b.length-a}}function stepLevel(){var a=levels[currentLevel];stepAndRemove(projectiles,a);stepAndRemove(particles,a);stepAndRemove(forces,a);stepAndRemove(textAnimations,a);for(var h=0;h<enemies.length;h++){var g=enemies[h];if(g!=null&&g.alive){g.step(a)}}for(var h=0;h<pickups.length;h++){var b=pickups[h];b.step()}if(stateCounter%10==0){var q=a.gridInfos;var l=Math.max(0,Math.floor(cameraY/Tiles.tileSize));var e=Math.min(a.height,2+(cameraY+canvas.height)/Tiles.tileSize);for(var o=0;o<q.length;o++){var j=q[o];for(var m=l;m<e;m++){var d=j[m];if(d.surfaceTile==1&&d.decorationString!="p"){if(Math.random()<0.02){var k=1;for(var h=0;h<k;h++){var p=(o+Math.random())*Tiles.tileSize;var n=(m+Math.random())*Tiles.tileSize;var f=30+Math.random()*70;var r=Math.round(Math.random()*2+1);var c=new WaterGlimmerParticle(p,n,0,0,0,0,f,0.5+0.5*Math.random(),r);addParticle(c)}}}}}}}function getGridInfo(g,b,f){var c=g.gridInfos;var a=Math.floor(b/Tiles.tileSize);var e=Math.floor(f/Tiles.tileSize);var d=null;if(a>=0&&a<g.width&&e>=0&&e<g.height){d=c[a][e]}else{}return d}function rectCollidesWithAnySolidObjects(e,c){var b=[0,0,e.width*Tiles.tileSize,e.height*Tiles.tileSize];var d=rectContainsRect(b,c);if(!d){return true}var a=getSolidGridInfos(e,c);return a.length>0}function getSolidGridInfos(a,g){var k=[];var b=a.gridInfos;var j=Math.floor(g[0]/Tiles.tileSize);var i=Math.floor(g[1]/Tiles.tileSize);var d=Math.floor((g[0]+g[2])/Tiles.tileSize);var c=Math.floor((g[1]+g[3])/Tiles.tileSize);for(var h=j;h<=d;h++){if(h>=0&&h<a.width){for(var f=i;f<=c;f++){if(f>=0&&f<a.height){var e=b[h][f];if(e.solidObjectCellX!=-1){k.push(e)}}}}}return k}function changeLevel(a){currentLevel=a;levelMode=LEVEL_NORMAL_PLAY;stopBossMusic();var e=levels[currentLevel];player.x=e.playerStartX;player.y=e.playerStartY;projectiles.length=0;particles.length=0;enemies.length=0;bosses.length=0;pickups.length=0;textAnimations.length=0;var C=e.gridInfos;var t=0;for(var I=0;I<e.width;I++){for(var G=0;G<e.height;G++){var M=C[I][G];if(M!=null&&M.movingEntity!=null){var l=M.movingEntity;var g=-1;var u=(I+0.5)*Tiles.tileSize;var s=(G+0.5)*Tiles.tileSize;var A=1;var q=1;var f=0;var z=0;var b=80;var p=20;var r=LEFT_RIGHT_PATROL;var v=ATTACK_FOLLOW;var o=300;var N=300;var D=300;var H=0;var d=true;var F=true;var i=true;var c=WHITE_PANTS;var h=WHITE_JACKET;var K=GRAY_HELMET;var E=RIFLE;if(l=="s"){q=0.5;g=SOLDIER_1;r=STILL_PATROL;b=150;d=false;i=false}else{if(l=="S"){q=1;g=SOLDIER_1;K=GRAY_HAT;v=ATTACK_FOLLOW;b=120;z=1;d=false;A=1}else{if(l=="c"){q=2;g=SOLDIER_1;K=GREEN_HAT;v=ATTACK_FOLLOW;b=100;z=2;A=1.2}else{if(l=="e"){q=3;g=SOLDIER_1;K=WHITE_HAT;v=ATTACK_FOLLOW;b=80;z=3;A=1.4}else{if(l=="a"){r=STILL_PATROL;q=1;g=SOLDIER_1;K=BLACK_HOOD;E=ROCKETS;b=150}else{if(l=="d"){q=2;g=SOLDIER_1;K=GREEN_HAT;E=ROCKETS;b=120}else{if(l=="f"){q=3;g=SOLDIER_1;K=GRAY_HAT;E=ROCKETS;b=100;A=1.1}else{if(l=="b"){q=1;r=STILL_PATROL;g=SOLDIER_1;K=BLACK_HOOD;E=GRENADES;b=150;d=false}else{if(l=="g"){q=2;g=SOLDIER_1;K=GREEN_HAT;E=GRENADES;b=120;A=1.1}else{if(l=="h"){q=3;g=SOLDIER_1;K=GRAY_HAT;E=GRENADES;b=100;A=1.2}else{if(l=="B"){b=150;var n=new EnemySoldier(u,s,A,5,f,z,b,p,r,v,o,N,D,H,BOSS_1,BLACK_HOOD,BLACK_PANTS,WHITE_JACKET,GRENADES);n.boss=true;enemies.push(n);bosses.push(n)}else{if(l=="F"){b=150;o=600;var n=new EnemySoldier(u,s,A,8,f,z,b,p,r,v,o,N,D,H,BOSS_2,GRAY_HAT,BLACK_PANTS,GREEN_JACKET,ROCKETS);n.boss=true;enemies.push(n);bosses.push(n)}else{if(l=="I"){o=600;var n=new EnemySoldier(u,s,A,8,f,z,b,p,r,v,o,N,D,H,BOSS_3_1,WHITE_HAT,WHITE_PANTS,GREEN_JACKET,ROCKETS);z=4;A=1.4;var m=new EnemySoldier(u+Tiles.tileSize,s+Tiles.tileSize,A,8,f,z,b,p,r,v,o,N,D,H,BOSS_3_2,RED_HOOD,RED_PANTS,WHITE_JACKET,RIFLE);n.boss=true;m.boss=true;enemies.push(n);enemies.push(m);bosses.push(n);bosses.push(m)}else{if(l=="G"){o=600;var n=new EnemySoldier(u,s,A,10,f,z,b,p,r,v,o,N,D,H,BOSS_4_1,BLACK_HOOD,WHITE_PANTS,GREEN_JACKET,ROCKETS);o=300;A=1.2;var m=new EnemySoldier(u+Tiles.tileSize,s+Tiles.tileSize,A,10,f,z,b,p,r,v,o,N,D,H,BOSS_4_2,RED_HOOD,BLACK_PANTS,WHITE_JACKET,GRENADES);n.boss=true;m.boss=true;enemies.push(n);enemies.push(m);bosses.push(n);bosses.push(m)}else{if(l=="H"){A=1.1;o=600;var n=new EnemySoldier(u,s,A,15,f,z,b,p,r,v,o,N,D,H,BOSS_5_1,RED_HOOD,WHITE_PANTS,WHITE_JACKET,ROCKETS);o=300;var m=new EnemySoldier(u+Tiles.tileSize,s+Tiles.tileSize,A,15,f,z,b,p,r,v,o,N,D,H,BOSS_5_2,RED_HOOD,RED_PANTS,WHITE_JACKET,GRENADES);o=600;var j=new EnemySoldier(u-Tiles.tileSize,s,A,15,f,z,b,p,r,v,o,N,D,H,BOSS_5_3,BLACK_HOOD,WHITE_PANTS,GREEN_JACKET,ROCKETS);n.boss=true;m.boss=true;j.boss=true;enemies.push(n);enemies.push(m);enemies.push(j);bosses.push(n);bosses.push(m);bosses.push(j)}}}}}}}}}}}}}}}if(g!=-1){var O=new EnemySoldier(u,s,A,q,f,z,b,p,r,v,o,N,D,H,g,K,c,h,E);O.canAvoidGrenades=F;O.canAvoidBullets=d;O.canAvoidMissiles=i;enemies.push(O)}}if(M!=null&&M.decorationCellX!=-1){var B=-1;var w=-1;var k=0;if(M.decorationString=="h"){B=0;k=1}else{if(M.decorationString=="r"){B=1;k=5}else{if(M.decorationString=="o"){B=2;k=5}else{if(M.decorationString=="u"){B=3;k=1;t++}else{if(M.decorationString=="i"||M.decorationString=="m"){w=M.particleEmitType}}}}}if(B!=-1){var L=new Pickup((I+0.5)*Tiles.tileSize,(G+0.5)*Tiles.tileSize,B,k,M);pickups.push(L)}if(w!=-1){var J=new EmitParticle((I+0.5)*Tiles.tileSize,(G+0.5)*Tiles.tileSize,0,0,0,0,fireAndSmokeEmitFunction,999999999,10,3,w);particles.push(J)}}}}}function fireAndSmokeEmitFunction(a){return{pos:[a.x,a.y,a.z],vel:[a.vx+Math.random()*1,a.vy+Math.random()*1,a.vz+0.2+Math.random()*3],duration:10+Math.random()*40}}function visibleBetween(a,m,j,g,f){var c=Math.floor(m/Tiles.tileSize);var n=Math.floor(j/Tiles.tileSize);var b=Math.floor(g/Tiles.tileSize);var l=Math.floor(f/Tiles.tileSize);var p=Math.abs(b-c);var o=Math.abs(l-n);var k=1;if(c<b){k=1}else{k=-1}if(n<l){sy=1}else{sy=-1}var e=p-o;var d=a.gridInfos;while(true){if(c>=0&&c<a.width&&n>=0&&n<a.height){var h=d[c][n];if(h.solidObjectCellX!=-1&&!h.canSeeThrough){return false}}if(c==b&&n==l){break}var i=2*e;if(i>-o){e=e-o;c=c+k}if(i<p){e=e+p;n=n+sy}}return true}function addSplash(h,g,f,e,b,n,o,c,d,j,k){for(var q=0;q<e;q++){var s=Math.random()*Math.PI*2;var r=n+o*Math.random();var a=c+d*Math.random();var m=Math.cos(s)*r;var l=Math.sin(s)*r;var p=new NonGasParticle(h,g,f,m,l,a,Math.floor(j+Math.random()*k),b,Math.floor(Math.random()*4));addParticle(p)}}function addDeathSplash(a,b){addSplash(a,b,24,10,LARGE_BLOOD_PARTICLE,0.2,2,0.2,2,50,50);addSplash(a,b,24,10,SMALL_BLOOD_PARTICLE,0.2,2,0.2,2,50,50)}function addDamageSplash(a,e,d){var c=Math.round(d*3);var b=Math.round(d*9);addSplash(a,e,10,c,LARGE_BLOOD_PARTICLE,0.2,2,0.2,2,50,50);addSplash(a,e,10,b,SMALL_BLOOD_PARTICLE,0.2,2,0.2,2,50,50)}function addSmallSplash(a,c,b){addSplash(a,c,0,b,SMALL_WATER_PARTICLE,0.25,1,0.25,1,20,20)}function addLargeSplash(a,c,b){addSplash(a,c,0,b,LARGE_WATER_PARTICLE,0.8,1.5,0.8,1.5,30,30)}function addParticlesInCone(m,k,h,l,j,a,g,e){var o=[l,j];var b=vecLength(o);var n=1+0.2*Math.random()*b;for(var c=0;c<n;c++){var d=vecMultCopy(o,1/b);vecRotate(d,Math.PI+Math.PI*Math.random()-Math.PI*0.5);vecMult(d,g+Math.random()*e);var f=new NonGasParticle(m,k,h,d[0],d[1],1*Math.random()-0.5,100+Math.random()*100,a,Math.floor(Math.random()*4));f.collides=true;addParticle(f)}}function isWater(a){return(a!=null&&a.surfaceTile==1&&a.decorationString!="p")}var bonusInfos=[{points:500,bonus:UPGRADE,given:false},{points:1000,bonus:UPGRADE,given:false},{points:3000,bonus:UPGRADE,given:false},{points:5000,bonus:UPGRADE,given:false},{points:10000,bonus:UPGRADE,given:false},{points:20000,bonus:UPGRADE,given:false},{points:50000,bonus:UPGRADE,given:false},{points:100000,bonus:UPGRADE,given:false},{points:200000,bonus:UPGRADE,given:false},{points:500000,bonus:UPGRADE,given:false}];var player={gatheredPoints:0,securedPoints:0,stepsSinceLastBulletHit:0,bulletHitsInRow:0,securedUpgrades:0,gatheredUpgrades:0,maxGrenadesUpgrades:0,grenadeDamageUpgrades:0,grenadeReloadTimeUpgrades:0,grenadeMaxRangeUpgrades:0,maxRocketsUpgrades:0,rocketDamageUpgrades:0,rocketReloadTimeUpgrades:0,gunDamageUpgrades:0,gunFireRateUpgrades:0,gunReloadTimeUpgrades:0,maxHealthUpgrades:0,weaponIndex:0,maxGrenadeCount:5,grenadeCount:5,maxRocketCount:5,rocketCount:5,health:1,alive:true,maxHealth:1,x:0,y:0,wantedMovementX:0,wantedMovementY:0,fireWanted:false,gunFireCounter:100,grenadeFireCounter:100,rocketFireCounter:100,rocketInAir:false,direction:0,animationState:0,animationCycleDirection:1,fireAnimationCounter:0,firing:false,tick:0,sinkDepth:0,controlledRocket:null,aimDirection:[0,-1],currentGrenadeRange:200,waterAnimations:[],getTotalUpgrades:function(){return this.securedUpgrades+this.maxGrenadesUpgrades+this.grenadeDamageUpgrades+this.grenadeReloadTimeUpgrades+this.grenadeMaxRangeUpgrades+this.maxRocketsUpgrades+this.rocketDamageUpgrades+this.rocketReloadTimeUpgrades+this.gunDamageUpgrades+this.gunFireRateUpgrades+this.gunReloadTimeUpgrades},ammoRefill:function(){this.grenadeCount=this.getMaxGrenadeCount();this.rocketCount=this.getMaxRocketCount()},upgrade:function(){this.gatheredUpgrades++},healthRefill:function(){this.health=this.getMaxHealth()},increasePoints:function(e){this.gatheredPoints+=e;for(var c=0;c<bonusInfos.length;c++){var a=bonusInfos[c];if(!a.given&&a.points<=this.gatheredPoints+this.securedPoints){a.given=true;var b="";switch(a.bonus){case UPGRADE:b="SCORE BONUS: UPGRADE!!";this.upgrade();break;case AMMO_REFILL:b="SCORE BONUS: FULL AMMO + HEALTH!!";this.healthRefill();this.ammoRefill();break}var d=new PlayerConnectedTextAnimation(0,b,60);d.delay=30;addTextAnimation(d)}}},getBulletVelocity:function(a){return 2+a*2},getPointsForBulletDamage:function(a){return Math.round(a*100)},getPointsForExplosionDamage:function(a){return Math.round(a*100)},getGunReloadTime:function(a){return 20-a*2},getGrenadeReloadTime:function(a){return 40-a*4},getRocketReloadTime:function(a){return 100-a*16},getGunDamage:function(a){return 0.2+a*0.06},getGrenadeDamage:function(a){return 1.5+a*0.4},getGrenadeExplosionRadius:function(a){return 100+20*a},getGrenadeMaxRange:function(a){return 200+20*a},getRocketDamage:function(a){return 1.5+a*0.4},getRocketExplosionRadius:function(a){return 100+20*a},getMaxGrenadeCount:function(){return 5+this.maxGrenadesUpgrades*2},getMaxRocketCount:function(){return 5+this.maxRocketsUpgrades*2},getMaxHealth:function(){return 1+0.4*this.maxHealthUpgrades},hit:function(a){this.health-=a;if(this.health<0){this.health=0;this.alive=false;addDeathSplash(player.x,player.y)}},levelComplete:function(){this.securedUpgrades+=this.gatheredUpgrades;this.gatheredUpgrades=0;this.securedPoints+=this.gatheredPoints;this.gatheredPoints=0;for(var b=0;b<bonusInfos.length;b++){var a=bonusInfos[b];a.given=a.points<=this.securedPoints}},softReset:function(){this.weaponIndex=0;this.gatheredUpgrades=0;this.gatheredPoints=0;for(var c=0;c<bonusInfos.length;c++){var b=bonusInfos[c];var a=b.points<=this.securedPoints;b.given=a}this.maxGrenadeCount=this.getMaxGrenadeCount();this.maxRocketCount=this.getMaxRocketCount();this.maxHealth=this.getMaxHealth();this.grenadeCount=this.maxGrenadeCount;this.rocketCount=this.maxRocketCount;this.health=this.maxHealth;this.gunFireCounter=100;this.grenadeFireCounter=100;this.rocketInAir=false;this.direction=1;this.animaitonState=6;this.tick=0;this.stepsSinceLastBulletHit=0;this.bulletHitsInRow=0;this.alive=true;this.currentGrenadeRange=200;this.aimDirection=[0,-1]},hardReset:function(){this.securedPoints=0;for(var b=0;b<bonusInfos.length;b++){var a=bonusInfos[b];a.given=false}this.securedUpgrades=0;this.maxGrenadesUpgrades=0;this.grenadeDamageUpgrades=0;this.grenadeReloadTimeUpgrades=0;this.grenadeMaxRangeUpgrades=0;this.maxRocketsUpgrades=0;this.rocketDamageUpgrades=0;this.rocketReloadTimeUpgrades=0;this.gunDamageUpgrades=0;this.gunFireRateUpgrades=0;this.gunReloadTimeUpgrades=0;this.maxHealthUpgrades=0;this.softReset()}};function paintPlayer(e){if(!player.alive){return}var c=player.direction;var d=player.animationState;for(var a=0;a<player.waterAnimations.length;a++){var b=player.waterAnimations[a];b.paint()}paintAnimatedHumanoid(player.x,player.y,player.animationState,player.direction,0,0,0,player.weaponIndex,player.firing,player.sinkDepth);paintHealthBar(player,scaleUp*(player.x-0.5*Tiles.tileSize-cameraX),scaleUp*(player.y+0.5*Tiles.tileSize-cameraY),scaleUp*Tiles.tileSize,scaleUp*5)}function stepPlayer(c){player.tick++;player.stepsSinceLastBulletHit++;player.firing=player.fireAnimationCounter>0;if(player.firing){player.fireAnimationCounter--}var G=Tiles.tileSize/3;var W=getGridInfo(c,player.x,player.y);if(W==null){logitRnd("unable to get gridinfo for "+(player.x/32)+" "+(player.y/32),0.2);return}if(W.solidObjectCellX!=-1){logitRnd("standing on a solid object "+player.x+" "+player.y,0.2)}if(isWater(W)){if(player.sinkDepth<0.1){addLargeSplash(player.x,player.y,5)}player.sinkDepth=24;if(player.tick%30==0){player.waterAnimations.push(new WaterSurfaceAnimation(player.x,player.y+18))}}else{if(player.sinkDepth>0.1){addSmallSplash(player.x,player.y,5)}player.sinkDepth=0}var P=true;for(var Q=0;Q<player.waterAnimations.length;Q++){var I=player.waterAnimations[Q];if(!I.done){I.step();P=false}}if(P){player.waterAnimations.length=0}var H=0;var F=0;var M=2;var d=false;if(Input.down[Input.leftKey]||Input.down[Input.aKey]){H+=-M;d=true}if(Input.down[Input.rightKey]||Input.down[Input.dKey]){H+=M;d=true}if(Input.down[Input.upKey]||Input.down[Input.wKey]){F+=-M;d=true}if(Input.down[Input.downKey]||Input.down[Input.sKey]){F+=M;d=true}player.wantedMovementX=H;player.wantedMovementY=F;if(controlMode==KEYBOARD_ONLY&&player.controlledRocket!=null){H=0;F=0}var N=1;if(H!=0&&F!=0){N=0.707}if(player.sinkDepth>0){N*=1-player.sinkDepth/64}if(d){if(player.tick%6==0){player.animationState=(player.animationState+1)%6}}else{player.animationState=6}var b=false;if(Input.mouseDown||Input.down[Input.spaceKey]||Input.down[Input.ctrlKey]||Input.down[Input.enterKey]){b=true}player.fireWanted=b;var a=false;if(Input.mouseJustPressed||Input.keyJustPressed(Input.spaceKey)||Input.keyJustPressed(Input.ctrlKey)||Input.keyJustPressed(Input.enterKey)){a=true}if(controlMode==MOUSE_AND_KEYBOARD){var u=Input.mouseX+scaleUp*(cameraX-player.x);var t=-(Input.mouseY+scaleUp*(cameraY-player.y));if(t>=u&&t>=-u){player.direction=1}if(t<=u&&t<=-u){player.direction=2}if(t>=-u&&t<=u){player.direction=0}if(t>=u&&t<=-u){player.direction=3}}else{if(controlMode==KEYBOARD_ONLY){var p=b||Input.down[Input.altKey];if((H!=0||F!=0)&&!p){player.aimDirection=vecNormalize([H,F]);if(H==0){if(F>0){player.direction=2}else{if(F<0){player.direction=1}}}else{if(F==0){if(H>0){player.direction=0}else{if(H<0){player.direction=3}}}else{switch(player.direction){case 0:if(H>0){}else{if(H<0){player.direction=3}}break;case 3:if(H<0){}else{if(H>0){player.direction=0}}break;case 1:if(F<0){}else{player.direction=2}case 2:if(F>0){}else{player.direction=1}}}}}else{}}}if(d){var B=player.x+N*H;var A=player.y+N*F;var f=false;var e=false;var x=[player.x-G,player.y-G,G*2,G*2];var o=getSolidGridInfos(c,x);if(o.length>0){logitRnd("player intersecting solid object",1)}var X=rectTranslateCopy(x,N*H,N*F);var r=getSolidGridInfos(c,X);if(rectCollidesWithAnySolidObjects(c,X)){X=rectTranslateCopy(x,N*H,0);if(rectCollidesWithAnySolidObjects(c,X)){X=rectTranslateCopy(x,0,N*F);if(rectCollidesWithAnySolidObjects(c,X)){}else{e=true}}else{f=true}}else{f=true;e=true}if(f){player.x=B}if(e){player.y=A}}if(Input.keyJustPressed(Input.eKey)||Input.rightMouseJustPressed||Input.keyJustPressed(Input.bKey)){player.weaponIndex=(player.weaponIndex+1)%3}if(Input.keyJustPressed(Input.qKey)||Input.keyJustPressed(Input.vKey)){player.weaponIndex--;if(player.weaponIndex<0){player.weaponIndex=2}}if(Input.down[Input.oneKey]||Input.down[Input.zKey]){player.weaponIndex=0}if(Input.down[Input.twoKey]||Input.down[Input.xKey]){if(controlMode==KEYBOARD_ONLY){player.currentGrenadeRange+=2;if(player.currentGrenadeRange>player.getGrenadeMaxRange(player.grenadeMaxRangeUpgrades)){player.currentGrenadeRange=64}}player.weaponIndex=1}if(Input.down[Input.threeKey]||Input.down[Input.cKey]){player.weaponIndex=2}if(b||a){var v=player.getGunReloadTime(player.gunReloadTimeUpgrades);var R=player.getGrenadeReloadTime(player.grenadeReloadTimeUpgrades);var S=player.getRocketReloadTime(player.rocketReloadTimeUpgrades);var j=22;var O=Math.round(Math.min(100,Math.max(-100,200*(player.x/canvas.width)-100)));var E=Input.mouseX;var C=Input.mouseY;if(controlMode==KEYBOARD_ONLY){E=player.x-cameraX+player.currentGrenadeRange*player.aimDirection[0];C=player.y-cameraY+player.currentGrenadeRange*player.aimDirection[1]-j+player.sinkDepth}var V=E+scaleUp*(cameraX-player.x);var U=C+scaleUp*(cameraY-player.y+j-player.sinkDepth);var L=V/scaleUp;var K=U/scaleUp;var s=Math.sqrt(L*L+K*K);var m=L/s;var k=K/s;switch(player.weaponIndex){case 0:if(player.gunFireCounter>=v){player.gunFireCounter=0;var l=10;if(s>0.1){var h=new Bullet(player.x,player.y,j-player.sinkDepth,l*m,l*k,0,-1,100,player.gunDamageUpgrades);var T=addProjectile(h);if(T){var g=Sound.gunSoundCounter%3;var w=Sound.GUN_1_ID+g;Sound.play(w,{volume:20,pan:O});Sound.gunSoundCounter=(Sound.gunSoundCounter+1)%3;player.gunFireCounter++;player.fireAnimationCounter=5;player.firing=true}}}else{player.gunFireCounter++}break;case 1:if(player.grenadeFireCounter>=R){if(player.grenadeCount>0){var D=4;player.grenadeFireCounter=0;var z=player.getGrenadeMaxRange(player.grenadeMaxRangeUpgrades);var n=Math.min(z,s);var J=new Grenade(player.x,player.y,j-player.sinkDepth,D*m,D*k,0,-1,100,n,player.grenadeDamageUpgrades);player.fireAnimationCounter=15;player.firing=true;var T=addProjectile(J);if(T){player.grenadeFireCounter++;Sound.play(Sound.GRENADE_THROW_ID,{volume:20,pan:O})}player.grenadeCount--}else{Sound.play(Sound.WEAPON_CLICK_ID);addTextAnimation(new PlayerConnectedTextAnimation(1,"NO GRENADES",40));player.grenadeFireCounter=10}}else{player.grenadeFireCounter++}break;case 2:if(a&&player.rocketFireCounter>=S){if(player.rocketCount>0){player.rocketFireCounter=0;var q=4;var y=new Rocket(player.x,player.y,j-player.sinkDepth,q*m,q*k,0,-1,200,player.rocketDamageUpgrades);var T=addProjectile(y);player.rocketCount--;player.fireAnimationCounter=7;player.firing=true;if(T){player.rocketFireCounter++;Sound.play(Sound.ROCKET_LAUNCH_ID,{volume:40,pan:O})}}else{Sound.play(Sound.WEAPON_CLICK_ID);addTextAnimation(new PlayerConnectedTextAnimation(1,"NO ROCKETS",40));player.rocketFireCounter=10}}else{player.rocketFireCounter++}break}}else{player.grenadeFireCounter++;player.gunFireCounter++;player.rocketFireCounter++}}function paintReticleCross(f,d,a,c,e){ctx.beginPath();var b=ctx.globalAlpha;ctx.globalAlpha=0.5*b;ctx.strokeStyle=e;ctx.lineWidth=2*scaleUp;ctx.arc(f,d,a,0,2*Math.PI,false);ctx.stroke();ctx.moveTo(f-c,d);ctx.lineTo(f+c,d);ctx.moveTo(f,d-c);ctx.lineTo(f,d+c);ctx.globalAlpha=b;ctx.stroke()}function paintReticle(a){var t="#00ff00";switch(player.weaponIndex){case 0:var m=player.getGunReloadTime(player.gunReloadTimeUpgrades);ctx.beginPath();var d=ctx.globalAlpha;ctx.globalAlpha=0.75;ctx.strokeStyle="#00ff00";var x=scaleUp*(player.x-cameraX);var u=scaleUp*(player.y-22-cameraY+player.sinkDepth);var e=Input.mouseX;var c=Input.mouseY;if(controlMode==KEYBOARD_ONLY){e=x+player.aimDirection[0]*150*scaleUp;c=u+player.aimDirection[1]*150*scaleUp}var y=15;for(var v=0;v<y;v++){var g=v/(y-1);var B=x*g+(1-g)*e;var A=u*g+(1-g)*c;if((v%4)!=3){ctx.moveTo(B,A)}else{if((v%4)==3){ctx.lineTo(B,A)}}}ctx.stroke();ctx.globalAlpha=d;paintReticleCross(e,c,15*scaleUp,18*scaleUp,"#00ff00");break;case 1:var C=player.getGrenadeReloadTime(player.grenadeReloadTimeUpgrades);var x=scaleUp*(player.x-cameraX);var u=scaleUp*(player.y-cameraY);var e=Input.mouseX;var c=Input.mouseY;if(controlMode==KEYBOARD_ONLY){e=x+player.aimDirection[0]*player.currentGrenadeRange*scaleUp;c=u+player.aimDirection[1]*player.currentGrenadeRange*scaleUp}var E=e-x;var D=c-u;var s=E/scaleUp;var r=D/scaleUp;var f=vecLength([s,r]);if(f>0.1){var k=s/f;var j=r/f;var p=player.getGrenadeMaxRange(player.grenadeMaxRangeUpgrades);var l=Math.min(p,f);if(player.grenadeCount==0){t="#ff0000"}else{if(player.grenadeFireCounter<C){t="#ffff00"}}if(f>p+30){ctx.globalAlpha=0.5;paintReticleCross(e,c,15*scaleUp,18*scaleUp,t);ctx.globalAlpha=1}var o=x+k*l*scaleUp;var n=u+j*l*scaleUp;paintReticleCross(o,n,15*scaleUp,18*scaleUp,t);ctx.beginPath();var y=15;for(var v=0;v<y;v++){var g=v/(y-1);var B=x*g+(1-g)*o;var A=u*g+(1-g)*n;var q=l*getGrenadeNormalizedZ(g)*scaleUp;A-=q;if((v%2)==0){ctx.moveTo(B,A)}else{if((v%2)==1){ctx.lineTo(B,A)}}}ctx.stroke()}break;case 2:var b=player.getRocketReloadTime(player.rocketReloadTimeUpgrades);if(player.rocketCount==0){t="#ff0000"}else{if(player.rocketFireCounter<b){t="#ffff00"}}if(controlMode==MOUSE_AND_KEYBOARD){var h=player.controlledRocket;if(h!=null&&h.controlled){ctx.beginPath();var d=ctx.globalAlpha;ctx.globalAlpha=0.75;ctx.strokeStyle="#ff0000";var z=scaleUp*(h.x-cameraX);var w=scaleUp*(h.y-h.z-cameraY);var y=15;for(var v=0;v<y;v++){var g=v/(y-1);var B=z*g+(1-g)*Input.mouseX;var A=w*g+(1-g)*Input.mouseY;if((v%2)==0){ctx.moveTo(B,A)}else{if((v%2)==1){ctx.lineTo(B,A)}}}ctx.stroke();ctx.globalAlpha=d}}var e=Input.mouseX;var c=Input.mouseY;if(controlMode==KEYBOARD_ONLY){var x=scaleUp*(player.x-cameraX);var u=scaleUp*(player.y-cameraY);e=x+player.aimDirection[0]*150*scaleUp;c=u+player.aimDirection[1]*150*scaleUp}paintReticleCross(e,c,15*scaleUp,18*scaleUp,t);break}if(controlMode==KEYBOARD_ONLY){ctx.globalAlpha=0.5;paintReticleCross(Input.mouseX,Input.mouseY,15*scaleUp,18*scaleUp,t);ctx.globalAlpha=1}}function Force(a){this.duration=a}Force.prototype.applyForce=function(a){};function ExplosionForce(b,f,e,d,a,c){Force.call(this,c);this.x=b;this.y=f;this.z=e;this.maxForce=d;this.radius=a}ExplosionForce.prototype=new Force();ExplosionForce.prototype.step=function(d){for(var b=0;b<enemies.length;b++){var a=enemies[b];var c=distanceBetween(a.x,a.y,this.x,this.y);if(c<=this.radius){}}this.duration--};function Bot(e,c,n,g,m,f,p,h,a,s,l,i,d,r,k,b,o,j,q){this.x=e;this.y=c;this.maxVelocity=n;this.health=g;this.ammoDamageLevel=m;this.ammoVelocity=f;this.fireInterval=p;this.aimError=h;this.patrolBehavior=a;this.attackBehavior=s;this.fireDistance=l;this.attackDistance=i;this.attackReturnDistance=d;this.smartnessLevel=r;this.id=k;this.headType=b;this.legType=o;this.bodyType=j;this.weaponType=q;this.canAvoidGrenades=true;this.canAvoidMissiles=true;this.canAvoidBullets=true;this.direction=0;this.waterAnimations=[];this.boss=false;this.bossName="BOSS";this.vx=0;this.vy=0;this.alive=true;this.actionCounter=1;this.fireCounter=0;this.searchCounter=0;this.maxHealth=g;this.width=Tiles.tileSize*0.8;this.height=Tiles.tileSize*0.8;this.state=PATROL;this.attackState=VISIBLE_ATTACK;this.patrolState=0;this.patrolCounter=0;this.searchCounter=0;this.lastSeenX=0;this.lastSeenY=0;this.wasHit=false;this.animationState=0;this.fireAnimationCounter=0;this.firing=false;this.sinkDepth=0;this.tick=0}Bot.prototype.paint=function(){if(this.alive){if(this.boss&&this.state==ATTACK){var a=0.25*Tiles.tileSize*(0.5*Math.sin(this.tick/20)+1.5);paintBossTarget(scaleUp*(this.x-cameraX),scaleUp*(this.y-cameraY),scaleUp*a,scaleUp*a*1.2)}paintHealthBar(this,scaleUp*(this.x-0.5*Tiles.tileSize-cameraX),scaleUp*(this.y+0.5*Tiles.tileSize-cameraY),Tiles.tileSize*scaleUp,5*scaleUp);for(var b=0;b<this.waterAnimations.length;b++){var c=this.waterAnimations[b];c.paint()}paintAnimatedHumanoid(this.x,this.y,this.animationState,this.direction,this.headType,this.bodyType,this.legType,this.weaponType,this.firing,this.sinkDepth)}};Bot.prototype.getRect=function(){return[this.x-this.width*0.5,this.y-this.height*0.5,this.width,this.height]};Bot.prototype.getDirectionFromVec=function(b){var a=b[0];var c=b[1];if(c>=a&&c>=-a){return 2}if(c<=a&&c<=-a){return 1}if(c>=-a&&c<=a){return 0}if(c>=a&&c<=-a){return 3}return 0};Bot.prototype.getProjectileField=function(e){var p=[0,0];for(var m=0;m<projectiles.length;m++){var h=projectiles[m];if(h==null){continue}var a=h.owner==-1;if(h instanceof Grenade&&this.canAvoidGrenades){var g=vecMinusCopy([h.x,h.y],[this.x,this.y]);var f=vecLength(g);var k=player.getGrenadeExplosionRadius(h.damageLevel);if(f>0.1&&f<k){vecMult(g,-1/f);var o=0.1+1-f/k;vecMult(g,o);vecPlus(p,g)}}else{if(a&&((this.canAvoidMissiles&&h instanceof Rocket)||(this.canAvoidBullets&&h instanceof Bullet))){var g=vecMinusCopy([h.x,h.y],[this.x,this.y]);var f=vecLength(g);if(f<300){vecMult(g,-1/f);var d=vecNormalize([h.vx,h.vy]);var c=vecDot(d,g);var l=vecCrossValue(d,g);var n=Math.abs(l);if(c>0&&n<0.3){var b=l/0.3;if(b>=0){b+=0.1}else{b-=0.1}var j=vecCrossWithZ(d);vecMult(j,b);vecPlus(p,j)}}}}}return p};Bot.prototype.getAvoidFriendsField=function(g){var a=[0,0];for(var e=0;e<enemies.length;e++){var c=enemies[e];if(c!==this){var b=[c.x-this.x,c.y-this.y];var f=vecLength(b);if(f<0.01){vecPlus(a,[0.1*Math.random()-0.05,0.1*Math.random()-0.05])}if(f<Tiles.tileSize*1.5){vecMult(b,-1/f);var d=1-f/(Tiles.tileSize*1.5);vecMult(b,0.1);vecPlus(a,b)}}}return a};Bot.prototype.updateVelocityAfterThreat=function(h,a){var e=this.getProjectileField(h);var b=this.getAvoidFriendsField(h);var c=[3*this.maxVelocity*(e[0]+b[0]),3*this.maxVelocity*(e[1]+b[1])];vecPlus(c,a);var g=vecLength(c);if(g>0.01){vecNormalize(c)}var f=[this.x-this.width*0.5+this.maxVelocity*c[0]*2,this.y-this.height*0.5+this.maxVelocity*c[1]*2,this.width,this.height];if(rectCollidesWithAnySolidObjects(h,f)){f=[this.x-this.width*0.5,this.y-this.height*0.5+this.maxVelocity*c[1]*2,this.width,this.height];if(rectCollidesWithAnySolidObjects(h,f)){f=[this.x+this.maxVelocity*c[0]*2,this.y,this.width,this.height];if(rectCollidesWithAnySolidObjects(h,f)){c[0]=0;c[1]=0}else{c[0]=this.maxVelocity*c[0];c[1]=0}}else{c[0]=0;c[1]=this.maxVelocity*c[1]}}var g=vecLength(c);if(g>0.01){vecNormalize(c);vecMult(c,this.maxVelocity)}var d=1;if(this.sinkDepth>0.01){d*=1-this.sinkDepth/64}this.vx=c[0]*d;this.vy=c[1]*d};Bot.prototype.attack=function(g){var d=vecMinus([player.x,player.y],[this.x,this.y]);var f=vecLength(d);if(visibleBetween(g,player.x,player.y,this.x,this.y)){this.attackState=VISIBLE_ATTACK;this.lastSeenX=player.x;this.lastSeenY=player.y;this.searchCounter=0}else{this.attackState=SEARCHING_ATTACK}if(this.attackState==VISIBLE_ATTACK){this.direction=this.getDirectionFromVec(d);switch(this.attackBehavior){case ATTACK_STAY:this.vx=0;this.vy=0;break;case ATTACK_FOLLOW:case ATTACK_FOLLOW_NO_PATROL:var c=vecNormalizeCopy(d);this.vx=c[0]*this.maxVelocity;this.vy=c[1]*this.maxVelocity;if(f<5*Tiles.tileSize){this.vx*=-1;this.vy*=-1}else{if(f<7*Tiles.tileSize){this.vx=0;this.vy=0}}}}else{this.searchCounter++;if(this.searchCounter>10){this.state=PATROL;this.vx=0;this.vy=0}else{var b=vecMinus([this.lastSeenX,this.lastSeenY],[this.x,this.y]);var e=vecLength(b);if(e>Tiles.tileSize){vecMult(b,1/e);this.vx=b[0]*this.maxVelocity;this.vy=b[1]*this.maxVelocity}else{this.vx=0;this.vy=0}this.direction=this.getDirectionFromVec(b)}}var a=[this.vx,this.vy];this.updateVelocityAfterThreat(g,a)};Bot.prototype.patrol=function(d){var b=vecMinus([player.x,player.y],[this.x,this.y]);var c=vecLength(b);if(c<this.attackDistance){if(visibleBetween(d,player.x,player.y,this.x,this.y)){this.state=ATTACK;this.fireCounter=this.fireInterval/2;this.lastSeenX=player.x;this.lastSeenY=player.y;return}}switch(this.patrolBehavior){case STILL_PATROL:this.vx=0;this.vy=0;break;case LEFT_RIGHT_PATROL:if(this.collidedDuringMovement){this.patrolState=(this.patrolState+1)%2}if(this.patrolState==0){this.vx=-this.maxVelocity;this.vy=0}else{this.vx=this.maxVelocity;this.vy=0}break;case UP_DOWN_PATROL:if(this.collidedDuringMovement){this.patrolState=(this.patrolState+1)%2}if(this.patrolState==0){this.vy=-this.maxVelocity;this.vx=0}else{this.vy=this.maxVelocity;this.vx=0}break;case SQUARE_CW_PATROL:if(this.collidedDuringMovement){this.patrolState=(this.patrolState+1)%4}switch(this.patrolState){case 0:this.vx=this.maxVelocity;this.vy=0;break;case 1:this.vy=this.maxVelocity;this.vx=0;break;case 2:this.vx=-this.maxVelocity;this.vy=0;break;case 3:this.vy=-this.maxVelocity;this.vx=0;break}break;case SQUARE_CCW_PATROL:if(this.collidedDuringMovement){this.patrolState=(this.patrolState+1)%4}switch(this.patrolState){case 0:this.vx=-this.maxVelocity;this.vy=0;break;case 1:this.vy=this.maxVelocity;this.vx=0;break;case 2:this.vx=this.maxVelocity;this.vy=0;break;case 3:this.vy=-this.maxVelocity;this.vx=0;break}break}var a=[this.vx,this.vy];this.direction=this.getDirectionFromVec(a);this.updateVelocityAfterThreat(d,a)};Bot.prototype.fire=function(b){this.fireCounter++;if(this.state==ATTACK&&this.attackState==VISIBLE_ATTACK){if(this.fireCounter>this.fireInterval){var p=vecMinus([player.x,player.y],[this.x,this.y]);var c=vecLength(p);if(c<this.fireDistance){vecRotate(p,Math.random()*0.2-0.1);var n=vecNormalize(p);var l=this.weaponType;if(l==RIFLE){vecMult(n,2+2*this.ammoVelocity);var a=new Bullet(this.x,this.y,28-this.sinkDepth,n[0],n[1],0,1,200,this.ammoDamageLevel);addProjectile(a);var d=Sound.gunSoundCounter%3;var j=Sound.GUN_1_ID+d;var g=30*(100/(100+c));Sound.play(j,{volume:g});Sound.gunSoundCounter=(Sound.gunSoundCounter+1)%3;this.fireAnimationCounter=5;this.firing=true}else{if(l==GRENADES){var f=4;var k=player.getGrenadeMaxRange(0);var e=Math.min(k,c);var i=new Grenade(this.x,this.y,28-this.sinkDepth,f*n[0],f*n[1],0,0,100,e,this.ammoDamageLevel);addProjectile(i);this.fireAnimationCounter=15;this.firing=true;var g=50*(100/(100+c));Sound.play(Sound.GRENADE_THROW_ID,{volume:g})}else{if(l==ROCKETS){var o=3;var h=player.getRocketExplosionRadius(this.ammoDamageLevel);if(visibleBetween(b,this.x,this.y,this.x+h*n[0],this.y+h*n[1])){var m=new Rocket(this.x,this.y,28-this.sinkDepth,o*n[0],o*n[1],0,0,100,this.ammoDamageLevel);addProjectile(m);this.fireAnimationCounter=7;this.firing=true;var g=50*(100/(100+c));Sound.play(Sound.ROCKET_LAUNCH_ID,{volume:g})}}}}}this.fireCounter=Math.random()*10}}};Bot.prototype.move=function(d){if(this.state!=IDLE){var c=this.x+this.vx;var a=this.y+this.vy;var b=[c-this.width*0.5,a-this.height*0.5,this.width,this.height];if(rectCollidesWithAnySolidObjects(d,b)){this.collidedDuringMovement=true}else{this.collidedDuringMovement=false;this.x=c;this.y=a}}};Bot.prototype.action=function(c){this.actionCounter++;if(this.actionCounter>Tiles.tileSize/(this.maxVelocity*2)){var a=vecMinus([player.x,player.y],[this.x,this.y]);var b=vecLength(a);if(b>1000&&this.state==PATROL){this.state=IDLE}else{if(this.state==IDLE&&b<1000){this.state=PATROL}}if(this.wasHit){this.wasHit=false;if((this.state==PATROL||this.state==IDLE)&&visibleBetween(c,player.x,player.y,this.x,this.y)){this.state=ATTACK;this.fireCounter=this.fireInterval/2;this.lastSeenX=player.x;this.lastSeenY=player.y}}if(this.state==ATTACK){this.attack(c)}if(this.state==PATROL){this.patrol(c)}this.actionCounter=0}};Bot.prototype.step=function(f){if(!this.alive){return}this.move(f);this.fire(f);this.action(f);var a=Math.abs(this.vx)>0.01||Math.abs(this.vy)>0.01;if(a){if(this.tick%6==0){this.animationState=(this.animationState+1)%6}}else{this.animationState=6}this.tick++;var d=getGridInfo(f,this.x,this.y);if(isWater(d)){if(this.sinkDepth<0.1){addLargeSplash(this.x,this.y,5)}this.sinkDepth=24;if(this.tick%30==0){this.waterAnimations.push(new WaterSurfaceAnimation(this.x,this.y+18))}}else{if(this.sinkDepth>0.1){addSmallSplash(this.x,this.y,5)}this.sinkDepth=0}var b=true;for(var c=0;c<this.waterAnimations.length;c++){var e=this.waterAnimations[c];if(!e.done){e.step();b=false}}if(b){this.waterAnimations.length=0}this.firing=this.fireAnimationCounter>0;if(this.firing){this.fireAnimationCounter--}};Bot.prototype.hit=function(a){this.health-=a;if(this.health<=0){this.alive=false;addDeathSplash(this.x,this.y)}this.wasHit=true};function EnemySoldier(e,c,n,g,m,f,p,h,a,s,l,i,d,r,k,b,o,j,q){Bot.call(this,e,c,n,g,m,f,p,h,a,s,l,i,d,r,k,b,o,j,q)}EnemySoldier.prototype=new Bot();function paintBossTarget(e,d,a,c){var b=ctx.globalAlpha;ctx.beginPath();ctx.globalAlpha=0.5;ctx.strokeStyle="#ff0000";ctx.lineWidth=2*scaleUp;ctx.arc(e,d,a,0,2*Math.PI,false);ctx.stroke();ctx.moveTo(e-c,d);ctx.lineTo(e+c,d);ctx.moveTo(e,d-c);ctx.lineTo(e,d+c);ctx.stroke();ctx.globalAlpha=b}function Projectile(i,g,e,h,f,d,a,c,b){this.x=i;this.y=g;this.z=e;this.vx=h;this.vy=f;this.vz=d;this.owner=a;this.duration=c;this.damageLevel=b;this.lastFreeX=i;this.lastFreeY=g}Projectile.prototype.hitMovingObject=function(a){this.duration=0};Projectile.prototype.hitSolidObject=function(e){this.duration=0;var f=Tiles.tileSize;var a=Math.floor(this.x/f);var g=Math.floor(this.y/f);var d=[0,0];var c=[0,0];collisionResponse([a*f,g*f,f,f],[oldX,oldY],[this.x,this.y],d,c);var b=SMALL_STONE_PARTICLE;if(e.solidParticleType){b=e.solidParticleType}};Projectile.prototype.endOfDuration=function(){};Projectile.prototype.paint=function(){var b=scaleUp*(this.x-cameraX);var a=scaleUp*(this.y-cameraY-this.z);if(ImageHandler.allLoaded){ctx.save();var c=Math.atan2(this.vy,this.vx);ctx.translate(b,a);ctx.rotate(c);ctx.translate(-8*scaleUp,-8*scaleUp);ctx.drawImage(ImageHandler.images.projectiles,0,16*2,16,16,0,0,16*scaleUp,16*scaleUp);ctx.restore()}};Projectile.prototype.step=function(a){this.x+=this.vx;this.y+=this.vy;this.z+=this.vz;this.duration--;if(this.duration==0){this.endOfDuration()}var g=getGridInfo(a,this.x,this.y);if(g!=null&&g.solidObjectCellX!=-1&&!g.canSeeThrough){this.hitSolidObject(g)}else{this.lastFreeX=this.x;this.lastFreeY=this.y}if(this.owner!=-1){var j=player.x-this.x;var h=player.y-this.y;var b=Math.sqrt(j*j+h*h);var e=Tiles.tileSize/1.8;if(b<e){this.hitMovingObject(player)}}else{for(var f=0;f<enemies.length;f++){var c=enemies[f];if(!c.alive){continue}var j=c.x-this.x;var h=c.y-this.y;var b=Math.sqrt(j*j+h*h);var d=Tiles.tileSize/1.5;if(b<d){this.hitMovingObject(c)}}}};function Bullet(i,g,e,h,f,d,a,c,b){Projectile.call(this,i,g,e,h,f,d,a,c,b)}Bullet.prototype=new Projectile();Bullet.prototype.hitMovingObject=function(b){var d=player.getGunDamage(this.damageLevel);var h=1;if(this.owner==-1){var c=player.getPointsForBulletDamage(d);if(player.bulletHitsInRow==0||player.stepsSinceLastBulletHit<100){player.bulletHitsInRow++;var a=player.bulletHitsInRow;if(a%10==0){var h=Math.round(a/10);addTextAnimation(new PlayerConnectedTextAnimation(0,"COMBO X"+a,70))}if(a==50){var e=new PlayerConnectedTextAnimation(0,"COMBO X"+a+": HEALTH REFILL!!",70);e.delay=40;player.healthRefill();addTextAnimation(e)}else{if(a==75||a==200||a==1000||a==2000||a==4000){var e=new PlayerConnectedTextAnimation(0,"COMBO X"+a+": UPGRADE!!",70);e.delay=40;player.upgrade();addTextAnimation(e)}else{if(a==100||a==500||a==3000||a==5000){var e=new PlayerConnectedTextAnimation(0,"COMBO X"+a+": EXTRA LIFE!!",70);e.delay=40;player.extraLife();addTextAnimation(e)}}}}else{player.bulletHitsInRow=1}player.stepsSinceLastBulletHit=0;player.increasePoints(c);if(h>1){addTextAnimation(new PointsTextAnimation(this.x,this.y,this.z,""+c+" X"+h,70))}else{addTextAnimation(new PointsTextAnimation(this.x,this.y,this.z,""+c,20))}}this.addParticles(SMALL_BLOOD_PARTICLE,0.2,1);b.hit(d);this.duration=0;var f=vecLength([player.x-this.x,player.y-this.y]);var g=50;if(f>0.1){g=50*(100/(100+f))}Sound.play(Sound.HIT_PERSON_ID,{volume:g})};Bullet.prototype.hitSolidObject=function(c){this.duration=0;var a=SMALL_STONE_PARTICLE;if(c.solidParticleType){a=c.solidParticleType}this.addParticles(a,0.2,3);var d=vecLength([player.x-this.x,player.y-this.y]);var e=50;if(d>0.1){e=50*(100/(100+d))}var b=Sound.HIT_STONE_ID;switch(a){case SMALL_STONE_PARTICLE:b=Sound.HIT_STONE_ID;break;case SMALL_WOOD_PARTICLE:b=Sound.HIT_WOOD_ID;break;case GREEN_LEAF_PARTICLE:b=Sound.HIT_LEAVES_ID;break}Sound.play(b,{volume:e})};Bullet.prototype.addParticles=function(a,g,e){var j=[this.vx,this.vy];var b=vecLength(j);var h=2+0.2*Math.random()*b;for(var c=0;c<h;c++){var d=vecMultCopy(j,1/b);vecRotate(d,Math.PI+Math.PI*Math.random()-Math.PI*0.5);vecMult(d,g+Math.random()*e);var f=new NonGasParticle(this.x,this.y,this.z,d[0],d[1],1*Math.random()-0.5,100+Math.random()*100,a,Math.floor(Math.random()*4));f.collides=true;addParticle(f)}};function Grenade(j,h,f,i,g,e,a,d,c,b){Projectile.call(this,j,h,f,i,g,e,a,d,b);this.startZ=f;this.distanceTravelled=0;this.targetDistance=c;this.inWater=false}Grenade.prototype=new Projectile();Grenade.prototype.paint=function(){if(this.inWater){return}var b=scaleUp*(this.x-cameraX-8);var a=scaleUp*(this.y-this.z-cameraY-8);if(ImageHandler.allLoaded){ctx.drawImage(ImageHandler.images.projectiles,0,3*16,16,16,b,a,scaleUp*16,scaleUp*16)}};Grenade.prototype.step=function(e){var d=this.x;var c=this.y;Projectile.prototype.step.call(this,e);if(this.distanceTravelled>this.targetDistance){this.x=d;this.y=c;this.z=0;if(!this.inWater){var b=getGridInfo(e,this.x,this.y);if(isWater(b)){this.inWater=true;addLargeSplash(this.x,this.y,3)}}}else{this.distanceTravelled+=Math.sqrt(this.vx*this.vx+this.vy*this.vy);var a=this.distanceTravelled/this.targetDistance;this.z=(1-a)*this.startZ+a*this.startZ+this.targetDistance*getGrenadeNormalizedZ(a)}};Grenade.prototype.hitMovingObject=function(a){};Grenade.prototype.hitSolidObject=function(d){var e=Tiles.tileSize;if(this.z<d.solidObjectHeight*e){var a=Math.floor(this.x/e);var f=Math.floor(this.y/e);var c=[0,0];var b=[0,0];collisionResponse([a*e,f*e,e,e],[this.x-this.vx,this.y-this.vy],[this.x,this.y],c,b);this.vx=b[0];this.vy=b[1]}};Grenade.prototype.endOfDuration=function(){if(this.inWater){addSplash(this.x,this.y,0,30,LARGE_WATER_PARTICLE,0.8,1,3,2)}else{addExplosion(this.x,this.y,this.z,1,player.getGrenadeDamage(this.damageLevel),player.getGrenadeExplosionRadius(this.damageLevel),10,this.owner,1)}};function Rocket(i,g,e,h,f,d,a,c,b){Projectile.call(this,i,g,e,h,f,d,a,c,b);this.initVx=h;this.initVy=f;this.controlled=a==-1;this.tricky=false}Rocket.prototype=new Projectile();Rocket.prototype.paint=function(){var b=scaleUp*(this.x-cameraX);var a=scaleUp*(this.y-cameraY-this.z);if(ImageHandler.allLoaded){ctx.save();var c=Math.atan2(this.vy,this.vx);ctx.translate(b,a);ctx.rotate(c);ctx.translate(-16*scaleUp,-16*scaleUp);ctx.drawImage(ImageHandler.images.projectiles,0,0,32,32,0,0,32*scaleUp,32*scaleUp);ctx.restore()}};Rocket.prototype.step=function(h){Projectile.prototype.step.call(this,h);var g=vecNormalize([this.vx,this.vy]);var e=0.02;this.vx+=g[0]*e;this.vy+=g[1]*e;if(this.controlled&&this.owner==-1&&!player.fireWanted){this.controlled=false;player.controlledRocket=null}if(this.owner==-1&&this.controlled){player.controlledRocket=this;var a=null;if(controlMode==MOUSE_AND_KEYBOARD){a=vecMinus([Input.mouseX+scaleUp*cameraX,Input.mouseY+scaleUp*cameraY],[scaleUp*this.x,scaleUp*this.y])}else{if(controlMode==KEYBOARD_ONLY){a=[player.wantedMovementX,player.wantedMovementY]}}if(vecLength(a)>0.01){var f=vecNormalize(a);var b=vecDot(g,f);var d=0.2;this.vx+=f[0]*d;this.vy+=f[1]*d;if(!this.tricky){var c=vecDot(vecNormalize([this.vx,this.vy]),vecNormalize([this.initVx,this.initVy]));if(c<=0.4){this.tricky=true}}}}if((this.duration%3)==0){addParticle(new SmokeParticle(this.x,this.y,this.z,(Math.random()*0.3-0.2)*this.vx,(Math.random()*0.3-0.2)*this.vy,0.1,60))}};Rocket.prototype.explode=function(b){if(this.tricky){b*=2}var a=addExplosion(this.lastFreeX,this.lastFreeY,this.z,1,player.getRocketDamage(this.damageLevel),player.getRocketExplosionRadius(this.damageLevel),10,this.owner,b);this.duration=0;if(this.controlled&&this.owner==-1){player.controlledRocket=null}this.controlled=false;return a};Rocket.prototype.hitMovingObject=function(a){var d=2;if(this.owner==-1){var b="DIRECT HIT!";if(this.tricky){b="TRICK SHOT!!!";d=3}var c=new PlayerConnectedTextAnimation(0,b,70);addTextAnimation(c)}this.explode(d)};Rocket.prototype.hitSolidObject=function(b){var e=1;var d=null;if(this.tricky){var c="INDIRECT TRICK SHOT!!";d=new PlayerConnectedTextAnimation(0,c,70);e=2}var a=this.explode(e);if(a>0&&d!=null){addTextAnimation(d)}};Rocket.prototype.endOfDuration=function(){var d=1;var c=null;if(this.tricky){var b="TIMED TRICK SHOT!!";c=new PlayerConnectedTextAnimation(0,b,70);d=2}var a=this.explode(d);if(a>0&&c!=null){addTextAnimation(c)}};function getGrenadeNormalizedZ(a){return 0.5*(1-(2*a-1)*(2*a-1))}function Particle(a,g,f,d,c,b,e){this.x=a;this.y=g;this.z=f;this.vx=d;this.vy=c;this.vz=b;this.duration=e;this.initialDuration=e;this.radius=3;this.collides=false;this.destroys=false;this.hasDestroyed=false}Particle.prototype.step=function(){if(this.collides&&!this.hasDestroyed){var c=levels[currentLevel];var b=getGridInfo(c,this.x+this.vx*4,this.y+this.vy*4);if(b!=null&&b.solidObjectCellX!=-1){if(this.destroys&&!this.hasDestroyed){this.hasDestroyed=true;var a=LARGE_STONE_PARTICLE;switch(b.solidParticleType){case SMALL_STONE_PARTICLE:a=LARGE_STONE_PARTICLE;break;case SMALL_WOOD_PARTICLE:a=LARGE_WOOD_PARTICLE;break;default:a=b.solidParticleType;break}addParticlesInCone(this.x,this.y,this.z+10+Math.random()*10,this.vx*0.5,this.vy*0.5,a,0.2,1)}this.vx=0;this.vy=0}}this.x+=this.vx;this.y+=this.vy;this.z+=this.vz;this.duration--};Particle.prototype.paint=function(){var b=scaleUp*(this.x-cameraX);var a=scaleUp*(this.y-cameraY-this.z);ctx.beginPath();ctx.fillStyle="#777777";ctx.arc(b,a,this.radius*scaleUp,0,2*Math.PI,false);ctx.fill()};function WaterSurfaceParticle(a,e,c,b,d){Particle.call(this,a,e,0,c,b,0,d);this.imageDuration=d/4}WaterSurfaceParticle.prototype=new Particle();WaterSurfaceParticle.prototype.step=function(){this.x+=this.vx;this.y+=this.vy;this.vx*=0.95;this.vy*=0.95;this.duration--};WaterSurfaceParticle.prototype.paint=function(){var c=this.initialDuration-this.duration;var d=c/this.initialDuration;var a=Math.floor(c/this.imageDuration);var b=ctx.globalAlpha;ctx.globalAlpha=Math.min(0.4,Math.min(1-d,d));ctx.drawImage(ImageHandler.images.projectiles,a*48,64,48,48,this.x-cameraX-24,this.y-cameraY-24,48,48);ctx.globalAlpha=b};function WaterGlimmerParticle(h,f,d,g,e,c,a,b,i){Particle.call(this,h,f,d,g,e,c,a);this.shinyness=b;this.size=i}WaterGlimmerParticle.prototype=new Particle();WaterGlimmerParticle.prototype.step=function(){this.duration--};WaterGlimmerParticle.prototype.paint=function(){var a=this.duration/this.initialDuration;ctx.globalAlpha=this.shinyness;var b=0.2;if(a<b){ctx.globalAlpha=this.shinyness*Math.min(1,a/b)}else{if(a>1-b){ctx.globalAlpha=this.shinyness*Math.min(1,(a-(1-b))/b)}}ctx.fillStyle="#aaaaff";ctx.fillRect(this.x-cameraX,this.y-cameraY,this.size,1);ctx.globalAlpha=1};function NonGasParticle(h,f,c,g,e,b,a,d,i){Particle.call(this,h,f,c,g,e,b,a);this.radius=3;this.type=d;this.subType=i;this.bouncyness=0.5;switch(d){case SMALL_BLOOD_PARTICLE:this.bouncyness=0;break}}NonGasParticle.prototype=new Particle();NonGasParticle.prototype.paint=function(){var c=this.duration/this.initialDuration;if(c<0.1){ctx.globalAlpha=Math.min(1,c/0.1)}var b=scaleUp*(this.x-cameraX);var a=scaleUp*(this.y-cameraY-this.z);ctx.drawImage(ImageHandler.images.projectiles,16*this.subType,112+16*this.type,16,16,b-8,a-8,16,16);ctx.globalAlpha=1};NonGasParticle.prototype.step=function(){Particle.prototype.step.call(this);this.vz-=0.2;if(this.z<=0&&this.vz<0){var d=false;var e=getGridInfo(levels[currentLevel],this.x,this.y);if(isWater(e)){this.duration=0;d=true;var c=true;switch(this.type){case LARGE_WATER_PARTICLE:addSmallSplash(this.x,this.y,5);break;default:break}if(c){if(this.type!=SMALL_WATER_PARTICLE){addSmallSplash(this.x,this.y,5)}}else{}}if(!d){var a=this.bouncyness;this.vx=this.vx*a;this.vy=this.vy*a;this.vz=-a*this.vz;var f=Math.sqrt(this.vx*this.vx+this.vy*this.vy+this.vz*this.vz);if(f<0.3){this.vx=0;this.vy=0;this.vz=0}switch(this.type){case LARGE_WATER_PARTICLE:addSmallSplash(this.x,this.y,5);this.duration=0;break;case LARGE_BLOOD_PARTICLE:addSplash(this.x,this.y,0,5,SMALL_BLOOD_PARTICLE,0.25,1,0.25,1,20,20);this.duration=0;break}}}};function SmokeParticle(a,g,f,d,c,b,e){Particle.call(this,a,g,f,d,c,b,e);this.radius=5;this.radiusInc=0.2}SmokeParticle.prototype=new Particle();SmokeParticle.prototype.paint=function(){var a=this.duration/this.initialDuration;ctx.globalAlpha=Math.min(1,a+0.2);Particle.prototype.paint.call(this);ctx.globalAlpha=1};SmokeParticle.prototype.step=function(){Particle.prototype.step.call(this);this.radius+=this.radiusInc};function FireParticle(a,g,f,d,c,b,e){Particle.call(this,a,g,f,d,c,b,e);this.radius=4;this.radiusInc=0.4;this.addSmoke=false}FireParticle.prototype=new Particle();FireParticle.prototype.fireColors=["#ffffff","#ffffff","#ffffdf","#ffffaf","#ffff9f","#ffff3f","#ffff1f","#ffff00","#ffcf00","#ffaf00","#ff5f00","#ff0f00","#ff0000","#cf0f0f","#af2f2f","#6f4f4f","#4f4f4f","#3f3f3f",];FireParticle.prototype.paint=function(){var c=this.initialDuration-this.duration;var e=this.duration/this.initialDuration;ctx.globalAlpha=Math.min(1,e+0.2);var d=scaleUp*(this.x-cameraX);var b=scaleUp*(this.y-this.z-cameraY);var a=Math.floor((1-e)*9);ctx.drawImage(ImageHandler.images.projectiles,32+32*(a%7),32*Math.floor(a/7),32,32,d-16,b-16,32,32);ctx.globalAlpha=1};FireParticle.prototype.step=function(){Particle.prototype.step.call(this);this.radius+=this.radiusInc;this.vx*=0.95;this.vy*=0.95;var a=this.initialDuration-this.duration;var b=a/this.initialDuration;if(this.addSmoke&&b<0.8&&(a%10)==0){addParticle(new SmokeParticle(this.x+Math.random()*20-10,this.y+Math.random()*20-10,this.z,this.vx*0.1,this.vy*0.1,this.vz,30+Math.random()*20))}};function EmitParticle(k,i,g,j,h,e,c,b,a,d,f){Particle.call(this,k,i,g,j,h,e,b);this.initInterval=a;this.interval=a;this.intervalRnd=d;this.type=f;this.tick=0;this.idle=false;this.emitFunction=c}EmitParticle.prototype.step=function(){if(this.idle){if(this.tick%50==0){if(vecLength([player.x-this.x,player.y-this.y])<700){this.idle=false}else{this.tick=Math.round(10*Math.random())}}this.tick++;return}Particle.prototype.step.call(this);this.tick++;if(this.tick%this.interval==0){var e=this.emitFunction(this);var c=e.pos;var b=e.vel;var a=e.duration;var d=null;switch(this.type){case 0:d=new FireParticle(c[0],c[1],c[2],b[0],b[1],b[2],a);break;case 1:d=new SmokeParticle(c[0],c[1],c[2],b[0],b[1],b[2],a);break}if(d!=null){addParticle(d);if(vecLength([player.x-this.x,player.y-this.y])>800){this.idle=true}}this.interval=Math.round(this.initInterval+(Math.random()-0.5)*this.intervalRnd*2);this.tick=1}};EmitParticle.prototype.paint=function(){};function Pickup(b,e,d,c,a){this.x=b;this.y=e;this.gridX=Math.floor(b/Tiles.tileSize);this.gridY=Math.floor(e/Tiles.tileSize);this.type=d;this.taken=false;this.amount=c;this.tileInfo=a}Pickup.prototype.paint=function(){if(!this.taken){var b=Tiles.tileSize;var a=this.tileInfo;ctx.drawImage(ImageHandler.images.tilesBackground,a.decorationCellX*b,a.decorationCellY*b,b,b,scaleUp*(this.gridX*b-cameraX),scaleUp*(this.gridY*b-cameraY),scaleUp*b,scaleUp*b)}};Pickup.prototype.step=function(){if(!this.taken){var b=Math.floor(player.x/Tiles.tileSize);var a=Math.floor(player.y/Tiles.tileSize);if(this.gridX==b&&this.gridY==a){switch(this.type){case 0:if(player.health<player.maxHealth){player.health=Math.min(player.health+this.amount,player.maxHealth);this.taken=true;Sound.play(Sound.HEALTH_PICKUP_ID);addTextAnimation(new PlayerConnectedTextAnimation(0,"HEALTH!",50))}break;case 1:if(player.grenadeCount<player.maxGrenadeCount){var c=player.grenadeCount;player.grenadeCount=Math.min(player.grenadeCount+this.amount,player.maxGrenadeCount);this.taken=true;Sound.play(Sound.GRENADES_PICKUP_ID);addTextAnimation(new PlayerConnectedTextAnimation(0,"GRENADES X"+(player.grenadeCount-c),50))}break;case 2:if(player.rocketCount<player.maxRocketCount){var c=player.rocketCount;player.rocketCount=Math.min(player.rocketCount+this.amount,player.maxRocketCount);this.taken=true;Sound.play(Sound.ROCKETS_PICKUP_ID);addTextAnimation(new PlayerConnectedTextAnimation(0,"ROCKETS X"+(player.rocketCount-c),50))}break;case 3:player.gatheredUpgrades++;this.taken=true;Sound.play(Sound.ROCKETS_PICKUP_ID);addTextAnimation(new PlayerConnectedTextAnimation(0,"UPGRADE!!!",50));break}}}};var canvas=null;var ctx=null;var output=null;var beforeClearColor="#000000";var scaleUp=1;var state=GAME_SCREEN;var targetState=-1;var switchingState=false;var stateCounter=0;var endStateCounter=0;var stateCounter2=0;var initialLevel=0;var controlMode=MOUSE_AND_KEYBOARD;window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b,a){window.setTimeout(b,1000/60)}})();function init(){canvas=document.getElementById("mainCanvas");if(canvas==null){alert(canvas)}scaleUp=canvas.width/640;ctx=canvas.getContext("2d");output=document.getElementById("output");loadDataUsingLocalStorage();beforeClearColor="#000000";ImageHandler.init(ctx);Font.init();Input.init();Tiles.init();mainLoop()}function logit(a){if(output){output.innerHTML+=a}}function logitRnd(b,a){if(Math.random()<a){if(output){output.innerHTML+=b}}}function transitionToState(a){stateCounter++;if(stateCounter>endStateCounter){switchingState=false;state=a;stateCounter=0;return true}else{return false}return true}function playerDied(){}var stepMillis=-1;var preferredStepMillis=-1;function mainLoop(){if(currentLevel==-1){changeLevel(initialLevel)}var h=levels[currentLevel];if(!ImageHandler.allLoaded){ctx.fillStyle="black";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.strokeStyle="#ffffff";ctx.lineWidth=1;ctx.font="12px sans-serif";ctx.strokeText("Loading... Please Wait",10,20);ctx.strokeText("Sounds Loaded: "+Sound.percentDone+"%",10,35);ctx.strokeText("Images Loaded: "+ImageHandler.percentDone+"%",10,50)}var g=new Date();var b=g.getTime();var e=12;if(stepMillis==-1){stepMillis=b;preferredStepMillis=b+1}else{preferredStepMillis=b}var a=true;var c=6;for(var f=0;f<c;f++){if(stepMillis>preferredStepMillis){if(f==0){a=false}break}else{if(f==c-1){g=new Date();b=g.getTime();stepMillis=b}else{stepMillis+=e}}switch(state){case GAME_SCREEN:stepGameScreen(h);break;case MAIN_MENU:stepMainMenu(h);break;case CREDITS_MENU:stepCreditsMenu(h);break;case HOW_TO_MENU:stepHowToMenu(h);break;case PAUSE_MENU:stepPauseMenu(h);break;case SHOWING_INTRO:stepShowingIntro(h);break;case SHOWING_LEVEL_INFO:stepShowingLevelInfo(h);break;case PLAYING_GAME:stepPlayingGame(h);break;case SHOWING_LEVEL_COMPLETE:stepShowingLevelComplete(h);break;case SHOWING_LEVEL_FAIL:stepShowingLevelFail(h);break;case SHOWING_GAME_COMPLETE:stepShowingGameComplete(h);break;case SHOWING_GAME_OVER:stepShowingGameOver(h);break;case SAVE_DATA_MENU:stepSaveDataMenu();break}stepControlAndSoundButtons();Input.step()}if(a){ctx.fillStyle="black";ctx.fillRect(0,0,canvas.width,canvas.height);switch(state){case GAME_SCREEN:paintGameScreen(h);break;case MAIN_MENU:paintMainMenu(h);break;case CREDITS_MENU:paintCreditsMenu(h);break;case HOW_TO_MENU:paintHowToMenu(h);break;case PAUSE_MENU:paintPauseMenu(h);break;case SHOWING_INTRO:paintShowingIntro(h);break;case SHOWING_LEVEL_INFO:paintShowingLevelInfo(h);break;case PLAYING_GAME:paintPlayingGame(h);break;case SHOWING_LEVEL_COMPLETE:paintShowingLevelComplete(h);break;case SHOWING_LEVEL_FAIL:paintShowingLevelFail(h);break;case SHOWING_GAME_COMPLETE:paintShowingGameComplete(h);break;case SHOWING_GAME_OVER:paintShowingGameOver(h);break;case PLAYING_GAME:paintPlayingGame(h);break;case SAVE_DATA_MENU:paintSaveDataMenu();break}}if(state!=PLAYING_GAME){paintMousePointer()}paintControlAndSoundButtons();requestAnimFrame(mainLoop)}Sound.init();